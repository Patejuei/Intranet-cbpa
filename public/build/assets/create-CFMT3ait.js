import{c as ue,u as _e,r as fe,j as s,H as ve}from"./app-Y3wPkO7k.js";import{B as ae}from"./button-IaI-p2sT.js";import{C as je,a as ge,b as ye,c as be}from"./card-DrCK2JXg.js";import{C as Ne}from"./checkbox-DzK31TVD.js";import{I as re}from"./input-Ci3WR__e.js";import{L as n}from"./label-CIN9rteu.js";import{a as ke,b as Se,c as Ce,S as we,d as Te}from"./select-yIse2YFz.js";import{T as Ie}from"./textarea-B57_v3iI.js";import{A as Ve}from"./app-layout-LB7JlbCh.js";/* empty css            */import"./index-CxTk-NYF.js";import"./index-CwZq2zaV.js";import"./index-DHyoASyW.js";import"./check-CxauaCCR.js";import"./chevron-down-DRs0A40W.js";import"./index-C4J_hXM0.js";import"./shield-YzFc6gme.js";function Qe(o){const e=ue.c(107),{vehicles:d}=o;let z;e[0]===Symbol.for("react.memo_cache_sentinel")?(z=new Date().toISOString().split("T"),e[0]=z):z=e[0];let H;e[1]===Symbol.for("react.memo_cache_sentinel")?(H=[],e[1]=H):H=e[1];let P;e[2]===Symbol.for("react.memo_cache_sentinel")?(P=[],e[2]=P):P=e[2];let B;e[3]===Symbol.for("react.memo_cache_sentinel")?(B={vehicle_id:"",entry_date:z[0],tentative_exit_date:"",workshop_name:"",description:"",tasks:H,issue_ids:P},e[3]=B):B=e[3];const{data:t,setData:l,post:ce,processing:ne,errors:a}=_e(B),[r,he]=fe.useState(null);let G;e[4]!==t.vehicle_id||e[5]!==l||e[6]!==d?(G=()=>{if(t.vehicle_id){const i=d.find(c=>c.id.toString()===t.vehicle_id);he(i||null),l("issue_ids",[])}else he(null)},e[4]=t.vehicle_id,e[5]=l,e[6]=d,e[7]=G):G=e[7];let J;e[8]!==t.vehicle_id?(J=[t.vehicle_id],e[8]=t.vehicle_id,e[9]=J):J=e[9],fe.useEffect(G,J);let W;e[10]!==t.issue_ids||e[11]!==l?(W=i=>{const c=t.issue_ids;c.includes(i)?l("issue_ids",c.filter(O=>O!==i)):l("issue_ids",[...c,i])},e[10]=t.issue_ids,e[11]=l,e[12]=W):W=e[12];const oe=W;let q;e[13]!==ce?(q=i=>{i.preventDefault(),ce("/vehicles/workshop")},e[13]=ce,e[14]=q):q=e[14];const de=q;let K,Q;e[15]===Symbol.for("react.memo_cache_sentinel")?(Q=[{title:"Panel Principal",href:"/dashboard"},{title:"Taller Mecánico",href:"/vehicles/workshop"},{title:"Nuevo Ingreso",href:"/vehicles/workshop/create"}],K=s.jsx(ve,{title:"Ingresar Vehículo a Taller"}),e[15]=K,e[16]=Q):(K=e[15],Q=e[16]);let U;e[17]===Symbol.for("react.memo_cache_sentinel")?(U=s.jsx(je,{children:s.jsx(ge,{children:"Ingresar Vehículo a Taller"})}),e[17]=U):U=e[17];let X;e[18]===Symbol.for("react.memo_cache_sentinel")?(X=s.jsx(n,{children:"Vehículo"}),e[18]=X):X=e[18];let m;e[19]!==l?(m=i=>l("vehicle_id",i),e[19]=l,e[20]=m):m=e[20];const pe=t.vehicle_id;let Y;e[21]===Symbol.for("react.memo_cache_sentinel")?(Y=s.jsx(ke,{children:s.jsx(Se,{placeholder:"Seleccione un vehículo"})}),e[21]=Y):Y=e[21];let h;e[22]!==d?(h=d.map(Ee),e[22]=d,e[23]=h):h=e[23];let f;e[24]!==h?(f=s.jsx(Ce,{children:h}),e[24]=h,e[25]=f):f=e[25];let p;e[26]!==t.vehicle_id||e[27]!==m||e[28]!==f?(p=s.jsxs(we,{onValueChange:m,value:pe,children:[Y,f]}),e[26]=t.vehicle_id,e[27]=m,e[28]=f,e[29]=p):p=e[29];let x;e[30]!==a.vehicle_id?(x=a.vehicle_id&&s.jsx("p",{className:"text-sm text-destructive",children:a.vehicle_id}),e[30]=a.vehicle_id,e[31]=x):x=e[31];let u;e[32]!==p||e[33]!==x?(u=s.jsxs("div",{className:"space-y-2",children:[X,p,x]}),e[32]=p,e[33]=x,e[34]=u):u=e[34];let Z;e[35]===Symbol.for("react.memo_cache_sentinel")?(Z=s.jsx(n,{children:"Taller / Lugar"}),e[35]=Z):Z=e[35];let _;e[36]!==l?(_=i=>l("workshop_name",i.target.value),e[36]=l,e[37]=_):_=e[37];let v;e[38]!==t.workshop_name||e[39]!==_?(v=s.jsx(re,{value:t.workshop_name,onChange:_,placeholder:"Ej: Taller Central, Mecánico JS"}),e[38]=t.workshop_name,e[39]=_,e[40]=v):v=e[40];let j;e[41]!==a.workshop_name?(j=a.workshop_name&&s.jsx("p",{className:"text-sm text-destructive",children:a.workshop_name}),e[41]=a.workshop_name,e[42]=j):j=e[42];let g;e[43]!==v||e[44]!==j?(g=s.jsxs("div",{className:"space-y-2",children:[Z,v,j]}),e[43]=v,e[44]=j,e[45]=g):g=e[45];let y;e[46]!==u||e[47]!==g?(y=s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[u,g]}),e[46]=u,e[47]=g,e[48]=y):y=e[48];let b;e[49]!==r?(b=r&&s.jsxs("div",{className:"rounded-md border bg-muted/50 p-4",children:[s.jsx("h3",{className:"mb-2 font-semibold",children:"Detalles del Vehículo"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-muted-foreground",children:"Patente:"})," ",r.plate||"N/A"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-muted-foreground",children:"Marca/Modelo:"})," ",r.make," ",r.model]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-muted-foreground",children:"Compañía:"})," ",r.company]})]}),r.active_maintenance_id&&s.jsxs("div",{className:"mt-4 rounded-md border border-yellow-500/20 bg-yellow-500/10 p-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"font-bold text-yellow-500",children:"⚠️ Este vehículo ya se encuentra en taller."}),s.jsx(ae,{asChild:!0,variant:"secondary",size:"sm",children:s.jsx("a",{href:`/vehicles/workshop/${r.active_maintenance_id}`,children:"Ver Orden Activa"})})]}),s.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"Si desea ingresar un nuevo registro, por favor finalice la orden anterior primero."})]})]}),e[49]=r,e[50]=b):b=e[50];let ee;e[51]===Symbol.for("react.memo_cache_sentinel")?(ee=s.jsx(n,{children:"Fecha de Ingreso"}),e[51]=ee):ee=e[51];let N;e[52]!==l?(N=i=>l("entry_date",i.target.value),e[52]=l,e[53]=N):N=e[53];let k;e[54]!==t.entry_date||e[55]!==N?(k=s.jsx(re,{type:"date",value:t.entry_date,onChange:N}),e[54]=t.entry_date,e[55]=N,e[56]=k):k=e[56];let S;e[57]!==a.entry_date?(S=a.entry_date&&s.jsx("p",{className:"text-sm text-destructive",children:a.entry_date}),e[57]=a.entry_date,e[58]=S):S=e[58];let C;e[59]!==k||e[60]!==S?(C=s.jsxs("div",{className:"space-y-2",children:[ee,k,S]}),e[59]=k,e[60]=S,e[61]=C):C=e[61];let se;e[62]===Symbol.for("react.memo_cache_sentinel")?(se=s.jsx(n,{children:"Fecha Tentativa Salida (Opcional)"}),e[62]=se):se=e[62];let w;e[63]!==l?(w=i=>l("tentative_exit_date",i.target.value),e[63]=l,e[64]=w):w=e[64];let T;e[65]!==t.tentative_exit_date||e[66]!==w?(T=s.jsxs("div",{className:"space-y-2",children:[se,s.jsx(re,{type:"date",value:t.tentative_exit_date,onChange:w})]}),e[65]=t.tentative_exit_date,e[66]=w,e[67]=T):T=e[67];let I;e[68]!==C||e[69]!==T?(I=s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[C,T]}),e[68]=C,e[69]=T,e[70]=I):I=e[70];let V;e[71]!==t.issue_ids||e[72]!==oe||e[73]!==r?(V=r&&r.issues.length>0&&s.jsxs("div",{className:"space-y-2 rounded-md border p-4",children:[s.jsx(n,{className:"text-base font-semibold",children:"Reportar Incidencias Existentes"}),s.jsx("div",{className:"space-y-2",children:r.issues.map(i=>s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Ne,{id:`issue-${i.id}`,checked:t.issue_ids.includes(i.id),onCheckedChange:()=>oe(i.id)}),s.jsxs(n,{htmlFor:`issue-${i.id}`,className:"font-normal",children:[s.jsxs("span",{className:"font-semibold",children:[i.date,":"]})," ",i.description," ",s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",i.severity,")"]})]})]},i.id))})]}),e[71]=t.issue_ids,e[72]=oe,e[73]=r,e[74]=V):V=e[74];let te;e[75]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx(n,{children:"Trabajos a Realizar (Lista)"}),e[75]=te):te=e[75];let E;e[76]!==t.tasks||e[77]!==l?(E=t.tasks.map((i,c)=>s.jsxs("div",{className:"flex gap-2",children:[s.jsx(re,{value:i,onChange:O=>{const me=[...t.tasks];me[c]=O.target.value,l("tasks",me)},placeholder:`Trabajo #${c+1}`}),s.jsxs(ae,{type:"button",variant:"destructive",size:"icon",onClick:()=>{const O=t.tasks.filter((me,xe)=>xe!==c);l("tasks",O)},children:[s.jsx("span",{className:"sr-only",children:"Eliminar"}),"×"]})]},c)),e[76]=t.tasks,e[77]=l,e[78]=E):E=e[78];let A;e[79]!==t.tasks||e[80]!==l?(A=s.jsx(ae,{type:"button",variant:"outline",onClick:()=>l("tasks",[...t.tasks,""]),children:"+ Agregar Trabajo"}),e[79]=t.tasks,e[80]=l,e[81]=A):A=e[81];let D;e[82]!==E||e[83]!==A?(D=s.jsxs("div",{className:"space-y-2",children:[te,s.jsxs("div",{className:"space-y-2",children:[E,A]})]}),e[82]=E,e[83]=A,e[84]=D):D=e[84];let le;e[85]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx(n,{children:"Observaciones Generales"}),e[85]=le):le=e[85];let L;e[86]!==l?(L=i=>l("description",i.target.value),e[86]=l,e[87]=L):L=e[87];let R;e[88]!==t.description||e[89]!==L?(R=s.jsx(Ie,{value:t.description,onChange:L,placeholder:"Detalles adicionales...",rows:3}),e[88]=t.description,e[89]=L,e[90]=R):R=e[90];let $;e[91]!==a.description?($=a.description&&s.jsx("p",{className:"text-sm text-destructive",children:a.description}),e[91]=a.description,e[92]=$):$=e[92];let F;e[93]!==R||e[94]!==$?(F=s.jsxs("div",{className:"space-y-2",children:[le,R,$]}),e[93]=R,e[94]=$,e[95]=F):F=e[95];let M;e[96]!==ne?(M=s.jsx("div",{className:"flex justify-end gap-4",children:s.jsx(ae,{type:"submit",disabled:ne,children:"Registrar Ingreso"})}),e[96]=ne,e[97]=M):M=e[97];let ie;return e[98]!==de||e[99]!==y||e[100]!==b||e[101]!==I||e[102]!==V||e[103]!==D||e[104]!==F||e[105]!==M?(ie=s.jsxs(Ve,{breadcrumbs:Q,children:[K,s.jsx("div",{className:"flex flex-col gap-6 p-4",children:s.jsx("div",{className:"mx-auto w-full max-w-3xl",children:s.jsxs(ye,{children:[U,s.jsx(be,{children:s.jsxs("form",{onSubmit:de,className:"space-y-6",children:[y,b,I,V,D,F,M]})})]})})})]}),e[98]=de,e[99]=y,e[100]=b,e[101]=I,e[102]=V,e[103]=D,e[104]=F,e[105]=M,e[106]=ie):ie=e[106],ie}function Ee(o){return s.jsxs(Te,{value:o.id.toString(),children:[o.name," (",o.company,")"]},o.id)}export{Qe as default};
