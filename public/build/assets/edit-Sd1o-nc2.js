import{c as Ne,u as _e,j as s,H as we}from"./app-BIf_3_yO.js";import{C as Ce}from"./checkbox-DiAhhJR9.js";import{S as Se}from"./scroll-area-BgOw2Lu1.js";import{S as ge,a as ve,b as je,c as ye,d as G}from"./select-DLMhXFYt.js";import{T as ke,A as Me}from"./app-layout-BummZ3R_.js";import{S as $e}from"./shield-f5WHSZI-.js";/* empty css            */import"./button-ocm-JKIV.js";import"./index-cS1n-4PE.js";import"./index-ATgpkBzy.js";import"./index-Biy2Phsi.js";import"./check-Co4t-Wzi.js";import"./chevron-down-Ikrv-Emw.js";import"./index-C4J_hXM0.js";const Ee=[{id:"inventory",label:"Inventario"},{id:"tickets",label:"Ticketera"},{id:"batteries",label:"Baterías"},{id:"equipment",label:"Material Menor"},{id:"deliveries",label:"Actas de Entrega"},{id:"reception",label:"Actas de Recepción"},{id:"firefighters",label:"Bomberos"},{id:"vehicles",label:"Material Mayor (General)"},{id:"vehicles.incidents",label:"M. Mayor - Incidencias"},{id:"vehicles.logs",label:"M. Mayor - Bitácora"},{id:"vehicles.workshop",label:"M. Mayor - Taller"},{id:"vehicles.inventory",label:"M. Mayor - Inventario"}],qe=["Primera Compañía","Segunda Compañía","Tercera Compañía","Cuarta Compañía","Quinta Compañía","Sexta Compañía","Séptima Compañía","Octava Compañía","Novena Compañía","Décima Compañía","Brigada Juvenil","Comandancia"];function Xe(n){const e=Ne.c(121),{user:t,availableVehicles:H}=n;let m;e[0]!==t.permissions?(m=t.permissions??[],e[0]=t.permissions,e[1]=m):m=e[1];let d;e[2]!==t.driver_vehicles?(d=t.driver_vehicles?.map(Te)??[],e[2]=t.driver_vehicles,e[3]=d):d=e[3];let J;e[4]!==m||e[5]!==d||e[6]!==t.company||e[7]!==t.email||e[8]!==t.name||e[9]!==t.role?(J={name:t.name,email:t.email,password:"",company:t.company,role:t.role,permissions:m,driver_vehicles:d},e[4]=m,e[5]=d,e[6]=t.company,e[7]=t.email,e[8]=t.name,e[9]=t.role,e[10]=J):J=e[10];const{data:l,setData:a,put:ue,processing:pe,errors:r}=_e(J);let L;e[11]!==l.driver_vehicles||e[12]!==a?(L=i=>{const o=l.driver_vehicles;o.includes(i)?a("driver_vehicles",o.filter(c=>c!==i)):a("driver_vehicles",[...o,i])},e[11]=l.driver_vehicles,e[12]=a,e[13]=L):L=e[13];const fe=L;let Q;e[14]!==ue||e[15]!==t.id?(Q=i=>{i.preventDefault(),ue(`/admin/users/${t.id}`)},e[14]=ue,e[15]=t.id,e[16]=Q):Q=e[16];const xe=Q;let K;e[17]!==l.permissions||e[18]!==a?(K=(i,o)=>{const c=l.permissions.filter(be=>!be.startsWith(`${i}.`));o==="view"?c.push(`${i}.view`):o==="edit"&&c.push(`${i}.view`,`${i}.edit`),["inventory","deliveries","reception"].includes(i)&&o!=="none"&&(c.some(Ve)||c.push("equipment.view")),a("permissions",c)},e[17]=l.permissions,e[18]=a,e[19]=K):K=e[19];const O=K;let X;e[20]!==l.permissions?(X=i=>{const o=l.permissions.includes(`${i}.edit`),c=l.permissions.includes(`${i}.view`);return o?"edit":c?"view":"none"},e[20]=l.permissions,e[21]=X):X=e[21];const W=X;let Y,Z;e[22]===Symbol.for("react.memo_cache_sentinel")?(Y={title:"Panel Principal",href:"/dashboard"},Z={title:"Usuarios",href:"/admin/users"},e[22]=Y,e[23]=Z):(Y=e[22],Z=e[23]);const he=`/admin/users/${t.id}/edit`;let u;e[24]!==he?(u=[Y,Z,{title:"Editar Usuario",href:he}],e[24]=he,e[25]=u):u=e[25];let I;e[26]===Symbol.for("react.memo_cache_sentinel")?(I=s.jsx(we,{title:"Editar Usuario"}),e[26]=I):I=e[26];let p;e[27]!==t.name?(p=s.jsxs("h2",{className:"text-lg font-semibold text-foreground",children:["Editar Usuario: ",t.name]}),e[27]=t.name,e[28]=p):p=e[28];let ee;e[29]===Symbol.for("react.memo_cache_sentinel")?(ee=s.jsx("p",{className:"text-sm text-muted-foreground",children:"Modifique los detalles del usuario."}),e[29]=ee):ee=e[29];let f;e[30]!==p?(f=s.jsxs("div",{className:"mb-6",children:[p,ee]}),e[30]=p,e[31]=f):f=e[31];let se;e[32]===Symbol.for("react.memo_cache_sentinel")?(se=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Nombre Completo"}),e[32]=se):se=e[32];let x;e[33]!==a?(x=i=>a("name",i.target.value),e[33]=a,e[34]=x):x=e[34];let h;e[35]!==l.name||e[36]!==x?(h=s.jsx("input",{type:"text",value:l.name,onChange:x,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[35]=l.name,e[36]=x,e[37]=h):h=e[37];let b;e[38]!==r.name?(b=r.name&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.name}),e[38]=r.name,e[39]=b):b=e[39];let g;e[40]!==h||e[41]!==b?(g=s.jsxs("div",{children:[se,h,b]}),e[40]=h,e[41]=b,e[42]=g):g=e[42];let ie;e[43]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Correo Electrónico"}),e[43]=ie):ie=e[43];let v;e[44]!==a?(v=i=>a("email",i.target.value),e[44]=a,e[45]=v):v=e[45];let j;e[46]!==l.email||e[47]!==v?(j=s.jsx("input",{type:"email",value:l.email,onChange:v,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[46]=l.email,e[47]=v,e[48]=j):j=e[48];let y;e[49]!==r.email?(y=r.email&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.email}),e[49]=r.email,e[50]=y):y=e[50];let N;e[51]!==j||e[52]!==y?(N=s.jsxs("div",{children:[ie,j,y]}),e[51]=j,e[52]=y,e[53]=N):N=e[53];let _;e[54]!==g||e[55]!==N?(_=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[g,N]}),e[54]=g,e[55]=N,e[56]=_):_=e[56];let le;e[57]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Contraseña (Opcional)"}),e[57]=le):le=e[57];let w;e[58]!==a?(w=i=>a("password",i.target.value),e[58]=a,e[59]=w):w=e[59];let C;e[60]!==l.password||e[61]!==w?(C=s.jsx("input",{type:"password",value:l.password,onChange:w,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",placeholder:"••••••••"}),e[60]=l.password,e[61]=w,e[62]=C):C=e[62];let S;e[63]!==r.password?(S=r.password&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.password}),e[63]=r.password,e[64]=S):S=e[64];let k;e[65]!==C||e[66]!==S?(k=s.jsxs("div",{children:[le,C,S]}),e[65]=C,e[66]=S,e[67]=k):k=e[67];let te;e[68]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Compañía"}),e[68]=te):te=e[68];let M;e[69]!==a?(M=i=>a("company",i),e[69]=a,e[70]=M):M=e[70];let ae;e[71]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsx(ve,{className:"w-full",children:s.jsx(je,{placeholder:"Seleccione una Compañía"})}),e[71]=ae):ae=e[71];let re;e[72]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsx(ye,{children:qe.map(Pe)}),e[72]=re):re=e[72];let $;e[73]!==l.company||e[74]!==M?($=s.jsxs(ge,{value:l.company,onValueChange:M,children:[ae,re]}),e[73]=l.company,e[74]=M,e[75]=$):$=e[75];let E;e[76]!==r.company?(E=r.company&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.company}),e[76]=r.company,e[77]=E):E=e[77];let q;e[78]!==$||e[79]!==E?(q=s.jsxs("div",{children:[te,$,E]}),e[78]=$,e[79]=E,e[80]=q):q=e[80];let P;e[81]!==k||e[82]!==q?(P=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[k,q]}),e[81]=k,e[82]=q,e[83]=P):P=e[83];let V;e[84]!==_||e[85]!==P?(V=s.jsxs("div",{className:"space-y-4",children:[_,P]}),e[84]=_,e[85]=P,e[86]=V):V=e[86];let ne;e[87]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx($e,{className:"size-4"})," Roles y Permisos"]}),e[87]=ne):ne=e[87];let oe;e[88]===Symbol.for("react.memo_cache_sentinel")?(oe=s.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Rol del Sistema"}),e[88]=oe):oe=e[88];let T;e[89]!==a?(T=i=>a("role",i),e[89]=a,e[90]=T):T=e[90];let ce;e[91]===Symbol.for("react.memo_cache_sentinel")?(ce=s.jsx(ve,{className:"w-full",children:s.jsx(je,{placeholder:"Seleccione un Rol"})}),e[91]=ce):ce=e[91];let me;e[92]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsxs(ye,{children:[s.jsx(G,{value:"user",children:"Usuario (Por Defecto)"}),s.jsx(G,{value:"admin",children:"Administrador"}),s.jsx(G,{value:"capitan",children:"Capitán"}),s.jsx(G,{value:"cuartelero",children:"Cuartelero"}),s.jsx(G,{value:"mechanic",children:"Taller Mecánico"})]}),e[92]=me):me=e[92];let A;e[93]!==l.role||e[94]!==T?(A=s.jsxs("div",{className:"mb-6",children:[oe,s.jsxs(ge,{value:l.role,onValueChange:T,children:[ce,me]})]}),e[93]=l.role,e[94]=T,e[95]=A):A=e[95];let D;e[96]!==l.role||e[97]!==W||e[98]!==O?(D=l.role!=="admin"&&l.role!=="capitan"&&s.jsxs("div",{children:[s.jsx("label",{className:"mb-3 block text-sm font-medium",children:"Permisos por Módulo"}),s.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-muted-foreground",children:[s.jsx("th",{className:"pb-2 font-medium",children:"Módulo"}),s.jsx("th",{className:"pb-2 font-medium",children:"Nivel de Acceso"})]})}),s.jsx("tbody",{className:"divide-y",children:Ee.map(i=>s.jsxs("tr",{children:[s.jsx("td",{className:"py-2.5 font-medium",children:i.label}),s.jsx("td",{className:"py-2",children:s.jsxs("div",{className:"flex gap-1 rounded-md bg-muted/50 p-1",children:[s.jsx("button",{type:"button",onClick:()=>O(i.id,"none"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${W(i.id)==="none"?"bg-background shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ninguno"}),s.jsx("button",{type:"button",onClick:()=>O(i.id,"view"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${W(i.id)==="view"?"bg-blue-100 text-blue-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ver"}),s.jsx("button",{type:"button",onClick:()=>O(i.id,"edit"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${W(i.id)==="edit"?"bg-green-100 text-green-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Editar"})]})})]},i.id))})]})}),s.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"'Editar' incluye permisos de 'Ver'."})]}),e[96]=l.role,e[97]=W,e[98]=O,e[99]=D):D=e[99];let R;e[100]!==A||e[101]!==D?(R=s.jsxs("div",{className:"rounded-lg border p-4",children:[ne,A,D]}),e[100]=A,e[101]=D,e[102]=R):R=e[102];let U;e[103]!==H||e[104]!==l.driver_vehicles||e[105]!==fe?(U=H&&H.length>0&&s.jsxs("div",{className:"rounded-lg border p-4",children:[s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(ke,{className:"size-4"})," Vehículos Permitidos (Maquinistas)"]}),s.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Seleccione los vehículos que este usuario está autorizado a conducir y registrar en bitácora."}),s.jsx(Se,{className:"h-[200px] w-full rounded-md border p-4",children:s.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:H.map(i=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ce,{id:`v-${i.id}`,checked:l.driver_vehicles.includes(i.id),onCheckedChange:()=>fe(i.id)}),s.jsxs("label",{htmlFor:`v-${i.id}`,className:"text-sm leading-none font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[i.name," ",s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",i.company,")"]})]})]},i.id))})})]}),e[103]=H,e[104]=l.driver_vehicles,e[105]=fe,e[106]=U):U=e[106];let B;e[107]!==pe?(B=s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{type:"submit",disabled:pe,className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-8 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90 focus-visible:ring-2 focus-visible:ring-primary focus-visible:outline-none disabled:opacity-50",children:"Guardar Cambios"})}),e[107]=pe,e[108]=B):B=e[108];let z;e[109]!==xe||e[110]!==V||e[111]!==R||e[112]!==U||e[113]!==B?(z=s.jsxs("form",{onSubmit:xe,className:"space-y-6",children:[V,R,U,B]}),e[109]=xe,e[110]=V,e[111]=R,e[112]=U,e[113]=B,e[114]=z):z=e[114];let F;e[115]!==f||e[116]!==z?(F=s.jsx("div",{className:"flex flex-col gap-6 p-4",children:s.jsxs("div",{className:"max-w-4xl rounded-xl border bg-card p-6 shadow-sm",children:[f,z]})}),e[115]=f,e[116]=z,e[117]=F):F=e[117];let de;return e[118]!==u||e[119]!==F?(de=s.jsxs(Me,{breadcrumbs:u,children:[I,F]}),e[118]=u,e[119]=F,e[120]=de):de=e[120],de}function Pe(n){return s.jsx(G,{value:n,children:n},n)}function Ve(n){return n.startsWith("equipment.")}function Te(n){return n.id}export{Xe as default};
