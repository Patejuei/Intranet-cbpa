import{c as Pe,b as Ae,u as Ue,j as s,H as De}from"./app-z1LlDF32.js";import{C as Fe}from"./checkbox-BgzH4lSD.js";import{S as Be}from"./scroll-area-C0Nhotm-.js";import{S as we,a as Ce,b as _e,c as Se,d as ve}from"./select-Ctgoj21f.js";import{T as ze,A as He}from"./app-layout-CQ3Z7Pki.js";import{S as We}from"./shield-CNFvW_b5.js";/* empty css            */import"./button-CvHHMCQK.js";import"./index-CJh5F0Z4.js";import"./index-DHgLr2qs.js";import"./index-GZosSTr8.js";import"./check-BLI2Yg6w.js";import"./chevron-down-B-311DrA.js";import"./index-C4J_hXM0.js";const Ge=["Primera Compañía","Segunda Compañía","Tercera Compañía","Cuarta Compañía","Quinta Compañía","Sexta Compañía","Séptima Compañía","Octava Compañía","Novena Compañía","Décima Compañía","Brigada Juvenil","Comandancia"],Re=[{id:"inventory",label:"Inventario",category:"Material Menor"},{id:"tickets",label:"Ticketera",category:"Material Menor"},{id:"batteries",label:"Baterías",category:"Material Menor"},{id:"deliveries",label:"Actas de Entrega",category:"Material Menor"},{id:"reception",label:"Actas de Recepción",category:"Material Menor"},{id:"vehicles.status",label:"M. Mayor - Estado de Carros",category:"Material Mayor"},{id:"vehicles.incidents",label:"M. Mayor - Incidencias",category:"Material Mayor"},{id:"vehicles.checklist",label:"M. Mayor - Checklist",category:"Material Mayor"},{id:"vehicles.logs",label:"M. Mayor - Bitácora",category:"Material Mayor"},{id:"vehicles.workshop",label:"M. Mayor - Taller",category:"Material Mayor"},{id:"vehicles.inventory",label:"M. Mayor - Inventario",category:"Material Mayor"},{id:"firefighters",label:"Bomberos",category:"Administración"}],Je=["Material Menor","Material Mayor","Administración"],Le=n=>{const e=[{value:"user",label:"Usuario Estándar"},{value:"admin",label:"Administrador del Sistema"},{value:"capitan",label:"Capitán"},{value:"teniente",label:"Teniente"},{value:"maquinista",label:"Maquinista"},{value:"ayudante",label:"Ayudante"},{value:"comandancia",label:"Comandancia"},{value:"cuartelero",label:"Cuartelero"},{value:"mechanic",label:"Taller Mecánico"},{value:"inspector",label:"Inspector General"}];if(n==="capitan"){const c=["user","teniente","maquinista","ayudante"];return e.filter(ge=>c.includes(ge.value))}return e},Oe=n=>{if(n==="capitan"){const e=["vehicles.inventory","vehicles.workshop","firefighters","vehicles","equipment"];return Re.filter(c=>!e.includes(c.id))}return Re};function us(n){const e=Pe.c(149),{availableVehicles:c}=n,{props:ge}=Ae(),ke=ge.auth.user,v=ke?.role||"user",ye=v==="capitan"&&ke.company||"";let ee;e[0]===Symbol.for("react.memo_cache_sentinel")?(ee=[],e[0]=ee):ee=e[0];let se;e[1]===Symbol.for("react.memo_cache_sentinel")?(se=[],e[1]=se):se=e[1];let te;e[2]!==ye?(te={name:"",email:"",password:"",company:ye,role:"user",department:"",permissions:ee,driver_vehicles:se},e[2]=ye,e[3]=te):te=e[3];const{data:t,setData:i,post:I,processing:je,errors:r}=Ue(te);let g,y,j,N,d,M,u,w,p,f,C,x,h,b,_;if(e[4]!==v||e[5]!==t.company||e[6]!==t.department||e[7]!==t.driver_vehicles||e[8]!==t.email||e[9]!==t.name||e[10]!==t.password||e[11]!==t.permissions||e[12]!==t.role||e[13]!==r.company||e[14]!==r.email||e[15]!==r.name||e[16]!==r.password||e[17]!==I||e[18]!==i){const m=Le(v),qe=Oe(v);let ie;e[34]!==t.driver_vehicles||e[35]!==i?(ie=l=>{const a=t.driver_vehicles;a.includes(l)?i("driver_vehicles",a.filter(o=>o!==l)):i("driver_vehicles",[...a,l])},e[34]=t.driver_vehicles,e[35]=i,e[36]=ie):ie=e[36],y=ie;let ae;e[37]!==I?(ae=l=>{l.preventDefault(),I("/admin/users")},e[37]=I,e[38]=ae):ae=e[38];const Te=ae;let re;e[39]!==t.permissions||e[40]!==i?(re=(l,a)=>{const o=t.permissions.filter(Ee=>!Ee.startsWith(`${l}.`));a==="view"?o.push(`${l}.view`):a==="edit"?o.push(`${l}.view`,`${l}.edit`):a==="full"&&o.push(`${l}.view`,`${l}.edit`,`${l}.full`),["inventory","deliveries","reception"].includes(l)&&a!=="none"&&!o.some(Ye)&&(o.some(Xe)||o.push("equipment.view")),i("permissions",o)},e[39]=t.permissions,e[40]=i,e[41]=re):re=e[41];const ne=re;let oe;e[42]!==t.permissions?(oe=l=>{const a=t.permissions.includes(`${l}.full`),o=t.permissions.includes(`${l}.edit`),$e=t.permissions.includes(`${l}.view`);return a?"full":o?"edit":$e?"view":"none"},e[42]=t.permissions,e[43]=oe):oe=e[43];const ce=oe;g=He,e[44]===Symbol.for("react.memo_cache_sentinel")?(p=[{title:"Panel Principal",href:"/dashboard"},{title:"Usuarios",href:"/admin/users"},{title:"Nuevo Usuario",href:"/admin/users/create"}],f=s.jsx(De,{title:"Crear Usuario"}),e[44]=p,e[45]=f):(p=e[44],f=e[45]),w="flex flex-col gap-6 p-4",M="max-w-4xl rounded-xl border bg-card p-6 shadow-sm",e[46]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Crear Nuevo Usuario"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete los detalles para registrar un nuevo usuario en el sistema."})]}),e[46]=u):u=e[46],j=Te,N="space-y-6";let me;e[47]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Nombre Completo"}),e[47]=me):me=e[47];let T;e[48]!==i?(T=l=>i("name",l.target.value),e[48]=i,e[49]=T):T=e[49];let V;e[50]!==t.name||e[51]!==T?(V=s.jsx("input",{type:"text",value:t.name,onChange:T,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[50]=t.name,e[51]=T,e[52]=V):V=e[52];let P;e[53]!==r.name?(P=r.name&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.name}),e[53]=r.name,e[54]=P):P=e[54];let A;e[55]!==V||e[56]!==P?(A=s.jsxs("div",{children:[me,V,P]}),e[55]=V,e[56]=P,e[57]=A):A=e[57];let de;e[58]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Correo Electrónico"}),e[58]=de):de=e[58];let U;e[59]!==i?(U=l=>i("email",l.target.value),e[59]=i,e[60]=U):U=e[60];let D;e[61]!==t.email||e[62]!==U?(D=s.jsx("input",{type:"email",value:t.email,onChange:U,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[61]=t.email,e[62]=U,e[63]=D):D=e[63];let F;e[64]!==r.email?(F=r.email&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.email}),e[64]=r.email,e[65]=F):F=e[65];let B;e[66]!==D||e[67]!==F?(B=s.jsxs("div",{children:[de,D,F]}),e[66]=D,e[67]=F,e[68]=B):B=e[68];let z;e[69]!==A||e[70]!==B?(z=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[A,B]}),e[69]=A,e[70]=B,e[71]=z):z=e[71];let ue;e[72]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Contraseña"}),e[72]=ue):ue=e[72];let H;e[73]!==i?(H=l=>i("password",l.target.value),e[73]=i,e[74]=H):H=e[74];let W;e[75]!==t.password||e[76]!==H?(W=s.jsx("input",{type:"password",value:t.password,onChange:H,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[75]=t.password,e[76]=H,e[77]=W):W=e[77];let G;e[78]!==r.password?(G=r.password&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.password}),e[78]=r.password,e[79]=G):G=e[79];let J;e[80]!==W||e[81]!==G?(J=s.jsxs("div",{children:[ue,W,G]}),e[80]=W,e[81]=G,e[82]=J):J=e[82];let pe;e[83]===Symbol.for("react.memo_cache_sentinel")?(pe=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Compañía"}),e[83]=pe):pe=e[83];let L;e[84]!==i?(L=l=>i("company",l),e[84]=i,e[85]=L):L=e[85];const Ne=v==="capitan";let fe;e[86]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsx(Ce,{className:"w-full",children:s.jsx(_e,{placeholder:"Seleccione una Compañía"})}),e[86]=fe):fe=e[86];let xe;e[87]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx(Se,{children:Ge.map(Ke)}),e[87]=xe):xe=e[87];let O;e[88]!==t.company||e[89]!==L||e[90]!==Ne?(O=s.jsxs(we,{value:t.company,onValueChange:L,disabled:Ne,children:[fe,xe]}),e[88]=t.company,e[89]=L,e[90]=Ne,e[91]=O):O=e[91];let Q;e[92]!==r.company?(Q=r.company&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.company}),e[92]=r.company,e[93]=Q):Q=e[93];let K;e[94]!==O||e[95]!==Q?(K=s.jsxs("div",{children:[pe,O,Q]}),e[94]=O,e[95]=Q,e[96]=K):K=e[96];let X;e[97]!==J||e[98]!==K?(X=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[J,K]}),e[97]=J,e[98]=K,e[99]=X):X=e[99],e[100]!==z||e[101]!==X?(d=s.jsxs("div",{className:"space-y-4",children:[z,X]}),e[100]=z,e[101]=X,e[102]=d):d=e[102],C="rounded-lg border p-4",e[103]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(We,{className:"size-4"})," Roles y Permisos"]}),e[103]=x):x=e[103];let he;e[104]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Rol del Sistema"}),e[104]=he):he=e[104];const Ve=t.role;let Y;e[105]!==i?(Y=l=>i("role",l),e[105]=i,e[106]=Y):Y=e[106];let be;e[107]===Symbol.for("react.memo_cache_sentinel")?(be=s.jsx(Ce,{className:"w-full",children:s.jsx(_e,{placeholder:"Seleccione un Rol"})}),e[107]=be):be=e[107];const Me=m.map(Qe);let Z;e[108]!==Me?(Z=s.jsx(Se,{children:Me}),e[108]=Me,e[109]=Z):Z=e[109],e[110]!==t.role||e[111]!==Y||e[112]!==Z?(h=s.jsxs("div",{className:"mb-6",children:[he,s.jsxs(we,{value:Ve,onValueChange:Y,children:[be,Z]})]}),e[110]=t.role,e[111]=Y,e[112]=Z,e[113]=h):h=e[113],e[114]!==t.department||e[115]!==t.role||e[116]!==i?(b=t.role==="inspector"&&s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Departamento"}),s.jsxs(we,{value:t.department,onValueChange:l=>i("department",l),children:[s.jsx(Ce,{className:"w-full",children:s.jsx(_e,{placeholder:"Seleccione Departamento"})}),s.jsxs(Se,{children:[s.jsx(ve,{value:"Material Mayor",children:"Material Mayor"}),s.jsx(ve,{value:"Material Menor",children:"Material Menor"})]})]})]}),e[114]=t.department,e[115]=t.role,e[116]=i,e[117]=b):b=e[117],_=t.role!=="admin"&&t.role!=="capitan"&&t.role!=="maquinista"&&t.role!=="inspector"&&s.jsxs("div",{children:[s.jsx("label",{className:"mb-3 block text-sm font-medium",children:"Permisos por Módulo"}),s.jsx("div",{className:"space-y-6",children:Je.map(l=>qe.some(a=>a.category===l)&&s.jsxs("div",{className:"rounded-md border p-3",children:[s.jsx("h4",{className:"mb-2 text-sm font-semibold text-foreground",children:l}),s.jsx("table",{className:"w-full text-sm",children:s.jsx("tbody",{className:"divide-y",children:qe.filter(a=>a.category===l).map(a=>s.jsxs("tr",{children:[s.jsx("td",{className:"w-1/3 py-2.5 font-medium",children:a.label}),s.jsx("td",{className:"py-2",children:s.jsxs("div",{className:"flex gap-1 rounded-md bg-muted/50 p-1",children:[s.jsx("button",{type:"button",onClick:()=>ne(a.id,"none"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(a.id)==="none"?"bg-background shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ninguno"}),s.jsx("button",{type:"button",onClick:()=>ne(a.id,"view"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(a.id)==="view"?"bg-blue-100 text-blue-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ver"}),s.jsx("button",{type:"button",onClick:()=>ne(a.id,"edit"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(a.id)==="edit"?"bg-green-100 text-green-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Editar"}),(a.id==="vehicles"||a.id==="equipment")&&s.jsx("button",{type:"button",onClick:()=>ne(a.id,"full"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(a.id)==="full"?"bg-purple-100 text-purple-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Total"})]})})]},a.id))})})]},l))}),s.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"'Editar' incluye permisos de 'Ver'."})]}),e[4]=v,e[5]=t.company,e[6]=t.department,e[7]=t.driver_vehicles,e[8]=t.email,e[9]=t.name,e[10]=t.password,e[11]=t.permissions,e[12]=t.role,e[13]=r.company,e[14]=r.email,e[15]=r.name,e[16]=r.password,e[17]=I,e[18]=i,e[19]=g,e[20]=y,e[21]=j,e[22]=N,e[23]=d,e[24]=M,e[25]=u,e[26]=w,e[27]=p,e[28]=f,e[29]=C,e[30]=x,e[31]=h,e[32]=b,e[33]=_}else g=e[19],y=e[20],j=e[21],N=e[22],d=e[23],M=e[24],u=e[25],w=e[26],p=e[27],f=e[28],C=e[29],x=e[30],h=e[31],b=e[32],_=e[33];let S;e[118]!==C||e[119]!==x||e[120]!==h||e[121]!==b||e[122]!==_?(S=s.jsxs("div",{className:C,children:[x,h,b,_]}),e[118]=C,e[119]=x,e[120]=h,e[121]=b,e[122]=_,e[123]=S):S=e[123];let k;e[124]!==c||e[125]!==t.driver_vehicles||e[126]!==y?(k=c&&c.length>0&&s.jsxs("div",{className:"rounded-lg border p-4",children:[s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(ze,{className:"size-4"})," Vehículos Permitidos (Maquinistas)"]}),s.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Seleccione los vehículos que este usuario está autorizado a conducir y registrar en bitácora."}),s.jsx(Be,{className:"h-[200px] w-full rounded-md border p-4",children:s.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:c.map(m=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Fe,{id:`v-${m.id}`,checked:t.driver_vehicles.includes(m.id),onCheckedChange:()=>y(m.id)}),s.jsxs("label",{htmlFor:`v-${m.id}`,className:"text-sm leading-none font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[m.name," ",s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",m.company,")"]})]})]},m.id))})})]}),e[124]=c,e[125]=t.driver_vehicles,e[126]=y,e[127]=k):k=e[127];let q;e[128]!==je?(q=s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{type:"submit",disabled:je,className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-8 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90 focus-visible:ring-2 focus-visible:ring-primary focus-visible:outline-none disabled:opacity-50",children:"Registrar Usuario"})}),e[128]=je,e[129]=q):q=e[129];let $;e[130]!==j||e[131]!==N||e[132]!==d||e[133]!==S||e[134]!==k||e[135]!==q?($=s.jsxs("form",{onSubmit:j,className:N,children:[d,S,k,q]}),e[130]=j,e[131]=N,e[132]=d,e[133]=S,e[134]=k,e[135]=q,e[136]=$):$=e[136];let E;e[137]!==M||e[138]!==u||e[139]!==$?(E=s.jsxs("div",{className:M,children:[u,$]}),e[137]=M,e[138]=u,e[139]=$,e[140]=E):E=e[140];let R;e[141]!==w||e[142]!==E?(R=s.jsx("div",{className:w,children:E}),e[141]=w,e[142]=E,e[143]=R):R=e[143];let le;return e[144]!==g||e[145]!==p||e[146]!==f||e[147]!==R?(le=s.jsxs(g,{breadcrumbs:p,children:[f,R]}),e[144]=g,e[145]=p,e[146]=f,e[147]=R,e[148]=le):le=e[148],le}function Qe(n){return s.jsx(ve,{value:n.value,children:n.label},n.value)}function Ke(n){return s.jsx(ve,{value:n,children:n},n)}function Xe(n){return n.startsWith("equipment.")}function Ye(n){return n==="equipment.view"||n==="equipment.edit"||n==="equipment.full"}export{us as default};
