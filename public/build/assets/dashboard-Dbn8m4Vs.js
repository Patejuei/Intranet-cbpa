import{c as pe,r as de,b as fe,j as e,L as a,H as je}from"./app-B9QcLIWa.js";import{R as ge,B as be,M as oe,A as Ne}from"./app-layout-2OmtfUSy.js";import{f as _}from"./button-B8ZIXrdG.js";import{C as ve}from"./clock-C7YEOzqS.js";/* empty css            */import"./index-BkrslbVE.js";import"./index-CIQYj8wZ.js";import"./index-q7GIQJN5.js";import"./shield-DgM9RD2J.js";const ye=[{title:"Panel Principal",href:"/dashboard"}],we="recent_modules";function Ke(t){const s=pe.c(63),{upcomingBatteries:w,pendingTickets:d,respondedTickets:E,vehiclesStopped:M,pendingIncidents:C,vehiclesInWorkshop:T,expiringDocuments:ie,pendingPettyCash:$}=t;let z;s[0]!==w?(z=w===void 0?[]:w,s[0]=w,s[1]=z):z=s[1];const P=z;let R;s[2]!==d?(R=d===void 0?[]:d,s[2]=d,s[3]=R):R=s[3];const D=R;let I;s[4]!==E?(I=E===void 0?[]:E,s[4]=E,s[5]=I):I=s[5];const q=I;let V;s[6]!==M?(V=M===void 0?[]:M,s[6]=M,s[7]=V):V=s[7];const B=V;let L;s[8]!==C?(L=C===void 0?[]:C,s[8]=C,s[9]=L):L=s[9];const A=L;let O;s[10]!==T?(O=T===void 0?[]:T,s[10]=T,s[11]=O):O=s[11];const W=O,F=ie===void 0?[]:ie;let K;s[12]!==$?(K=$===void 0?[]:$,s[12]=$,s[13]=K):K=s[13];const U=K;let H;s[14]===Symbol.for("react.memo_cache_sentinel")?(H=[],s[14]=H):H=s[14];const[J,me]=de.useState(H),[te,xe]=de.useState(!1),{auth:n}=fe().props;let Y;s[15]!==n.user?(Y=r=>{const l=n.user;if(!l)return!1;if(l.role==="admin"||l.role==="capitan"||l.role==="comandante"||r.permission==="vehicles"&&["cuartelero","mechanic"].includes(l.role||""))return!0;if(l.role==="inspector"){const ce=(l.department||"").trim(),se=r.permission;if(ce==="Material Mayor"){if(["vehicles.status","vehicles.incidents","vehicles.inventory","vehicles.logs","vehicles.workshop","vehicles.checklist","vehicles"].some(S=>S===se||S.startsWith(se+".")))return!0}else if(ce==="Material Menor"&&["inventory","tickets","batteries","deliveries","reception","equipment"].some(S=>S===se||S.startsWith(se+".")))return!0}const k=l.permissions||[],y=r.permission;return k.includes(y)||k.includes(`${y}.view`)||k.includes(`${y}.edit`)},s[15]=n.user,s[16]=Y):Y=s[16];const i=Y;let G;s[17]!==i?(G=()=>{try{const r=localStorage.getItem(we);if(r){const k=JSON.parse(r).map(De).filter(y=>!!y&&i(y));me(k)}}catch(r){console.error("Error loading recent modules",r)}},s[17]=i,s[18]=G):G=s[18];let Q;s[19]!==n.user?(Q=[n.user],s[19]=n.user,s[20]=Q):Q=s[20],de.useEffect(G,Q);const re=Re,le=Ne,ne=ye;let c;s[21]===Symbol.for("react.memo_cache_sentinel")?(c=e.jsx(je,{title:"Material Menor - CBPA"}),s[21]=c):c=s[21];const ue="flex flex-1 flex-col gap-8 p-4";let o;s[22]!==U?(o=U.length>0&&e.jsxs("div",{className:"rounded-xl border border-l-4 border-l-blue-600 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[e.jsx(ge,{className:"size-5 text-blue-600"}),"Rendiciones de Caja Chica"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Solicitudes pendientes de visación o aprobación."})]}),e.jsx("div",{className:"space-y-3",children:U.map(Pe)})]}),s[22]=U,s[23]=o):o=s[23];let m;s[24]!==D?(m=D.length>0&&e.jsxs("div",{className:"rounded-xl border border-l-4 border-l-yellow-500 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[e.jsx("span",{className:"flex size-3 rounded-full bg-yellow-500"}),"Tickets Pendientes"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Solicitudes que requieren atención."})]}),e.jsx("div",{className:"space-y-3",children:D.map(ze)})]}),s[24]=D,s[25]=m):m=s[25];let x;s[26]!==q?(x=q.length>0&&e.jsxs("div",{className:"rounded-xl border border-l-4 border-l-blue-500 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[e.jsx("span",{className:"flex size-3 rounded-full bg-blue-500"}),"Tickets en Proceso"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Solicitudes con respuesta de Comandancia."})]}),e.jsx("div",{className:"space-y-3",children:q.map($e)})]}),s[26]=q,s[27]=x):x=s[27];let u;s[28]!==B?(u=B.length>0&&e.jsxs("div",{className:"rounded-xl border border-l-4 border-l-red-500 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[e.jsx("span",{className:"flex size-3 rounded-full bg-red-500"}),"Material Fuera de Servicio"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehículos detenidos o en taller."})]}),e.jsx("div",{className:"space-y-3",children:B.map(Te)})]}),s[28]=B,s[29]=u):u=s[29];let h;s[30]!==A?(h=A.length>0&&e.jsxs("div",{className:"rounded-xl border border-l-4 border-l-orange-500 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[e.jsx("span",{className:"flex size-3 rounded-full bg-orange-500"}),"Incidencias Pendientes"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Novedades reportadas sin resolver."})]}),e.jsx("div",{className:"space-y-3",children:A.map(Ce)})]}),s[30]=A,s[31]=h):h=s[31];let p;s[32]!==u||s[33]!==h?(p=e.jsxs("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2",children:[u,h]}),s[32]=u,s[33]=h,s[34]=p):p=s[34];let f;s[35]!==W?(f=W.length>0&&e.jsxs("div",{className:"rounded-xl border border-l-4 border-l-yellow-600 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[e.jsx("span",{className:"flex size-3 rounded-full bg-yellow-600"}),"Unidades en Taller"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehículos con orden de trabajo activa."})]}),e.jsx("div",{className:"space-y-3",children:W.map(Me)})]}),s[35]=W,s[36]=f):f=s[36];const ae=F.length>0&&(n.user.role==="capitan"||n.user.role==="maquinista"||n.user.role==="comandante"||n.user.role==="inspector"&&n.user.department==="Material Mayor")&&e.jsxs("div",{className:"rounded-xl border border-l-4 border-l-red-600 bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[e.jsx("span",{className:"flex size-3 animate-pulse rounded-full bg-red-600"}),"Vencimiento de Documentación"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehículos con documentación próxima a vencer o vencida."})]}),e.jsx("div",{className:"space-y-3",children:F.slice(0,te?void 0:5).map(_e)}),F.length>5&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:()=>xe(!te),className:"text-sm font-medium text-primary hover:underline",children:te?"Ver menos":`Ver más (${F.length-5} restantes)`})})]});let j;s[37]!==re||s[38]!==P?(j=P.length>0&&e.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-3 text-primary",children:e.jsx(be,{className:"size-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Próximos Cambios de Baterías"}),e.jsx("p",{className:"text-muted-foreground",children:"Equipos que requieren atención pronto"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b text-left font-medium text-muted-foreground",children:[e.jsx("th",{className:"pb-2",children:"Fecha"}),e.jsx("th",{className:"pb-2",children:"Días"}),e.jsx("th",{className:"pb-2",children:"Equipo"}),e.jsx("th",{className:"pb-2",children:"Responsable"}),e.jsx("th",{className:"pb-2",children:"Compañía"})]})}),e.jsx("tbody",{className:"divide-y",children:P.map(r=>{const l=re(r.next_change_date);return e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:_(r.next_change_date)}),e.jsx("td",{className:"py-3",children:e.jsxs("span",{className:`rounded px-2 py-1 font-bold ${l<=3?"bg-destructive/20 text-destructive":"bg-muted text-muted-foreground"}`,children:[l," días"]})}),e.jsx("td",{className:"py-3",children:r.equipment_type}),e.jsx("td",{className:"py-3",children:r.responsible_name}),e.jsx("td",{className:"py-3",children:r.company})]},r.id)})})]})})]}),s[37]=re,s[38]=P,s[39]=j):j=s[39];let g;s[40]!==J?(g=J.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ve,{className:"size-4"}),e.jsx("h2",{className:"text-sm font-medium tracking-wider uppercase",children:"Visitados Recientemente"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:J.map(Se)})]}),s[40]=J,s[41]=g):g=s[41];let X;s[42]===Symbol.for("react.memo_cache_sentinel")?(X=e.jsx("h2",{className:"text-sm font-medium tracking-wider text-muted-foreground uppercase",children:"Todos los Módulos"}),s[42]=X):X=s[42];let b;s[43]!==i?(b=oe.filter(ke).map(r=>{if(!i(r))return null;const l=r.icon;return e.jsx(a,{href:r.href,className:"group relative overflow-hidden rounded-xl border bg-card p-6 shadow-sm transition-all hover:border-primary hover:shadow-md",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-3 text-primary transition-colors group-hover:bg-primary group-hover:text-primary-foreground",children:e.jsx(l,{className:"size-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:r.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]})]})},r.key)}),s[43]=i,s[44]=b):b=s[44];let N;s[45]!==b?(N=e.jsxs("div",{className:"space-y-4",children:[X,e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3",children:b})]}),s[45]=b,s[46]=N):N=s[46];let Z;s[47]===Symbol.for("react.memo_cache_sentinel")?(Z=e.jsxs("div",{className:"rounded-xl border bg-muted/40 p-6",children:[e.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Bienvenido al Sistema de Material Menor"}),e.jsx("p",{className:"text-muted-foreground",children:"Seleccione una opción de arriba para comenzar sus operaciones."})]}),s[47]=Z):Z=s[47];let v;s[48]!==o||s[49]!==m||s[50]!==x||s[51]!==p||s[52]!==f||s[53]!==ae||s[54]!==j||s[55]!==g||s[56]!==N?(v=e.jsxs("div",{className:ue,children:[o,m,x,p,f,ae,j,g,N,Z]}),s[48]=o,s[49]=m,s[50]=x,s[51]=p,s[52]=f,s[53]=ae,s[54]=j,s[55]=g,s[56]=N,s[57]=v):v=s[57];let ee;return s[58]!==le||s[59]!==ne||s[60]!==c||s[61]!==v?(ee=e.jsxs(le,{breadcrumbs:ne,children:[c,v]}),s[58]=le,s[59]=ne,s[60]=c,s[61]=v,s[62]=ee):ee=s[62],ee}function ke(t){return!t.key.startsWith("admin-")}function Se(t){const s=t.icon;return e.jsxs(a,{href:t.href,className:"group relative flex items-center gap-3 overflow-hidden rounded-lg border bg-card p-4 shadow-sm transition-all hover:border-primary hover:shadow-md",children:[e.jsx("div",{className:"rounded-md bg-primary/10 p-2 text-primary transition-colors group-hover:bg-primary group-hover:text-primary-foreground",children:e.jsx(s,{className:"size-5"})}),e.jsx("div",{children:e.jsx("h3",{className:"leading-none font-medium",children:t.title})})]},t.key)}function _e(t){return e.jsx(a,{href:`/vehicles/status/${t.id}`,className:"block",children:e.jsxs("div",{className:"flex flex-col gap-2 rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-bold",children:t.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.company})]}),e.jsx("div",{className:"flex flex-col gap-1",children:t.alerts.map(Ee)})]})},t.id)}function Ee(t,s){return e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:t.label}),e.jsxs("span",{className:`font-medium ${t.status==="danger"?"text-red-600":"text-orange-600"}`,children:[t.date," ","(",t.days," ","días)"]})]},s)}function Me(t){const s=t.maintenances?.[0];return e.jsx(a,{href:`/vehicles/status/${t.id}`,className:"block",children:e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-bold",children:t.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.company,")"]})]}),s?e.jsxs("p",{className:"text-xs font-medium text-yellow-700",children:[s.workshop_name," ","-"," ",s.description]}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sin detalles de orden."})]}),s?.entry_date&&e.jsxs("div",{className:"flex items-center gap-1 font-mono text-xs text-muted-foreground",children:["Ingreso:"," ",_(s.entry_date)]})]})},t.id)}function Ce(t){return e.jsx(a,{href:"/vehicles/incidents",className:"block",children:e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"line-clamp-1 font-medium",children:[t.vehicle.name," -"," ",t.description]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Reportado:"," ",_(t.created_at)]})]}),e.jsx("div",{className:"rounded bg-orange-100 px-2 py-1 text-xs text-orange-700",children:t.severity})]})},t.id)}function Te(t){return e.jsx(a,{href:`/vehicles/status/${t.id}`,className:"block",children:e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.company})]}),e.jsx("div",{className:`rounded px-2 py-1 text-xs font-medium ${t.status==="Out of Service"?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"}`,children:t.status==="Out of Service"?"Fuera de Servicio":"En Taller"})]})},t.id)}function $e(t){return e.jsx(a,{href:`/tickets/${t.id}`,className:"block",children:e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.subject}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Estado: ",t.status]})]}),e.jsx("div",{className:"rounded bg-blue-100 px-2 py-1 text-xs text-blue-700",children:"Ver Respuesta"})]})},t.id)}function ze(t){return e.jsx(a,{href:`/tickets/${t.id}`,className:"block",children:e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.subject}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.user.company," -"," ",t.user.name]})]}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:_(t.created_at)})]})},t.id)}function Pe(t){return e.jsx(a,{href:`/vehicles/petty-cash/${t.id}`,className:"block",children:e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.user.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.description||"Sin descripción"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-blue-700",children:new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(t.amount)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:_(t.created_at)})]})]})},t.id)}function Re(t){const s=new Date,d=new Date(t).getTime()-s.getTime();return Math.ceil(d/864e5)}function De(t){return oe.find(s=>s.key===t)}export{Ke as default};
