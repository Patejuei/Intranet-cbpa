import{c as ue,b as be,u as je,r as ve,j as t,H as _e,L as Se}from"./app-POeEJ9jb.js";import{P as ye,C as Ce,a as Ne,b as Ie,c as we,d as Pe,e as qe,f as Ae,g as Fe,M as De}from"./MaterialSelector-UxUYtQtp.js";import{B as K,c as Ee}from"./button-b-d64DVq.js";import{I as xe}from"./input-DOjdrUoQ.js";import{L as Q}from"./label-CRoYbBDD.js";import{b as Te,A as ke}from"./app-layout-D8iWbJXT.js";import{C as Le}from"./check-7yMZDl2-.js";import{P as Oe}from"./plus-CgHjL58t.js";import{S as ze}from"./save-BfDrRvef.js";import{T as Me}from"./trash-DowClAOB.js";/* empty css            */import"./index-DdLfwd3F.js";import"./search-DtgiDnku.js";import"./index-BSOmSsQS.js";import"./index-C4J_hXM0.js";import"./shield-BJxPqUTl.js";function lt(V){const e=ue.c(107),{firefighters:i,materials:r}=V,{auth:v}=be().props,n=v.user;let x;e[0]===Symbol.for("react.memo_cache_sentinel")?(x=new Date().toISOString().split("T"),e[0]=x):x=e[0];const f=n.company==="Comandancia"||n.role==="admin"||n.role==="capitan"?"Segunda Compañía":n.company;let m;e[1]===Symbol.for("react.memo_cache_sentinel")?(m=[{material_id:"",quantity:1}],e[1]=m):m=e[1];let c;e[2]!==f?(c={firefighter_id:"",date:x[0],observations:"",company:f,items:m},e[2]=f,e[3]=c):c=e[3];const{data:a,setData:s,post:g,processing:u,errors:o}=je(c),[d,_]=ve.useState(!1);let h;e[4]!==a.items||e[5]!==s?(h=()=>{s("items",[...a.items,{material_id:"",quantity:1}])},e[4]=a.items,e[5]=s,e[6]=h):h=e[6];const b=h;let j;e[7]!==a.items||e[8]!==s?(j=l=>{const p=[...a.items];p.splice(l,1),s("items",p)},e[7]=a.items,e[8]=s,e[9]=j):j=e[9];const U=j;let W;e[10]!==a.items||e[11]!==s?(W=(l,p,pe)=>{const ge=[...a.items];ge[l][p]=pe,s("items",ge)},e[10]=a.items,e[11]=s,e[12]=W):W=e[12];const J=W;let X;e[13]!==g?(X=l=>{l.preventDefault(),g("/deliveries")},e[13]=g,e[14]=X):X=e[14];const he=X;let Y,Z;e[15]===Symbol.for("react.memo_cache_sentinel")?(Z=[{title:"Actas de Entrega",href:"/deliveries"},{title:"Nueva Acta",href:"/deliveries/create"}],Y=t.jsx(_e,{title:"Nueva Acta de Entrega"}),e[15]=Y,e[16]=Z):(Y=e[15],Z=e[16]);let ee;e[17]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Nueva Acta de Entrega"}),t.jsx("p",{className:"text-muted-foreground",children:"Registre la entrega de material a un voluntario."})]}),e[17]=ee):ee=e[17];let te;e[18]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx(Q,{children:"Bombero Receptor"}),e[18]=te):te=e[18];let S;e[19]!==a.firefighter_id||e[20]!==i?(S=a.firefighter_id?i.find(l=>l.id.toString()===a.firefighter_id)?.full_name:"Seleccione bombero...",e[19]=a.firefighter_id,e[20]=i,e[21]=S):S=e[21];let ae;e[22]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx(Te,{className:"opacity-50"}),e[22]=ae):ae=e[22];let y;e[23]!==d||e[24]!==S?(y=t.jsx(ye,{asChild:!0,children:t.jsxs(K,{variant:"outline",role:"combobox","aria-expanded":d,className:"w-full justify-between",children:[S,ae]})}),e[23]=d,e[24]=S,e[25]=y):y=e[25];let se;e[26]===Symbol.for("react.memo_cache_sentinel")?(se=t.jsx(Ce,{placeholder:"Buscar bombero..."}),e[26]=se):se=e[26];let le;e[27]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx(Ne,{children:"No se encontró bombero."}),e[27]=le):le=e[27];let C;if(e[28]!==a.firefighter_id||e[29]!==i||e[30]!==s){let l;e[32]!==a.firefighter_id||e[33]!==s?(l=p=>t.jsxs(Ie,{value:p.full_name,onSelect:()=>{s("firefighter_id",p.id.toString()),_(!1)},children:[p.full_name,t.jsx(Le,{className:Ee("ml-auto",a.firefighter_id===p.id.toString()?"opacity-100":"opacity-0")})]},p.id),e[32]=a.firefighter_id,e[33]=s,e[34]=l):l=e[34],C=i.map(l),e[28]=a.firefighter_id,e[29]=i,e[30]=s,e[31]=C}else C=e[31];let N;e[35]!==C?(N=t.jsx(we,{className:"w-[--radix-popover-trigger-width] p-0",children:t.jsxs(Pe,{children:[se,t.jsxs(qe,{children:[le,t.jsx(Ae,{children:C})]})]})}),e[35]=C,e[36]=N):N=e[36];let I;e[37]!==d||e[38]!==y||e[39]!==N?(I=t.jsxs(Fe,{open:d,onOpenChange:_,children:[y,N]}),e[37]=d,e[38]=y,e[39]=N,e[40]=I):I=e[40];let w;e[41]!==o.firefighter_id?(w=o.firefighter_id&&t.jsx("p",{className:"text-sm text-red-500",children:o.firefighter_id}),e[41]=o.firefighter_id,e[42]=w):w=e[42];let P;e[43]!==I||e[44]!==w?(P=t.jsxs("div",{className:"flex flex-col gap-2",children:[te,I,w]}),e[43]=I,e[44]=w,e[45]=P):P=e[45];let ie;e[46]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx(Q,{htmlFor:"date",children:"Fecha"}),e[46]=ie):ie=e[46];let q;e[47]!==s?(q=l=>s("date",l.target.value),e[47]=s,e[48]=q):q=e[48];let A;e[49]!==a.date||e[50]!==q?(A=t.jsx(xe,{id:"date",type:"date",value:a.date,onChange:q,required:!0}),e[49]=a.date,e[50]=q,e[51]=A):A=e[51];let F;e[52]!==o.date?(F=o.date&&t.jsx("p",{className:"text-sm text-red-500",children:o.date}),e[52]=o.date,e[53]=F):F=e[53];let D;e[54]!==A||e[55]!==F?(D=t.jsxs("div",{className:"grid gap-2",children:[ie,A,F]}),e[54]=A,e[55]=F,e[56]=D):D=e[56];let E;e[57]!==P||e[58]!==D?(E=t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[P,D]}),e[57]=P,e[58]=D,e[59]=E):E=e[59];let re;e[60]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx(Q,{htmlFor:"company",children:"Compañía"}),e[60]=re):re=e[60];let T;e[61]!==s?(T=l=>s("company",l),e[61]=s,e[62]=T):T=e[62];let k;e[63]!==a.company||e[64]!==T?(k=t.jsxs("div",{className:"grid gap-2",children:[re,t.jsx(Be,{value:a.company,onChange:T})]}),e[63]=a.company,e[64]=T,e[65]=k):k=e[65];let L;e[66]!==E||e[67]!==k?(L=t.jsxs("div",{className:"grid gap-4 rounded-xl border bg-card p-6 shadow-sm",children:[E,k]}),e[66]=E,e[67]=k,e[68]=L):L=e[68];let oe;e[69]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx("h3",{className:"text-lg font-semibold",children:"Materiales"}),e[69]=oe):oe=e[69];let ne;e[70]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsx(Oe,{className:"mr-2 size-4"}),e[70]=ne):ne=e[70];let O;e[71]!==b?(O=t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[oe,t.jsxs(K,{type:"button",variant:"outline",size:"sm",onClick:b,children:[ne," Agregar Item"]})]}),e[71]=b,e[72]=O):O=e[72];let z;if(e[73]!==a.items||e[74]!==r||e[75]!==U||e[76]!==J){let l;e[78]!==a.items.length||e[79]!==r||e[80]!==U||e[81]!==J?(l=(p,pe)=>t.jsx(Re,{item:p,index:pe,materials:r,updateItem:J,removeItem:U,isSingle:a.items.length===1},pe),e[78]=a.items.length,e[79]=r,e[80]=U,e[81]=J,e[82]=l):l=e[82],z=a.items.map(l),e[73]=a.items,e[74]=r,e[75]=U,e[76]=J,e[77]=z}else z=e[77];let M;e[83]!==z?(M=t.jsx("div",{className:"space-y-4",children:z}),e[83]=z,e[84]=M):M=e[84];let R;e[85]!==o.items?(R=o.items&&t.jsx("p",{className:"mt-2 text-sm text-red-500",children:o.items}),e[85]=o.items,e[86]=R):R=e[86];let B;e[87]!==O||e[88]!==M||e[89]!==R?(B=t.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[O,M,R]}),e[87]=O,e[88]=M,e[89]=R,e[90]=B):B=e[90];let me;e[91]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx(Q,{htmlFor:"observations",children:"Observaciones"}),e[91]=me):me=e[91];let $;e[92]!==s?($=l=>s("observations",l.target.value),e[92]=s,e[93]=$):$=e[93];let G;e[94]!==a.observations||e[95]!==$?(G=t.jsxs("div",{className:"grid gap-2 rounded-xl border bg-card p-6 shadow-sm",children:[me,t.jsx("textarea",{id:"observations",value:a.observations,onChange:$,className:"flex min-h-[80px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50"})]}),e[94]=a.observations,e[95]=$,e[96]=G):G=e[96];let ce;e[97]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(Se,{href:"/deliveries",children:t.jsx(K,{type:"button",variant:"outline",children:"Cancelar"})}),e[97]=ce):ce=e[97];let de;e[98]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx(ze,{className:"size-4"}),e[98]=de):de=e[98];let H;e[99]!==u?(H=t.jsxs("div",{className:"flex justify-end gap-4",children:[ce,t.jsxs(K,{type:"submit",disabled:u,className:"gap-2",children:[de," Guardar Acta"]})]}),e[99]=u,e[100]=H):H=e[100];let fe;return e[101]!==he||e[102]!==L||e[103]!==B||e[104]!==G||e[105]!==H?(fe=t.jsxs(ke,{breadcrumbs:Z,children:[Y,t.jsxs("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-6 p-4",children:[ee,t.jsxs("form",{onSubmit:he,className:"flex flex-col gap-6",children:[L,B,G,H]})]})]}),e[101]=he,e[102]=L,e[103]=B,e[104]=G,e[105]=H,e[106]=fe):fe=e[106],fe}function Re(V){const e=ue.c(26),{item:i,index:r,materials:v,updateItem:n,removeItem:x,isSingle:f}=V;let m;e[0]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx(Q,{children:"Material"}),e[0]=m):m=e[0];const c=i.material_id?parseInt(i.material_id):void 0;let a;e[1]!==r||e[2]!==n?(a=j=>n(r,"material_id",j.toString()),e[1]=r,e[2]=n,e[3]=a):a=e[3];let s;e[4]!==v||e[5]!==c||e[6]!==a?(s=t.jsxs("div",{className:"flex flex-1 flex-col gap-2",children:[m,t.jsx(De,{materials:v,value:c,onChange:a,placeholder:"Seleccione material (Nombre, Cód, o S/N)..."})]}),e[4]=v,e[5]=c,e[6]=a,e[7]=s):s=e[7];let g;e[8]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsx(Q,{children:"Cantidad"}),e[8]=g):g=e[8];let u;e[9]!==r||e[10]!==n?(u=j=>n(r,"quantity",parseInt(j.target.value)),e[9]=r,e[10]=n,e[11]=u):u=e[11];let o;e[12]!==i.quantity||e[13]!==u?(o=t.jsxs("div",{className:"grid w-32 gap-2",children:[g,t.jsx(xe,{type:"number",min:"1",value:i.quantity,onChange:u,required:!0})]}),e[12]=i.quantity,e[13]=u,e[14]=o):o=e[14];let d;e[15]!==r||e[16]!==x?(d=()=>x(r),e[15]=r,e[16]=x,e[17]=d):d=e[17];let _;e[18]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx(Me,{className:"size-4"}),e[18]=_):_=e[18];let h;e[19]!==f||e[20]!==d?(h=t.jsx(K,{type:"button",variant:"ghost",size:"icon",className:"text-red-500 hover:bg-red-50 hover:text-red-600",onClick:d,disabled:f,children:_}),e[19]=f,e[20]=d,e[21]=h):h=e[21];let b;return e[22]!==h||e[23]!==s||e[24]!==o?(b=t.jsxs("div",{className:"flex items-end gap-4 border-b pb-4 last:border-0 last:pb-0",children:[s,o,h]}),e[22]=h,e[23]=s,e[24]=o,e[25]=b):b=e[25],b}function Be(V){const e=ue.c(7),{value:i,onChange:r}=V,{auth:v}=be().props,n=v.user;if(!(n.role==="admin"||n.role==="capitan"||n.company==="Comandancia")){let a;return e[0]!==i?(a=t.jsx(xe,{value:i,disabled:!0,className:"bg-muted text-muted-foreground opacity-100"}),e[0]=i,e[1]=a):a=e[1],a}let f;e[2]===Symbol.for("react.memo_cache_sentinel")?(f=t.jsx(SelectTrigger,{className:"w-full",children:t.jsx(SelectValue,{placeholder:"Seleccione Compañía"})}),e[2]=f):f=e[2];let m;e[3]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsxs(SelectContent,{children:[t.jsx(SelectItem,{value:"Primera Compañía",children:"Primera Compañía"}),t.jsx(SelectItem,{value:"Segunda Compañía",children:"Segunda Compañía"}),t.jsx(SelectItem,{value:"Tercera Compañía",children:"Tercera Compañía"}),t.jsx(SelectItem,{value:"Cuarta Compañía",children:"Cuarta Compañía"}),t.jsx(SelectItem,{value:"Quinta Compañía",children:"Quinta Compañía"}),t.jsx(SelectItem,{value:"Séptima Compañía",children:"Séptima Compañía"}),t.jsx(SelectItem,{value:"Octava Compañía",children:"Octava Compañía"}),t.jsx(SelectItem,{value:"Novena Compañía",children:"Novena Compañía"}),t.jsx(SelectItem,{value:"Décima Compañía",children:"Décima Compañía"}),t.jsx(SelectItem,{value:"Comandancia",children:"Comandancia"})]}),e[3]=m):m=e[3];let c;return e[4]!==r||e[5]!==i?(c=t.jsxs(Select,{value:i,onValueChange:r,children:[f,m]}),e[4]=r,e[5]=i,e[6]=c):c=e[6],c}export{lt as default};
