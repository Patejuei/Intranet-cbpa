import{c as ke,b as Ce,j as s,L as ne,H as Se}from"./app-U2vxHv-X.js";import{B as be}from"./badge-1ZL-UITF.js";import{a as Te,B as de,f as X}from"./button-FyRO0OzR.js";import{b as p,C as K,a as Q,c as u}from"./card-C4UHtn5o.js";import{W as Ne,A as $e,C as Ee,F as Le}from"./app-layout-4axmnVdW.js";import{C as ye}from"./circle-check-D2dTFHxV.js";import{C as _e}from"./circle-alert-DSA5YoDd.js";import{C as ge}from"./calendar-BhhaSwZ4.js";import{A as Me}from"./arrow-left-O4XMXuVu.js";/* empty css            */import"./index-DU5z2y3-.js";import"./index-D32ltWjn.js";import"./index-C4J_hXM0.js";import"./shield-CcbdmCEL.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],De=Te("DollarSign",Ae);function as(a){const e=ke.c(134),{vehicle:t,totalMaintenanceCost:Y}=a,l=Ce().props,r=t.issues?.[0],i=t.maintenances?.[0],ve=We,oe=Be;let f,j,N,g,b,c,y,n,d,_,v,o,m,x,w,h,k;if(e[0]!==l.auth||e[1]!==t.circulation_permit_expires_at||e[2]!==t.company||e[3]!==t.id||e[4]!==t.insurance_expires_at||e[5]!==t.make||e[6]!==t.model||e[7]!==t.name||e[8]!==t.plate||e[9]!==t.status||e[10]!==t.technical_review_expires_at||e[11]!==t.year){const me=[{label:"Revisión Técnica",date:t.technical_review_expires_at,check:oe(t.technical_review_expires_at)},{label:"Permiso de Circulación",date:t.circulation_permit_expires_at,check:oe(t.circulation_permit_expires_at)},{label:"Seguro Obligatorio",date:t.insurance_expires_at,check:oe(t.insurance_expires_at)}];N=$e;let ee;e[29]===Symbol.for("react.memo_cache_sentinel")?(ee={title:"Material Mayor",href:"/vehicles/status"},e[29]=ee):ee=e[29];const xe=`/vehicles/status/${t.id}`;e[30]!==xe||e[31]!==t.name?(n=[ee,{title:t.name,href:xe}],e[30]=xe,e[31]=t.name,e[32]=n):n=e[32];const he=`Detalle ${t.name}`;e[33]!==he?(d=s.jsx(Se,{title:he}),e[33]=he,e[34]=d):d=e[34],b="mx-auto flex w-full max-w-7xl flex-col gap-6 p-4";let se;e[35]===Symbol.for("react.memo_cache_sentinel")?(se=s.jsx(de,{variant:"ghost",size:"icon",asChild:!0,children:s.jsx(ne,{href:"/vehicles/status",children:s.jsx(Me,{className:"h-5 w-5"})})}),e[35]=se):se=e[35];const we=t.name,pe=ve(t.status),ue=t.status==="Operative"?"En Servicio":t.status==="Workshop"?"En Taller":"Fuera de Servicio";let V;e[36]!==pe||e[37]!==ue?(V=s.jsx(be,{className:pe,children:ue}),e[36]=pe,e[37]=ue,e[38]=V):V=e[38];let F;e[39]!==V||e[40]!==t.name?(F=s.jsxs("h1",{className:"flex items-center gap-3 text-2xl font-bold",children:[we,V]}),e[39]=V,e[40]=t.name,e[41]=F):F=e[41];let H;e[42]!==t.company||e[43]!==t.make||e[44]!==t.model?(H=s.jsxs("p",{className:"text-muted-foreground",children:[t.company," - ",t.make," ",t.model]}),e[42]=t.company,e[43]=t.make,e[44]=t.model,e[45]=H):H=e[45];let P;e[46]!==F||e[47]!==H?(P=s.jsxs("div",{className:"flex items-center gap-4",children:[se,s.jsxs("div",{children:[F,H]})]}),e[46]=F,e[47]=H,e[48]=P):P=e[48];const fe=`/vehicles/logs?vehicle_id=${t.id}`;let te;e[49]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx(Ee,{className:"mr-2 h-4 w-4"}),e[49]=te):te=e[49];let B;e[50]!==fe?(B=s.jsx(de,{variant:"outline",asChild:!0,children:s.jsxs(ne,{href:fe,children:[te,"Ver Bitácora"]})}),e[50]=fe,e[51]=B):B=e[51];const je=`/vehicles/checklists?vehicle_id=${t.id}`;let ae;e[52]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsx(Le,{className:"mr-2 h-4 w-4"}),e[52]=ae):ae=e[52];let W;e[53]!==je?(W=s.jsx(de,{variant:"outline",asChild:!0,children:s.jsxs(ne,{href:je,children:[ae,"Ver Checklists"]})}),e[53]=je,e[54]=W):W=e[54];let R;e[55]!==l.auth||e[56]!==t.id?(R=l.auth?.user&&(l.auth.user.role==="admin"||l.auth.user.role==="capitan")&&s.jsx(de,{asChild:!0,children:s.jsxs(ne,{href:`/vehicles/${t.id}/edit`,children:[s.jsx(Ne,{className:"mr-2 h-4 w-4"}),"Editar Unidad"]})}),e[55]=l.auth,e[56]=t.id,e[57]=R):R=e[57];let z;e[58]!==B||e[59]!==W||e[60]!==R?(z=s.jsxs("div",{className:"flex flex-wrap gap-2",children:[B,W,R]}),e[58]=B,e[59]=W,e[60]=R,e[61]=z):z=e[61],e[62]!==P||e[63]!==z?(c=s.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[P,z]}),e[62]=P,e[63]=z,e[64]=c):c=e[64],y=me.some(Pe)&&s.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:me.map(He)}),k="grid grid-cols-1 gap-6 md:grid-cols-3",j=p,w="md:col-span-2",e[65]===Symbol.for("react.memo_cache_sentinel")?(h=s.jsx(K,{children:s.jsx(Q,{children:"Información del Vehículo"})}),e[65]=h):h=e[65],f=u,v="space-y-4";let le;e[66]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Patente"}),e[66]=le):le=e[66];let q;e[67]!==t.plate?(q=s.jsxs("div",{children:[le,s.jsx("p",{className:"text-lg font-semibold",children:t.plate})]}),e[67]=t.plate,e[68]=q):q=e[68];let ie;e[69]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Año"}),e[69]=ie):ie=e[69];let U;e[70]!==t.year?(U=s.jsxs("div",{children:[ie,s.jsx("p",{className:"text-lg font-semibold",children:t.year})]}),e[70]=t.year,e[71]=U):U=e[71];let re;e[72]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Marca"}),e[72]=re):re=e[72];let G;e[73]!==t.make?(G=s.jsxs("div",{children:[re,s.jsx("p",{className:"text-lg font-semibold",children:t.make})]}),e[73]=t.make,e[74]=G):G=e[74];let ce;e[75]===Symbol.for("react.memo_cache_sentinel")?(ce=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Modelo"}),e[75]=ce):ce=e[75];let J;e[76]!==t.model?(J=s.jsxs("div",{children:[ce,s.jsx("p",{className:"text-lg font-semibold",children:t.model})]}),e[76]=t.model,e[77]=J):J=e[77],e[78]!==q||e[79]!==U||e[80]!==G||e[81]!==J?(o=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[q,U,G,J]}),e[78]=q,e[79]=U,e[80]=G,e[81]=J,e[82]=o):o=e[82],e[83]===Symbol.for("react.memo_cache_sentinel")?(m=s.jsx("hr",{className:"my-4"}),x=s.jsx("h3",{className:"mb-2 font-medium",children:"Documentación"}),e[83]=m,e[84]=x):(m=e[83],x=e[84]),g="grid grid-cols-1 gap-4 sm:grid-cols-3",_=me.map(Fe),e[0]=l.auth,e[1]=t.circulation_permit_expires_at,e[2]=t.company,e[3]=t.id,e[4]=t.insurance_expires_at,e[5]=t.make,e[6]=t.model,e[7]=t.name,e[8]=t.plate,e[9]=t.status,e[10]=t.technical_review_expires_at,e[11]=t.year,e[12]=f,e[13]=j,e[14]=N,e[15]=g,e[16]=b,e[17]=c,e[18]=y,e[19]=n,e[20]=d,e[21]=_,e[22]=v,e[23]=o,e[24]=m,e[25]=x,e[26]=w,e[27]=h,e[28]=k}else f=e[12],j=e[13],N=e[14],g=e[15],b=e[16],c=e[17],y=e[18],n=e[19],d=e[20],_=e[21],v=e[22],o=e[23],m=e[24],x=e[25],w=e[26],h=e[27],k=e[28];let C;e[85]!==g||e[86]!==_?(C=s.jsx("div",{className:g,children:_}),e[85]=g,e[86]=_,e[87]=C):C=e[87];let S;e[88]!==l.auth||e[89]!==Y?(S=l.auth?.user&&(l.auth.user.company==="Comandancia"||l.auth.user.role==="admin")&&s.jsxs("div",{className:"mt-4 rounded-md bg-blue-50 p-4",children:[s.jsxs("div",{className:"mb-1 flex items-center gap-2 text-blue-800",children:[s.jsx(De,{className:"h-5 w-5"}),s.jsx("span",{className:"font-bold",children:"Inversión Total en Mantenimiento"})]}),s.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:["$",(Y||0).toLocaleString("es-CL")]}),s.jsx("p",{className:"mt-1 text-xs text-blue-700",children:"Suma histórica de todas los trabajos realizados."})]}),e[88]=l.auth,e[89]=Y,e[90]=S):S=e[90];let T;e[91]!==f||e[92]!==C||e[93]!==S||e[94]!==v||e[95]!==o||e[96]!==m||e[97]!==x?(T=s.jsxs(f,{className:v,children:[o,m,x,C,S]}),e[91]=f,e[92]=C,e[93]=S,e[94]=v,e[95]=o,e[96]=m,e[97]=x,e[98]=T):T=e[98];let $;e[99]!==j||e[100]!==T||e[101]!==w||e[102]!==h?($=s.jsxs(j,{className:w,children:[h,T]}),e[99]=j,e[100]=T,e[101]=w,e[102]=h,e[103]=$):$=e[103];let E;e[104]!==t.status?(E=t.status==="Operative"&&s.jsxs(p,{className:"border-green-200 bg-green-50",children:[s.jsx(K,{className:"pb-2",children:s.jsxs(Q,{className:"flex items-center gap-2 text-green-800",children:[s.jsx(ye,{className:"h-5 w-5"}),"Unidad Operativa"]})}),s.jsx(u,{children:s.jsx("p",{className:"text-sm text-green-700",children:"La unidad se encuentra operativa y disponible para el servicio."})})]}),e[104]=t.status,e[105]=E):E=e[105];let L;e[106]!==r||e[107]!==t.status?(L=t.status==="Out of Service"&&r&&s.jsxs(p,{className:"border-red-200 bg-red-50",children:[s.jsx(K,{className:"pb-2",children:s.jsxs(Q,{className:"flex items-center gap-2 text-red-800",children:[s.jsx(_e,{className:"h-5 w-5"}),"Fuera de Servicio"]})}),s.jsxs(u,{className:"space-y-2",children:[s.jsx("p",{className:"text-sm font-medium text-red-900",children:"Motivo:"}),s.jsx("p",{className:"text-sm text-red-800",children:r.description}),s.jsxs("div",{className:"mt-2 flex gap-2 text-xs text-red-700",children:[s.jsx(ge,{className:"h-3 w-3"})," ",r.date?X(r.date):X(r.created_at)]})]})]}),e[106]=r,e[107]=t.status,e[108]=L):L=e[108];let M;e[109]!==r||e[110]!==i||e[111]!==t.status?(M=(t.status==="Workshop"||t.status==="Out of Service"&&!r&&i)&&(i?s.jsxs(p,{className:"border-yellow-200 bg-yellow-50",children:[s.jsx(K,{className:"pb-2",children:s.jsxs(Q,{className:"flex items-center gap-2 text-yellow-800",children:[s.jsx(Ne,{className:"h-5 w-5"}),"En Taller (",i.status==="Scheduled"?"Agendado":"En Proceso",")"]})}),s.jsxs(u,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-yellow-900",children:i.workshop_name}),s.jsx("p",{className:"text-sm text-yellow-800",children:i.description}),s.jsxs("div",{className:"mt-1 flex gap-2 text-xs text-yellow-700",children:[s.jsx(ge,{className:"h-3 w-3"})," ","Ingreso:"," ",X(i.entry_date)]})]}),i.tasks&&i.tasks.length>0&&s.jsxs("div",{className:"rounded-md bg-white/50 p-3",children:[s.jsx("h4",{className:"mb-2 text-xs font-bold tracking-wider text-yellow-900 uppercase",children:"Tareas"}),s.jsx("div",{className:"space-y-2",children:i.tasks.map(Ve)})]}),i.issues&&i.issues.length>0&&s.jsxs("div",{className:"rounded-md bg-white/50 p-3",children:[s.jsx("h4",{className:"mb-2 text-xs font-bold tracking-wider text-yellow-900 uppercase",children:"Incidencias Asociadas"}),s.jsx("ul",{className:"list-disc pl-4 text-sm text-slate-700",children:i.issues.map(Ie)})]})]})]}):s.jsxs(p,{className:"border-yellow-200 bg-yellow-50",children:[s.jsx(K,{className:"pb-2",children:s.jsxs(Q,{className:"flex items-center gap-2 text-yellow-800",children:[s.jsx(Ne,{className:"h-5 w-5"}),"En Taller"]})}),s.jsx(u,{children:s.jsx("p",{className:"text-sm text-yellow-800",children:"No hay información detallada de la orden de trabajo."})})]})),e[109]=r,e[110]=i,e[111]=t.status,e[112]=M):M=e[112];let A;e[113]!==E||e[114]!==L||e[115]!==M?(A=s.jsxs("div",{className:"space-y-6",children:[E,L,M]}),e[113]=E,e[114]=L,e[115]=M,e[116]=A):A=e[116];let D;e[117]!==$||e[118]!==A||e[119]!==k?(D=s.jsxs("div",{className:k,children:[$,A]}),e[117]=$,e[118]=A,e[119]=k,e[120]=D):D=e[120];let O;e[121]!==t.maintenances?(O=t.maintenances&&t.maintenances.length>0&&s.jsxs(p,{children:[s.jsx(K,{children:s.jsx(Q,{children:"Historial de Órdenes de Trabajo"})}),s.jsx(u,{children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left text-sm",children:[s.jsx("thead",{className:"border-b bg-muted/50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-2 py-3 font-medium",children:"Fecha Ingreso"}),s.jsx("th",{className:"p-2 py-3 font-medium",children:"Taller"}),s.jsx("th",{className:"p-2 py-3 font-medium",children:"Trabajo"}),s.jsx("th",{className:"p-2 py-3 font-medium",children:"Estado"}),s.jsx("th",{className:"p-2 py-3 text-right font-medium",children:"Costo"})]})}),s.jsx("tbody",{children:t.maintenances.map(Oe)})]})})})]}),e[121]=t.maintenances,e[122]=O):O=e[122];let I;e[123]!==b||e[124]!==c||e[125]!==y||e[126]!==D||e[127]!==O?(I=s.jsxs("div",{className:b,children:[c,y,D,O]}),e[123]=b,e[124]=c,e[125]=y,e[126]=D,e[127]=O,e[128]=I):I=e[128];let Z;return e[129]!==N||e[130]!==n||e[131]!==d||e[132]!==I?(Z=s.jsxs(N,{breadcrumbs:n,children:[d,I]}),e[129]=N,e[130]=n,e[131]=d,e[132]=I,e[133]=Z):Z=e[133],Z}function Oe(a){return s.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/20",children:[s.jsx("td",{className:"p-2 py-3",children:X(a.entry_date)}),s.jsx("td",{className:"p-2 py-3",children:a.workshop_name}),s.jsx("td",{className:"p-2 py-3",children:a.description}),s.jsx("td",{className:"p-2 py-3",children:s.jsx(be,{variant:"outline",className:["Finalizado","Entregado"].includes(a.status)?"border-green-200 bg-green-50 text-green-700":"border-yellow-200 bg-yellow-50 text-yellow-700",children:a.status})}),s.jsx("td",{className:"p-2 py-3 text-right",children:a.cost>0?`$${a.cost.toLocaleString("es-CL")}`:"-"})]},a.id)}function Ie(a){return s.jsxs("li",{children:[a.description,a.status==="Resolved"&&s.jsx("span",{className:"ml-2 text-xs font-bold text-green-600",children:"(Solucionado)"})]},a.id)}function Ve(a){return s.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[a.is_completed?s.jsx(ye,{className:"mt-0.5 h-4 w-4 text-green-600"}):s.jsx("div",{className:"mt-0.5 h-4 w-4 rounded-full border-2 border-slate-300"}),s.jsx("span",{className:a.is_completed?"text-slate-700 line-through opacity-70":"font-medium text-slate-800",children:a.description})]},a.id)}function Fe(a,e){return s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:a.label}),s.jsx("p",{className:"text-sm font-semibold",children:a.date?X(a.date):"No registrado"})]},e)}function He(a,e){return!a.check||a.check.status==="ok"?null:s.jsx(p,{className:`border-l-4 ${a.check.status==="expired"?"border-l-red-500 bg-red-50":"border-l-yellow-500 bg-yellow-50"}`,children:s.jsx(u,{className:"pt-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(_e,{className:`h-5 w-5 ${a.check.status==="expired"?"text-red-600":"text-yellow-600"}`}),s.jsxs("div",{children:[s.jsxs("p",{className:`font-semibold ${a.check.status==="expired"?"text-red-700":"text-yellow-700"}`,children:[a.label," ",a.check.status==="expired"?"Vencido":"Por Vencer"]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Vence:"," ",X(a.date)," ",s.jsxs("span",{className:"font-medium",children:["(",Math.abs(a.check.days)," ","días"," ",a.check.status==="expired"?"atrasado":"restantes",")"]})]})]})]})})},e)}function Pe(a){return a.check?.status==="expired"||a.check?.status==="warning"}function Be(a){if(!a)return null;const e=new Date(a),t=new Date,Y=e.getTime()-t.getTime(),l=Math.ceil(Y/864e5);return l<0?{status:"expired",days:l}:l<=30?{status:"warning",days:l}:{status:"ok",days:l}}function We(a){switch(a){case"Operative":return"bg-green-100 text-green-800";case"Workshop":return"bg-yellow-100 text-yellow-800";case"Out of Service":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}export{as as default};
