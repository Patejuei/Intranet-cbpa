import{c as Ve,u as qe,r as Be,j as t,H as He,L as Oe}from"./app-CGuCfgbg.js";import{B as ve}from"./badge-DjUDnTMd.js";import{a as Me,B as r}from"./button-D65nKyRz.js";import{b as De,C as ke,a as Le,c as ze}from"./card-D3-mtHTa.js";import{b as Ue,D as Xe,a as We,f as Ge,c as Je,d as Ke}from"./dialog-Cl0ohANF.js";import{L as G}from"./label-DIhg13Fn.js";import{S as Ae}from"./separator-D6HNAH-k.js";import{T as Qe}from"./textarea-DIcnwD8F.js";import{F as Ye,A as Ze}from"./app-layout-u9Q5DKjD.js";import{C as Ie}from"./circle-check-C_yslydW.js";import{U as $e}from"./user-Cl_iRD7w.js";import{C as Fe}from"./clock-DF8j1yjr.js";import{A as et}from"./arrow-left-B0nEp31l.js";/* empty css            */import"./index-CUc2K9e4.js";import"./index-Cq7Q3MAY.js";import"./index-q7GIQJN5.js";import"./shield-7FbujOzr.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ee=Me("CircleX",tt);function bt(be){const e=Ve.c(143),{rendition:s,canVisaInspector:J,canVisaComandante:K}=be;let Q;e[0]===Symbol.for("react.memo_cache_sentinel")?(Q={action:"",reason:""},e[0]=Q):Q=e[0];const{data:Ne,setData:a,post:i,processing:l,errors:Y,reset:c}=qe(Q),[ye,W]=Be.useState(!1);let Z;e[1]!==i||e[2]!==s.id||e[3]!==c||e[4]!==a?(Z=()=>{confirm("¿Está seguro de VISAR esta rendición?")&&(a("action","approve"),i(`/vehicles/petty-cash/${s.id}/review`,{onSuccess:()=>c()}))},e[1]=i,e[2]=s.id,e[3]=c,e[4]=a,e[5]=Z):Z=e[5];const ee=Z;let te;e[6]!==i||e[7]!==s.id||e[8]!==c||e[9]!==a?(te=()=>{a("action","reject"),i(`/vehicles/petty-cash/${s.id}/review`,{onSuccess:()=>{W(!1),c()}})},e[6]=i,e[7]=s.id,e[8]=c,e[9]=a,e[10]=te):te=e[10];const Ce=te,Pe=st;let se;e[11]===Symbol.for("react.memo_cache_sentinel")?(se={title:"Caja Chica",href:"/vehicles/petty-cash"},e[11]=se):se=e[11];const Se=`Rendición #${s.id}`;let n;e[12]!==Se?(n=[se,{title:Se,href:"#"}],e[12]=Se,e[13]=n):n=e[13];const we=`Rendición #${s.id}`;let o;e[14]!==we?(o=t.jsx(He,{title:we}),e[14]=we,e[15]=o):o=e[15];let ae;e[16]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx(r,{variant:"ghost",size:"icon",asChild:!0,children:t.jsx(Oe,{href:"/vehicles/petty-cash",children:t.jsx(et,{className:"h-5 w-5"})})}),e[16]=ae):ae=e[16];let d;e[17]!==s.id?(d=t.jsxs("h1",{className:"text-2xl font-bold",children:["Rendición #",s.id]}),e[17]=s.id,e[18]=d):d=e[18];const Te=s.user.name;let m;e[19]!==s.created_at?(m=new Date(s.created_at).toLocaleDateString(),e[19]=s.created_at,e[20]=m):m=e[20];let x;e[21]!==s.user.name||e[22]!==m?(x=t.jsxs("p",{className:"text-muted-foreground",children:["Solicitado por ",Te," el"," ",m]}),e[21]=s.user.name,e[22]=m,e[23]=x):x=e[23];let f;e[24]!==d||e[25]!==x?(f=t.jsxs("div",{className:"flex items-center gap-4",children:[ae,t.jsxs("div",{children:[d,x]})]}),e[24]=d,e[25]=x,e[26]=f):f=e[26];let le;e[27]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx(ke,{children:t.jsx(Le,{children:"Detalles de la Rendición"})}),e[27]=le):le=e[27];let re;e[28]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx(G,{className:"text-muted-foreground",children:"Monto Solicitado"}),e[28]=re):re=e[28];let h;e[29]!==s.amount?(h=Pe(s.amount),e[29]=s.amount,e[30]=h):h=e[30];let u;e[31]!==h?(u=t.jsxs("div",{className:"space-y-1",children:[re,t.jsx("div",{className:"text-2xl font-bold",children:h})]}),e[31]=h,e[32]=u):u=e[32];let ie;e[33]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx(G,{className:"text-muted-foreground",children:"Estado Actual"}),e[33]=ie):ie=e[33];let p;e[34]!==s.status?(p=s.status==="approved"&&t.jsx(ve,{className:"bg-green-100 text-green-700",children:"Liberado a Pago"}),e[34]=s.status,e[35]=p):p=e[35];let j;e[36]!==s.status?(j=s.status==="pending_inspector"&&t.jsx(ve,{variant:"outline",className:"border-orange-200 text-orange-600",children:"Pendiente Inspector"}),e[36]=s.status,e[37]=j):j=e[37];let g;e[38]!==s.status?(g=s.status==="pending_comandante"&&t.jsx(ve,{variant:"outline",className:"border-blue-200 text-blue-600",children:"Pendiente Comandante"}),e[38]=s.status,e[39]=g):g=e[39];let _;e[40]!==s.status?(_=s.status==="rejected"&&t.jsx(ve,{variant:"destructive",children:"Rechazado"}),e[40]=s.status,e[41]=_):_=e[41];let v;e[42]!==p||e[43]!==j||e[44]!==g||e[45]!==_?(v=t.jsxs("div",{className:"space-y-1",children:[ie,t.jsxs("div",{children:[p,j,g,_]})]}),e[42]=p,e[43]=j,e[44]=g,e[45]=_,e[46]=v):v=e[46];let b;e[47]!==u||e[48]!==v?(b=t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u,v]}),e[47]=u,e[48]=v,e[49]=b):b=e[49];let ce;e[50]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(Ae,{}),e[50]=ce):ce=e[50];let ne;e[51]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsx(G,{className:"text-muted-foreground",children:"Descripción"}),e[51]=ne):ne=e[51];const Re=s.description||"Sin descripción.";let N;e[52]!==Re?(N=t.jsxs("div",{className:"space-y-2",children:[ne,t.jsx("p",{className:"text-sm",children:Re})]}),e[52]=Re,e[53]=N):N=e[53];let oe;e[54]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx(Ae,{}),e[54]=oe):oe=e[54];let de;e[55]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx(G,{className:"text-muted-foreground",children:"Comprobantes Adjuntos"}),e[55]=de):de=e[55];let y;if(e[56]!==s.attachments||e[57]!==s.id){let U;e[59]!==s.id?(U=X=>t.jsx("a",{href:`/vehicles/petty-cash/${s.id}/attachments/${X.id}`,target:"_blank",rel:"noreferrer",className:"group relative aspect-square overflow-hidden rounded-lg border bg-muted transition-all hover:ring-2 hover:ring-primary",children:X.mime_type?.startsWith("image/")?t.jsx("img",{src:`/vehicles/petty-cash/${s.id}/attachments/${X.id}`,alt:X.file_name,className:"h-full w-full object-cover"}):t.jsxs("div",{className:"flex h-full flex-col items-center justify-center p-2 text-center text-xs text-muted-foreground",children:[t.jsx(Ye,{className:"mb-2 h-8 w-8"}),X.file_name]})},X.id),e[59]=s.id,e[60]=U):U=e[60],y=s.attachments.map(U),e[56]=s.attachments,e[57]=s.id,e[58]=y}else y=e[58];let C;e[61]!==y?(C=t.jsxs("div",{className:"space-y-4",children:[de,t.jsx("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3",children:y})]}),e[61]=y,e[62]=C):C=e[62];let S;e[63]!==b||e[64]!==N||e[65]!==C?(S=t.jsx("div",{className:"space-y-6 md:col-span-2",children:t.jsxs(De,{children:[le,t.jsxs(ze,{className:"space-y-6",children:[b,ce,N,oe,C]})]})}),e[63]=b,e[64]=N,e[65]=C,e[66]=S):S=e[66];let w;e[67]!==K||e[68]!==J||e[69]!==ee||e[70]!==l||e[71]!==s.status?(w=(s.status==="pending_inspector"||s.status==="pending_comandante")&&t.jsxs(De,{className:"border-blue-100 bg-blue-50/50",children:[t.jsx(ke,{children:t.jsx(Le,{className:"text-base",children:"Acciones Requeridas"})}),t.jsxs(ze,{className:"flex flex-col gap-2",children:[s.status==="pending_inspector"&&J&&t.jsxs(t.Fragment,{children:[t.jsxs(r,{className:"w-full bg-green-600 hover:bg-green-700",onClick:ee,disabled:l,children:[t.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Visar como Inspector"]}),t.jsxs(r,{variant:"destructive",className:"w-full",onClick:()=>W(!0),disabled:l,children:[t.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Rechazar"]})]}),s.status==="pending_comandante"&&K&&t.jsxs(t.Fragment,{children:[t.jsxs(r,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:ee,disabled:l,children:[t.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Visar y Liberar a Pago"]}),t.jsxs(r,{variant:"destructive",className:"w-full",onClick:()=>W(!0),disabled:l,children:[t.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Rechazar"]})]}),(s.status==="pending_inspector"&&!J||s.status==="pending_comandante"&&!K)&&t.jsx("p",{className:"text-center text-sm text-muted-foreground",children:"No tiene permisos para visar en esta etapa."})]})]}),e[67]=K,e[68]=J,e[69]=ee,e[70]=l,e[71]=s.status,e[72]=w):w=e[72];let me;e[73]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx(ke,{children:t.jsx(Le,{className:"text-base",children:"Línea de Tiempo"})}),e[73]=me):me=e[73];let xe,fe;e[74]===Symbol.for("react.memo_cache_sentinel")?(xe=t.jsx("div",{className:"absolute -left-[21px] flex h-3 w-3 items-center justify-center rounded-full bg-primary ring-4 ring-background"}),fe=t.jsx("p",{className:"text-sm font-medium",children:"Solicitud Creada"}),e[74]=xe,e[75]=fe):(xe=e[74],fe=e[75]);let he;e[76]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx($e,{className:"h-3 w-3"}),e[76]=he):he=e[76];let R;e[77]!==s.user.name?(R=t.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[he,s.user.name]}),e[77]=s.user.name,e[78]=R):R=e[78];let ue;e[79]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx(Fe,{className:"h-3 w-3"}),e[79]=ue):ue=e[79];let D;e[80]!==s.created_at?(D=new Date(s.created_at).toLocaleString(),e[80]=s.created_at,e[81]=D):D=e[81];let k;e[82]!==D?(k=t.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[ue,D]}),e[82]=D,e[83]=k):k=e[83];let L;e[84]!==R||e[85]!==k?(L=t.jsxs("div",{className:"relative",children:[xe,fe,R,k]}),e[84]=R,e[85]=k,e[86]=L):L=e[86];let z;e[87]!==s.comandante_vised_at||e[88]!==s.inspector||e[89]!==s.inspector_vised_at||e[90]!==s.rejected_at||e[91]!==s.rejected_by?.name?(z=(s.inspector_vised_at||s.rejected_at)&&t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:`absolute -left-[21px] flex h-3 w-3 items-center justify-center rounded-full ring-4 ring-background ${s.rejected_at&&!s.comandante_vised_at?"bg-red-500":"bg-green-500"}`}),t.jsx("p",{className:"text-sm font-medium",children:"Revisión Inspector"}),s.inspector?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[t.jsx($e,{className:"h-3 w-3"}),s.inspector.name]}),t.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[t.jsx(Fe,{className:"h-3 w-3"}),new Date(s.inspector_vised_at).toLocaleString()]})]}):t.jsxs("p",{className:"text-xs text-red-500",children:["Rechazado por"," ",s.rejected_by?.name]})]}),e[87]=s.comandante_vised_at,e[88]=s.inspector,e[89]=s.inspector_vised_at,e[90]=s.rejected_at,e[91]=s.rejected_by?.name,e[92]=z):z=e[92];let $;e[93]!==s.comandante||e[94]!==s.comandante_vised_at||e[95]!==s.inspector_vised_at||e[96]!==s.rejected_at||e[97]!==s.rejected_by?.name||e[98]!==s.status?($=(s.comandante_vised_at||s.rejected_at&&s.inspector_vised_at)&&t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:`absolute -left-[21px] flex h-3 w-3 items-center justify-center rounded-full ring-4 ring-background ${s.status==="approved"?"bg-green-500":"bg-red-500"}`}),t.jsx("p",{className:"text-sm font-medium",children:"Revisión Comandante"}),s.comandante?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[t.jsx($e,{className:"h-3 w-3"}),s.comandante.name]}),t.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[t.jsx(Fe,{className:"h-3 w-3"}),new Date(s.comandante_vised_at).toLocaleString()]})]}):t.jsxs("p",{className:"text-xs text-red-500",children:["Rechazado por"," ",s.rejected_by?.name]})]}),e[93]=s.comandante,e[94]=s.comandante_vised_at,e[95]=s.inspector_vised_at,e[96]=s.rejected_at,e[97]=s.rejected_by?.name,e[98]=s.status,e[99]=$):$=e[99];let F;e[100]!==s.status?(F=s.status==="approved"&&t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute -left-[21px] flex h-3 w-3 items-center justify-center rounded-full bg-green-500 ring-4 ring-background"}),t.jsx("p",{className:"text-sm font-bold text-green-700",children:"Liberado a Pago"})]}),e[100]=s.status,e[101]=F):F=e[101];let A;e[102]!==L||e[103]!==z||e[104]!==$||e[105]!==F?(A=t.jsxs(De,{children:[me,t.jsx(ze,{children:t.jsxs("div",{className:"space-y-6 border-l-2 border-muted pl-4",children:[L,z,$,F]})})]}),e[102]=L,e[103]=z,e[104]=$,e[105]=F,e[106]=A):A=e[106];let I;e[107]!==w||e[108]!==A?(I=t.jsxs("div",{className:"space-y-6",children:[w,A]}),e[107]=w,e[108]=A,e[109]=I):I=e[109];let E;e[110]!==S||e[111]!==I?(E=t.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[S,I]}),e[110]=S,e[111]=I,e[112]=E):E=e[112];let P;e[113]!==f||e[114]!==E?(P=t.jsxs("div",{className:"flex flex-1 flex-col gap-8 p-4",children:[f,E]}),e[113]=f,e[114]=E,e[115]=P):P=e[115];let pe;e[116]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsxs(Ue,{children:[t.jsx(Xe,{children:"Rechazar Rendición"}),t.jsx(We,{children:"Indique el motivo del rechazo. El solicitante será notificado."})]}),e[116]=pe):pe=e[116];let je;e[117]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsx(G,{children:"Motivo"}),e[117]=je):je=e[117];let T;e[118]!==a?(T=U=>a("reason",U.target.value),e[118]=a,e[119]=T):T=e[119];let V;e[120]!==Ne.reason||e[121]!==T?(V=t.jsx(Qe,{value:Ne.reason,onChange:T,placeholder:"Ej: Falta boleta, monto incorrecto..."}),e[120]=Ne.reason,e[121]=T,e[122]=V):V=e[122];let q;e[123]!==Y.reason?(q=Y.reason&&t.jsx("p",{className:"text-sm text-red-500",children:Y.reason}),e[123]=Y.reason,e[124]=q):q=e[124];let B;e[125]!==V||e[126]!==q?(B=t.jsxs("div",{className:"space-y-2",children:[je,V,q]}),e[125]=V,e[126]=q,e[127]=B):B=e[127];let ge;e[128]===Symbol.for("react.memo_cache_sentinel")?(ge=t.jsx(r,{variant:"secondary",onClick:()=>W(!1),children:"Cancelar"}),e[128]=ge):ge=e[128];let H;e[129]!==Ce||e[130]!==l?(H=t.jsxs(Ge,{children:[ge,t.jsx(r,{variant:"destructive",onClick:Ce,disabled:l,children:"Confirmar Rechazo"})]}),e[129]=Ce,e[130]=l,e[131]=H):H=e[131];let O;e[132]!==B||e[133]!==H?(O=t.jsxs(Je,{children:[pe,B,H]}),e[132]=B,e[133]=H,e[134]=O):O=e[134];let M;e[135]!==ye||e[136]!==O?(M=t.jsx(Ke,{open:ye,onOpenChange:W,children:O}),e[135]=ye,e[136]=O,e[137]=M):M=e[137];let _e;return e[138]!==P||e[139]!==n||e[140]!==M||e[141]!==o?(_e=t.jsxs(Ze,{breadcrumbs:n,children:[o,P,M]}),e[138]=P,e[139]=n,e[140]=M,e[141]=o,e[142]=_e):_e=e[142],_e}function st(be){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(be)}export{bt as default};
