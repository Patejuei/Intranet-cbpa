import{c as ye,b as we,u as Ie,r as Ce,j as t,d as qe,H as Pe,L as Ae,a as Re}from"./app-B61HxmhB.js";import{P as ke,C as Fe,a as Me,b as Te,c as De,d as Ee,e as Be,f as Le,g as Oe,M as ze}from"./MaterialSelector-DFii-3dC.js";import{B as Y,c as $e}from"./button-DEfvv7zK.js";import{I as Se}from"./input-BEDlWVnt.js";import{L as K}from"./label-CID0YnKh.js";import{a as Ve,b as Ge,c as He,d as u,S as Je}from"./select-C57hq6k-.js";import{b as Qe,A as Ue}from"./app-layout-B6JJyxYC.js";import{C as Ke}from"./check-CNavjS5x.js";import{P as We}from"./plus-DEtsulu_.js";import{S as Xe}from"./save-BILNXaPm.js";import{T as Ye}from"./trash-CHIs8J18.js";/* empty css            */import"./index-0lwPlNm7.js";import"./search-qkt-SUm_.js";import"./index-DnuNE2iH.js";import"./index-BDoUajTH.js";import"./index-q7GIQJN5.js";import"./shield-BxyVENHa.js";function _t(v){const e=ye.c(111),{firefighters:l}=v,{auth:n}=we().props,x=n.user;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=new Date().toISOString().split("T"),e[0]=c):c=e[0];const y=x.company==="Comandancia"||x.role==="admin"||x.role==="capitan"?"Segunda Compañía":x.company;let f;e[1]===Symbol.for("react.memo_cache_sentinel")?(f=[{material_id:"",quantity:1}],e[1]=f):f=e[1];let h;e[2]!==y?(h={firefighter_id:"",date:c[0],observations:"",company:y,items:f},e[2]=y,e[3]=h):h=e[3];const{data:a,setData:s,post:m,processing:o,errors:r}=Ie(h),[g,_]=Ce.useState(!1);let b;e[4]===Symbol.for("react.memo_cache_sentinel")?(b=[],e[4]=b):b=e[4];const[p,S]=Ce.useState(b);let j,C;e[5]!==a.firefighter_id?(j=()=>{a.firefighter_id?qe.get(`/api/assigned-materials/${a.firefighter_id}`).then(i=>{const d=i.data.map(et);S(d)}).catch(i=>{console.error("Error fetching assigned materials",i),S([])}):S([])},C=[a.firefighter_id],e[5]=a.firefighter_id,e[6]=j,e[7]=C):(j=e[6],C=e[7]),Ce.useEffect(j,C);let N;e[8]!==a.items||e[9]!==s?(N=()=>{s("items",[...a.items,{material_id:"",quantity:1}])},e[8]=a.items,e[9]=s,e[10]=N):N=e[10];const be=N;let Z;e[11]!==a.items||e[12]!==s?(Z=i=>{const d=[...a.items];d.splice(i,1),s("items",d)},e[11]=a.items,e[12]=s,e[13]=Z):Z=e[13];const W=Z;let ee;e[14]!==a.items||e[15]!==s?(ee=(i,d,ge)=>{const Ne=[...a.items];Ne[i][d]=ge,s("items",Ne)},e[14]=a.items,e[15]=s,e[16]=ee):ee=e[16];const X=ee;let te;e[17]!==m?(te=i=>{i.preventDefault(),m("/receptions")},e[17]=m,e[18]=te):te=e[18];const je=te;let ae,se;e[19]===Symbol.for("react.memo_cache_sentinel")?(ae=[{title:"Actas de Recepción",href:"/receptions"},{title:"Nueva Acta",href:"/receptions/create"}],se=t.jsx(Pe,{title:"Nueva Acta de Recepción"}),e[19]=ae,e[20]=se):(ae=e[19],se=e[20]);let ie;e[21]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Nueva Acta de Recepción"}),t.jsx("p",{className:"text-muted-foreground",children:"Registre la recepción de material devuelto por un voluntario."})]}),e[21]=ie):ie=e[21];let le;e[22]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx(K,{children:"Bombero (Entrega Material)"}),e[22]=le):le=e[22];let w;e[23]!==a.firefighter_id||e[24]!==l?(w=a.firefighter_id?l.find(i=>i.id.toString()===a.firefighter_id)?.full_name:"Seleccione bombero...",e[23]=a.firefighter_id,e[24]=l,e[25]=w):w=e[25];let re;e[26]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx(Qe,{className:"opacity-50"}),e[26]=re):re=e[26];let I;e[27]!==g||e[28]!==w?(I=t.jsx(ke,{asChild:!0,children:t.jsxs(Y,{variant:"outline",role:"combobox","aria-expanded":g,className:"w-full justify-between",children:[w,re]})}),e[27]=g,e[28]=w,e[29]=I):I=e[29];let oe;e[30]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx(Fe,{placeholder:"Buscar bombero..."}),e[30]=oe):oe=e[30];let ne;e[31]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsx(Me,{children:"No se encontró bombero."}),e[31]=ne):ne=e[31];let q;if(e[32]!==a.firefighter_id||e[33]!==l||e[34]!==s){let i;e[36]!==a.firefighter_id||e[37]!==s?(i=d=>t.jsxs(Te,{value:d.full_name,onSelect:()=>{s("firefighter_id",d.id.toString()),_(!1)},children:[d.full_name,t.jsx(Ke,{className:$e("ml-auto",a.firefighter_id===d.id.toString()?"opacity-100":"opacity-0")})]},d.id),e[36]=a.firefighter_id,e[37]=s,e[38]=i):i=e[38],q=l.map(i),e[32]=a.firefighter_id,e[33]=l,e[34]=s,e[35]=q}else q=e[35];let P;e[39]!==q?(P=t.jsx(De,{className:"w-[--radix-popover-trigger-width] p-0",children:t.jsxs(Ee,{children:[oe,t.jsxs(Be,{children:[ne,t.jsx(Le,{children:q})]})]})}),e[39]=q,e[40]=P):P=e[40];let A;e[41]!==g||e[42]!==I||e[43]!==P?(A=t.jsxs(Oe,{open:g,onOpenChange:_,children:[I,P]}),e[41]=g,e[42]=I,e[43]=P,e[44]=A):A=e[44];let R;e[45]!==r.firefighter_id?(R=r.firefighter_id&&t.jsx("p",{className:"text-sm text-red-500",children:r.firefighter_id}),e[45]=r.firefighter_id,e[46]=R):R=e[46];let k;e[47]!==A||e[48]!==R?(k=t.jsxs("div",{className:"flex flex-col gap-2",children:[le,A,R]}),e[47]=A,e[48]=R,e[49]=k):k=e[49];let ce;e[50]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(K,{htmlFor:"date",children:"Fecha"}),e[50]=ce):ce=e[50];const ve=a.date??"";let F;e[51]!==s?(F=i=>s("date",i.target.value),e[51]=s,e[52]=F):F=e[52];let M;e[53]!==ve||e[54]!==F?(M=t.jsx(Se,{type:"date",value:ve,onChange:F,onClick:Ze}),e[53]=ve,e[54]=F,e[55]=M):M=e[55];let T;e[56]!==r.date?(T=r.date&&t.jsx("p",{className:"text-sm text-red-500",children:r.date}),e[56]=r.date,e[57]=T):T=e[57];let D;e[58]!==M||e[59]!==T?(D=t.jsxs("div",{className:"grid gap-2",children:[ce,M,T]}),e[58]=M,e[59]=T,e[60]=D):D=e[60];let E;e[61]!==k||e[62]!==D?(E=t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[k,D]}),e[61]=k,e[62]=D,e[63]=E):E=e[63];let me;e[64]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx(K,{htmlFor:"company",children:"Compañía"}),e[64]=me):me=e[64];const _e=a.company||"";let B;e[65]!==s?(B=i=>s("company",i),e[65]=s,e[66]=B):B=e[66];let L;e[67]!==_e||e[68]!==B?(L=t.jsxs("div",{className:"grid gap-2",children:[me,t.jsx(at,{value:_e,onChange:B})]}),e[67]=_e,e[68]=B,e[69]=L):L=e[69];let O;e[70]!==E||e[71]!==L?(O=t.jsxs("div",{className:"grid gap-4 rounded-xl border bg-card p-6 shadow-sm",children:[E,L]}),e[70]=E,e[71]=L,e[72]=O):O=e[72];let de;e[73]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx("h3",{className:"text-lg font-semibold",children:"Materiales Recibidos"}),e[73]=de):de=e[73];let fe;e[74]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx(We,{className:"mr-2 size-4"}),e[74]=fe):fe=e[74];let z;e[75]!==be?(z=t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[de,t.jsxs(Y,{type:"button",variant:"outline",size:"sm",onClick:be,children:[fe," Agregar Item"]})]}),e[75]=be,e[76]=z):z=e[76];let $;if(e[77]!==p||e[78]!==a.items||e[79]!==W||e[80]!==X){let i;e[82]!==p||e[83]!==a.items.length||e[84]!==W||e[85]!==X?(i=(d,ge)=>t.jsx(tt,{item:d,index:ge,materials:p.length>0?p:[],updateItem:X,removeItem:W,isSingle:a.items.length===1},ge),e[82]=p,e[83]=a.items.length,e[84]=W,e[85]=X,e[86]=i):i=e[86],$=a.items.map(i),e[77]=p,e[78]=a.items,e[79]=W,e[80]=X,e[81]=$}else $=e[81];let V;e[87]!==$?(V=t.jsx("div",{className:"space-y-4",children:$}),e[87]=$,e[88]=V):V=e[88];let G;e[89]!==r.items?(G=r.items&&t.jsx("p",{className:"mt-2 text-sm text-red-500",children:r.items}),e[89]=r.items,e[90]=G):G=e[90];let H;e[91]!==z||e[92]!==V||e[93]!==G?(H=t.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[z,V,G]}),e[91]=z,e[92]=V,e[93]=G,e[94]=H):H=e[94];let pe;e[95]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx(K,{htmlFor:"observations",children:"Observaciones"}),e[95]=pe):pe=e[95];let J;e[96]!==s?(J=i=>s("observations",i.target.value),e[96]=s,e[97]=J):J=e[97];let Q;e[98]!==a.observations||e[99]!==J?(Q=t.jsxs("div",{className:"grid gap-2 rounded-xl border bg-card p-6 shadow-sm",children:[pe,t.jsx("textarea",{id:"observations",value:a.observations,onChange:J,className:"flex min-h-[80px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50"})]}),e[98]=a.observations,e[99]=J,e[100]=Q):Q=e[100];let he;e[101]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx(Ae,{href:"/receptions",children:t.jsx(Y,{type:"button",variant:"outline",children:"Cancelar"})}),e[101]=he):he=e[101];let ue;e[102]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx(Xe,{className:"size-4"}),e[102]=ue):ue=e[102];let U;e[103]!==o?(U=t.jsxs("div",{className:"flex justify-end gap-4",children:[he,t.jsxs(Y,{type:"submit",disabled:o,className:"gap-2",children:[ue," Guardar Acta"]})]}),e[103]=o,e[104]=U):U=e[104];let xe;return e[105]!==je||e[106]!==O||e[107]!==H||e[108]!==Q||e[109]!==U?(xe=t.jsxs(Ue,{breadcrumbs:ae,children:[se,t.jsxs("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-6 p-4",children:[ie,t.jsxs("form",{onSubmit:je,className:"flex flex-col gap-6",children:[O,H,Q,U]})]})]}),e[105]=je,e[106]=O,e[107]=H,e[108]=Q,e[109]=U,e[110]=xe):xe=e[110],xe}function Ze(v){return v.currentTarget.showPicker()}function et(v){return{...v.material,assigned_quantity:v.quantity}}function tt(v){const e=ye.c(30),{item:l,index:n,materials:x,updateItem:c,removeItem:y,isSingle:f}=v,h=x[0]?.assigned_quantity!==void 0?"(Disponibles en el bombero)":"";let a;e[0]!==h?(a=t.jsxs(K,{children:["Material"," ",h]}),e[0]=h,e[1]=a):a=e[1];const s=l.material_id?parseInt(l.material_id):void 0;let m;e[2]!==n||e[3]!==c?(m=N=>c(n,"material_id",N.toString()),e[2]=n,e[3]=c,e[4]=m):m=e[4];let o;e[5]!==x||e[6]!==s||e[7]!==m?(o=t.jsx(ze,{materials:x,value:s,onChange:m,placeholder:"Seleccione material (Nombre, Cód, o S/N)..."}),e[5]=x,e[6]=s,e[7]=m,e[8]=o):o=e[8];let r;e[9]!==a||e[10]!==o?(r=t.jsxs("div",{className:"flex flex-1 flex-col gap-2",children:[a,o]}),e[9]=a,e[10]=o,e[11]=r):r=e[11];let g;e[12]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsx(K,{children:"Cantidad"}),e[12]=g):g=e[12];let _;e[13]!==n||e[14]!==c?(_=N=>c(n,"quantity",parseInt(N.target.value)),e[13]=n,e[14]=c,e[15]=_):_=e[15];let b;e[16]!==l.quantity||e[17]!==_?(b=t.jsxs("div",{className:"grid w-32 gap-2",children:[g,t.jsx(Se,{type:"number",min:"1",value:l.quantity,onChange:_,required:!0})]}),e[16]=l.quantity,e[17]=_,e[18]=b):b=e[18];let p;e[19]!==n||e[20]!==y?(p=()=>y(n),e[19]=n,e[20]=y,e[21]=p):p=e[21];let S;e[22]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsx(Ye,{className:"size-4"}),e[22]=S):S=e[22];let j;e[23]!==f||e[24]!==p?(j=t.jsx(Y,{type:"button",variant:"ghost",size:"icon",className:"text-red-500 hover:bg-red-50 hover:text-red-600",onClick:p,disabled:f,children:S}),e[23]=f,e[24]=p,e[25]=j):j=e[25];let C;return e[26]!==j||e[27]!==r||e[28]!==b?(C=t.jsxs("div",{className:"flex items-end gap-4 border-b pb-4 last:border-0 last:pb-0",children:[r,b,j]}),e[26]=j,e[27]=r,e[28]=b,e[29]=C):C=e[29],C}function at(v){const e=ye.c(9),{value:l,onChange:n}=v,{auth:x}=we().props,c=x.user;if(!(c.role==="admin"||c.role==="capitan"||c.company==="Comandancia")){let o;return e[0]!==l?(o=t.jsx(Se,{value:l,disabled:!0,className:"bg-muted text-muted-foreground opacity-100"}),e[0]=l,e[1]=o):o=e[1],o}let f;e[2]!==n?(f=o=>{n(o),Re.get("/receptions/create",{company:o},{preserveState:!0,preserveScroll:!0,only:["materials"],replace:!0})},e[2]=n,e[3]=f):f=e[3];const h=f;let a;e[4]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsx(Ve,{className:"w-full",children:t.jsx(Ge,{placeholder:"Seleccione Compañía"})}),e[4]=a):a=e[4];let s;e[5]===Symbol.for("react.memo_cache_sentinel")?(s=t.jsxs(He,{children:[t.jsx(u,{value:"Primera Compañía",children:"Primera Compañía"}),t.jsx(u,{value:"Segunda Compañía",children:"Segunda Compañía"}),t.jsx(u,{value:"Tercera Compañía",children:"Tercera Compañía"}),t.jsx(u,{value:"Cuarta Compañía",children:"Cuarta Compañía"}),t.jsx(u,{value:"Quinta Compañía",children:"Quinta Compañía"}),t.jsx(u,{value:"Sexta Compañía",children:"Sexta Compañía"}),t.jsx(u,{value:"Séptima Compañía",children:"Séptima Compañía"}),t.jsx(u,{value:"Octava Compañía",children:"Octava Compañía"}),t.jsx(u,{value:"Novena Compañía",children:"Novena Compañía"}),t.jsx(u,{value:"Décima Compañía",children:"Décima Compañía"}),t.jsx(u,{value:"Brigada Juvenil",children:"Brigada Juvenil"}),t.jsx(u,{value:"Comandancia",children:"Comandancia"})]}),e[5]=s):s=e[5];let m;return e[6]!==h||e[7]!==l?(m=t.jsxs(Je,{value:l,onValueChange:h,children:[a,s]}),e[6]=h,e[7]=l,e[8]=m):m=e[8],m}export{_t as default};
