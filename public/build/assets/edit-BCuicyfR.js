import{c as Ue,b as De,u as Fe,j as s,H as Be}from"./app-U2vxHv-X.js";import{C as ze}from"./checkbox-P0QlflPv.js";import{S as Ge}from"./scroll-area-DDmPXDxG.js";import{S as $e,a as qe,b as Ee,c as Te,d as Re}from"./select-DXWYJTQP.js";import{T as He,A as Oe}from"./app-layout-4axmnVdW.js";import{S as We}from"./shield-CcbdmCEL.js";/* empty css            */import"./button-FyRO0OzR.js";import"./index-DU5z2y3-.js";import"./index-DPe-BYJ3.js";import"./index-D32ltWjn.js";import"./check-a4N9gWVE.js";import"./chevron-down-DeQ6wOE7.js";import"./index-C4J_hXM0.js";const Pe=[{id:"inventory",label:"Inventario",category:"Material Menor"},{id:"tickets",label:"Ticketera",category:"Material Menor"},{id:"batteries",label:"Baterías",category:"Material Menor"},{id:"equipment",label:"Material Menor (General)",category:"Material Menor"},{id:"deliveries",label:"Actas de Entrega",category:"Material Menor"},{id:"reception",label:"Actas de Recepción",category:"Material Menor"},{id:"vehicles",label:"Material Mayor (General)",category:"Material Mayor"},{id:"vehicles.incidents",label:"M. Mayor - Incidencias",category:"Material Mayor"},{id:"vehicles.checklist",label:"M. Mayor - Checklist",category:"Material Mayor"},{id:"vehicles.logs",label:"M. Mayor - Bitácora",category:"Material Mayor"},{id:"vehicles.workshop",label:"M. Mayor - Taller",category:"Material Mayor"},{id:"vehicles.inventory",label:"M. Mayor - Inventario",category:"Material Mayor"},{id:"firefighters",label:"Bomberos",category:"Administración"}],Je=["Material Menor","Material Mayor","Administración"],Le=["Primera Compañía","Segunda Compañía","Tercera Compañía","Cuarta Compañía","Quinta Compañía","Sexta Compañía","Séptima Compañía","Octava Compañía","Novena Compañía","Décima Compañía","Brigada Juvenil","Comandancia"],Qe=o=>{const e=[{value:"user",label:"Usuario Estándar"},{value:"admin",label:"Administrador del Sistema"},{value:"capitan",label:"Capitán"},{value:"teniente",label:"Teniente"},{value:"maquinista",label:"Maquinista"},{value:"ayudante",label:"Ayudante"},{value:"comandancia",label:"Comandancia"},{value:"cuartelero",label:"Cuartelero"},{value:"mechanic",label:"Taller Mecánico"}];if(o==="capitan"){const t=["user","teniente","maquinista","ayudante"];return e.filter(b=>t.includes(b.value))}return e},Ke=o=>{if(o==="capitan"){const e=["vehicles.inventory","vehicles.workshop","firefighters","vehicles","equipment"];return Pe.filter(t=>!e.includes(t.id))}return Pe};function xs(o){const e=Ue.c(159),{user:t,availableVehicles:b}=o,se=De().props.auth.user?.role||"user";let v;e[0]!==t.permissions?(v=t.permissions??[],e[0]=t.permissions,e[1]=v):v=e[1];let g;e[2]!==t.driver_vehicles?(g=t.driver_vehicles?.map(Ie)??[],e[2]=t.driver_vehicles,e[3]=g):g=e[3];let te;e[4]!==v||e[5]!==g||e[6]!==t.company||e[7]!==t.email||e[8]!==t.name||e[9]!==t.role?(te={name:t.name,email:t.email,password:"",company:t.company,role:t.role,permissions:v,driver_vehicles:g},e[4]=v,e[5]=g,e[6]=t.company,e[7]=t.email,e[8]=t.name,e[9]=t.role,e[10]=te):te=e[10];const{data:i,setData:r,put:ie,processing:Ne,errors:n}=Fe(te);let y,j,m,N,u,M,p,f,w,x,h,_,C,k;if(e[11]!==se||e[12]!==i.company||e[13]!==i.driver_vehicles||e[14]!==i.email||e[15]!==i.name||e[16]!==i.password||e[17]!==i.permissions||e[18]!==i.role||e[19]!==n.company||e[20]!==n.email||e[21]!==n.name||e[22]!==n.password||e[23]!==ie||e[24]!==r||e[25]!==t.id||e[26]!==t.name){const d=Qe(se),Ce=Ke(se);let ae;e[41]!==i.driver_vehicles||e[42]!==r?(ae=l=>{const a=i.driver_vehicles;a.includes(l)?r("driver_vehicles",a.filter(c=>c!==l)):r("driver_vehicles",[...a,l])},e[41]=i.driver_vehicles,e[42]=r,e[43]=ae):ae=e[43],j=ae;let re;e[44]!==ie||e[45]!==t.id?(re=l=>{l.preventDefault(),ie(`/admin/users/${t.id}`)},e[44]=ie,e[45]=t.id,e[46]=re):re=e[46];const Ve=re;let ne;e[47]!==i.permissions||e[48]!==r?(ne=(l,a)=>{const c=i.permissions.filter(Se=>!Se.startsWith(`${l}.`));a==="view"?c.push(`${l}.view`):a==="edit"?c.push(`${l}.view`,`${l}.edit`):a==="full"&&c.push(`${l}.view`,`${l}.edit`,`${l}.full`),["inventory","deliveries","reception"].includes(l)&&a!=="none"&&(c.some(Ze)||c.push("equipment.view")),r("permissions",c)},e[47]=i.permissions,e[48]=r,e[49]=ne):ne=e[49];const oe=ne;let ce;e[50]!==i.permissions?(ce=l=>{const a=i.permissions.includes(`${l}.full`),c=i.permissions.includes(`${l}.edit`),ke=i.permissions.includes(`${l}.view`);return a?"full":c?"edit":ke?"view":"none"},e[50]=i.permissions,e[51]=ce):ce=e[51];const de=ce;y=Oe;let me,ue;e[52]===Symbol.for("react.memo_cache_sentinel")?(me={title:"Panel Principal",href:"/dashboard"},ue={title:"Usuarios",href:"/admin/users"},e[52]=me,e[53]=ue):(me=e[52],ue=e[53]);const Me=`/admin/users/${t.id}/edit`;e[54]!==Me?(p=[me,ue,{title:"Editar Usuario",href:Me}],e[54]=Me,e[55]=p):p=e[55],e[56]===Symbol.for("react.memo_cache_sentinel")?(f=s.jsx(Be,{title:"Editar Usuario"}),e[56]=f):f=e[56],M="flex flex-col gap-6 p-4",N="max-w-4xl rounded-xl border bg-card p-6 shadow-sm";let R;e[57]!==t.name?(R=s.jsxs("h2",{className:"text-lg font-semibold text-foreground",children:["Editar Usuario: ",t.name]}),e[57]=t.name,e[58]=R):R=e[58];let pe;e[59]===Symbol.for("react.memo_cache_sentinel")?(pe=s.jsx("p",{className:"text-sm text-muted-foreground",children:"Modifique los detalles del usuario."}),e[59]=pe):pe=e[59],e[60]!==R?(u=s.jsxs("div",{className:"mb-6",children:[R,pe]}),e[60]=R,e[61]=u):u=e[61],C=Ve,k="space-y-6";let fe;e[62]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Nombre Completo"}),e[62]=fe):fe=e[62];let V;e[63]!==r?(V=l=>r("name",l.target.value),e[63]=r,e[64]=V):V=e[64];let A;e[65]!==i.name||e[66]!==V?(A=s.jsx("input",{type:"text",value:i.name,onChange:V,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[65]=i.name,e[66]=V,e[67]=A):A=e[67];let U;e[68]!==n.name?(U=n.name&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.name}),e[68]=n.name,e[69]=U):U=e[69];let D;e[70]!==A||e[71]!==U?(D=s.jsxs("div",{children:[fe,A,U]}),e[70]=A,e[71]=U,e[72]=D):D=e[72];let xe;e[73]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Correo Electrónico"}),e[73]=xe):xe=e[73];let F;e[74]!==r?(F=l=>r("email",l.target.value),e[74]=r,e[75]=F):F=e[75];let B;e[76]!==i.email||e[77]!==F?(B=s.jsx("input",{type:"email",value:i.email,onChange:F,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[76]=i.email,e[77]=F,e[78]=B):B=e[78];let z;e[79]!==n.email?(z=n.email&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.email}),e[79]=n.email,e[80]=z):z=e[80];let G;e[81]!==B||e[82]!==z?(G=s.jsxs("div",{children:[xe,B,z]}),e[81]=B,e[82]=z,e[83]=G):G=e[83];let H;e[84]!==D||e[85]!==G?(H=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[D,G]}),e[84]=D,e[85]=G,e[86]=H):H=e[86];let he;e[87]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Contraseña (Opcional)"}),e[87]=he):he=e[87];let O;e[88]!==r?(O=l=>r("password",l.target.value),e[88]=r,e[89]=O):O=e[89];let W;e[90]!==i.password||e[91]!==O?(W=s.jsx("input",{type:"password",value:i.password,onChange:O,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",placeholder:"••••••••"}),e[90]=i.password,e[91]=O,e[92]=W):W=e[92];let J;e[93]!==n.password?(J=n.password&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.password}),e[93]=n.password,e[94]=J):J=e[94];let L;e[95]!==W||e[96]!==J?(L=s.jsxs("div",{children:[he,W,J]}),e[95]=W,e[96]=J,e[97]=L):L=e[97];let be;e[98]===Symbol.for("react.memo_cache_sentinel")?(be=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Compañía"}),e[98]=be):be=e[98];let Q;e[99]!==r?(Q=l=>r("company",l),e[99]=r,e[100]=Q):Q=e[100];const we=se==="capitan";let ve;e[101]===Symbol.for("react.memo_cache_sentinel")?(ve=s.jsx(qe,{className:"w-full",children:s.jsx(Ee,{placeholder:"Seleccione una Compañía"})}),e[101]=ve):ve=e[101];let ge;e[102]===Symbol.for("react.memo_cache_sentinel")?(ge=s.jsx(Te,{children:Le.map(Ye)}),e[102]=ge):ge=e[102];let K;e[103]!==i.company||e[104]!==Q||e[105]!==we?(K=s.jsxs($e,{value:i.company,onValueChange:Q,disabled:we,children:[ve,ge]}),e[103]=i.company,e[104]=Q,e[105]=we,e[106]=K):K=e[106];let X;e[107]!==n.company?(X=n.company&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.company}),e[107]=n.company,e[108]=X):X=e[108];let Y;e[109]!==K||e[110]!==X?(Y=s.jsxs("div",{children:[be,K,X]}),e[109]=K,e[110]=X,e[111]=Y):Y=e[111];let Z;e[112]!==L||e[113]!==Y?(Z=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[L,Y]}),e[112]=L,e[113]=Y,e[114]=Z):Z=e[114],e[115]!==H||e[116]!==Z?(m=s.jsxs("div",{className:"space-y-4",children:[H,Z]}),e[115]=H,e[116]=Z,e[117]=m):m=e[117],w="rounded-lg border p-4",e[118]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(We,{className:"size-4"})," Roles y Permisos"]}),e[118]=x):x=e[118];let ye;e[119]===Symbol.for("react.memo_cache_sentinel")?(ye=s.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Rol del Sistema"}),e[119]=ye):ye=e[119];const Ae=i.role;let I;e[120]!==r?(I=l=>r("role",l),e[120]=r,e[121]=I):I=e[121];let je;e[122]===Symbol.for("react.memo_cache_sentinel")?(je=s.jsx(qe,{className:"w-full",children:s.jsx(Ee,{placeholder:"Seleccione un Rol"})}),e[122]=je):je=e[122];const _e=d.map(Xe);let ee;e[123]!==_e?(ee=s.jsx(Te,{children:_e}),e[123]=_e,e[124]=ee):ee=e[124],e[125]!==i.role||e[126]!==I||e[127]!==ee?(h=s.jsxs("div",{className:"mb-6",children:[ye,s.jsxs($e,{value:Ae,onValueChange:I,children:[je,ee]})]}),e[125]=i.role,e[126]=I,e[127]=ee,e[128]=h):h=e[128],_=i.role!=="admin"&&i.role!=="capitan"&&i.role!=="maquinista"&&s.jsxs("div",{children:[s.jsx("label",{className:"mb-3 block text-sm font-medium",children:"Permisos por Módulo"}),s.jsx("div",{className:"space-y-6",children:Je.map(l=>Ce.some(a=>a.category===l)&&s.jsxs("div",{className:"rounded-md border p-3",children:[s.jsx("h4",{className:"mb-2 text-sm font-semibold text-foreground",children:l}),s.jsx("table",{className:"w-full text-sm",children:s.jsx("tbody",{className:"divide-y",children:Ce.filter(a=>a.category===l).map(a=>s.jsxs("tr",{children:[s.jsx("td",{className:"w-1/3 py-2.5 font-medium",children:a.label}),s.jsx("td",{className:"py-2",children:s.jsxs("div",{className:"flex gap-1 rounded-md bg-muted/50 p-1",children:[s.jsx("button",{type:"button",onClick:()=>oe(a.id,"none"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${de(a.id)==="none"?"bg-background shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ninguno"}),s.jsx("button",{type:"button",onClick:()=>oe(a.id,"view"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${de(a.id)==="view"?"bg-blue-100 text-blue-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ver"}),s.jsx("button",{type:"button",onClick:()=>oe(a.id,"edit"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${de(a.id)==="edit"?"bg-green-100 text-green-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Editar"}),(a.id==="vehicles"||a.id==="equipment")&&s.jsx("button",{type:"button",onClick:()=>oe(a.id,"full"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${de(a.id)==="full"?"bg-purple-100 text-purple-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Total"})]})})]},a.id))})})]},l))}),s.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"'Editar' incluye permisos de 'Ver'."})]}),e[11]=se,e[12]=i.company,e[13]=i.driver_vehicles,e[14]=i.email,e[15]=i.name,e[16]=i.password,e[17]=i.permissions,e[18]=i.role,e[19]=n.company,e[20]=n.email,e[21]=n.name,e[22]=n.password,e[23]=ie,e[24]=r,e[25]=t.id,e[26]=t.name,e[27]=y,e[28]=j,e[29]=m,e[30]=N,e[31]=u,e[32]=M,e[33]=p,e[34]=f,e[35]=w,e[36]=x,e[37]=h,e[38]=_,e[39]=C,e[40]=k}else y=e[27],j=e[28],m=e[29],N=e[30],u=e[31],M=e[32],p=e[33],f=e[34],w=e[35],x=e[36],h=e[37],_=e[38],C=e[39],k=e[40];let S;e[129]!==w||e[130]!==x||e[131]!==h||e[132]!==_?(S=s.jsxs("div",{className:w,children:[x,h,_]}),e[129]=w,e[130]=x,e[131]=h,e[132]=_,e[133]=S):S=e[133];let $;e[134]!==b||e[135]!==i.driver_vehicles||e[136]!==j?($=b&&b.length>0&&s.jsxs("div",{className:"rounded-lg border p-4",children:[s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(He,{className:"size-4"})," Vehículos Permitidos (Maquinistas)"]}),s.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Seleccione los vehículos que este usuario está autorizado a conducir y registrar en bitácora."}),s.jsx(Ge,{className:"h-[200px] w-full rounded-md border p-4",children:s.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:b.map(d=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ze,{id:`v-${d.id}`,checked:i.driver_vehicles.includes(d.id),onCheckedChange:()=>j(d.id)}),s.jsxs("label",{htmlFor:`v-${d.id}`,className:"text-sm leading-none font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[d.name," ",s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",d.company,")"]})]})]},d.id))})})]}),e[134]=b,e[135]=i.driver_vehicles,e[136]=j,e[137]=$):$=e[137];let q;e[138]!==Ne?(q=s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{type:"submit",disabled:Ne,className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-8 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90 focus-visible:ring-2 focus-visible:ring-primary focus-visible:outline-none disabled:opacity-50",children:"Guardar Cambios"})}),e[138]=Ne,e[139]=q):q=e[139];let E;e[140]!==m||e[141]!==S||e[142]!==$||e[143]!==q||e[144]!==C||e[145]!==k?(E=s.jsxs("form",{onSubmit:C,className:k,children:[m,S,$,q]}),e[140]=m,e[141]=S,e[142]=$,e[143]=q,e[144]=C,e[145]=k,e[146]=E):E=e[146];let T;e[147]!==N||e[148]!==u||e[149]!==E?(T=s.jsxs("div",{className:N,children:[u,E]}),e[147]=N,e[148]=u,e[149]=E,e[150]=T):T=e[150];let P;e[151]!==M||e[152]!==T?(P=s.jsx("div",{className:M,children:T}),e[151]=M,e[152]=T,e[153]=P):P=e[153];let le;return e[154]!==y||e[155]!==p||e[156]!==f||e[157]!==P?(le=s.jsxs(y,{breadcrumbs:p,children:[f,P]}),e[154]=y,e[155]=p,e[156]=f,e[157]=P,e[158]=le):le=e[158],le}function Xe(o){return s.jsx(Re,{value:o.value,children:o.label},o.value)}function Ye(o){return s.jsx(Re,{value:o,children:o},o)}function Ze(o){return o.startsWith("equipment.")}function Ie(o){return o.id}export{xs as default};
