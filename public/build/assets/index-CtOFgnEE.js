import{r as f,j as t,c as B,u as ke,H as we,a as Te}from"./app-C5SdcKXl.js";import{B as Fe}from"./badge-DKh5jmkJ.js";import{u as ne,c as A,B as Ie,f as Re}from"./button-CwP00dYI.js";import{b as te,C as se,a as ae,d as Ee,c as re}from"./card-bTbsWzu3.js";import{I as N}from"./input-BYKfpKB7.js";import{L as x}from"./label-BsFamO0h.js";import{S as X,a as Q,b as Y,c as Z,d as _}from"./select-DtVgbGuq.js";import{c as oe,b as ce,a as q,e as Pe,P as Me}from"./index-BsSV_Sxb.js";import{u as Ae}from"./index-7uZoUYzZ.js";import{P as D}from"./index-BafQ3wo3.js";import{H as de,J as Be,I as De,u as Ve,d as $e,A as Le}from"./app-layout-CMBiDI-7.js";import{T as He}from"./textarea-CQ2iXEvM.js";import{u as Ke}from"./use-permissions-Ck0u4x1F.js";import{f as ze}from"./format-CSQe5d3I.js";/* empty css            */import"./chevron-down-BBAMSmLW.js";import"./check-JoAHZpu_.js";import"./index-C4J_hXM0.js";import"./shield-VExEkDwv.js";var U="Switch",[Ge,Tt]=oe(U),[Oe,qe]=Ge(U),ue=f.forwardRef((s,e)=>{const{__scopeSwitch:r,name:a,checked:i,defaultChecked:l,required:n,disabled:h,value:c="on",onCheckedChange:u,form:m,...p}=s,[o,g]=f.useState(null),j=ne(e,b=>g(b)),y=f.useRef(!1),$=o?m||!!o.closest("form"):!0,[v,C]=ce({prop:i,defaultProp:l??!1,onChange:u,caller:U});return t.jsxs(Oe,{scope:r,checked:v,disabled:h,children:[t.jsx(D.button,{type:"button",role:"switch","aria-checked":v,"aria-required":n,"data-state":fe(v),"data-disabled":h?"":void 0,disabled:h,value:c,...p,ref:j,onClick:q(s.onClick,b=>{C(V=>!V),$&&(y.current=b.isPropagationStopped(),y.current||b.stopPropagation())})}),$&&t.jsx(pe,{control:o,bubbles:!y.current,name:a,value:c,checked:v,required:n,disabled:h,form:m,style:{transform:"translateX(-100%)"}})]})});ue.displayName=U;var me="SwitchThumb",he=f.forwardRef((s,e)=>{const{__scopeSwitch:r,...a}=s,i=qe(me,r);return t.jsx(D.span,{"data-state":fe(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:e})});he.displayName=me;var Ue="SwitchBubbleInput",pe=f.forwardRef(({__scopeSwitch:s,control:e,checked:r,bubbles:a=!0,...i},l)=>{const n=f.useRef(null),h=ne(n,l),c=Ae(r),u=Pe(e);return f.useEffect(()=>{const m=n.current;if(!m)return;const p=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(p,"checked").set;if(c!==r&&g){const j=new Event("click",{bubbles:a});g.call(m,r),m.dispatchEvent(j)}},[c,r,a]),t.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...i,tabIndex:-1,ref:h,style:{...i.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});pe.displayName=Ue;function fe(s){return s?"checked":"unchecked"}var Je=ue,We=he;function Xe(s){const e=B.c(9);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let i;e[3]!==r?(i=A("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",r),e[3]=r,e[4]=i):i=e[4];let l;e[5]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx(We,{"data-slot":"switch-thumb",className:A("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")}),e[5]=l):l=e[5];let n;return e[6]!==a||e[7]!==i?(n=t.jsx(Je,{"data-slot":"switch",className:i,...a,children:l}),e[6]=a,e[7]=i,e[8]=n):n=e[8],n}var J="Tabs",[Qe,Ft]=oe(J,[de]),xe=de(),[Ye,ee]=Qe(J),ve=f.forwardRef((s,e)=>{const{__scopeTabs:r,value:a,onValueChange:i,defaultValue:l,orientation:n="horizontal",dir:h,activationMode:c="automatic",...u}=s,m=Ve(h),[p,o]=ce({prop:a,onChange:i,defaultProp:l??"",caller:J});return t.jsx(Ye,{scope:r,baseId:$e(),value:p,onValueChange:o,orientation:n,dir:m,activationMode:c,children:t.jsx(D.div,{dir:m,"data-orientation":n,...u,ref:e})})});ve.displayName=J;var be="TabsList",ge=f.forwardRef((s,e)=>{const{__scopeTabs:r,loop:a=!0,...i}=s,l=ee(be,r),n=xe(r);return t.jsx(De,{asChild:!0,...n,orientation:l.orientation,dir:l.dir,loop:a,children:t.jsx(D.div,{role:"tablist","aria-orientation":l.orientation,...i,ref:e})})});ge.displayName=be;var je="TabsTrigger",_e=f.forwardRef((s,e)=>{const{__scopeTabs:r,value:a,disabled:i=!1,...l}=s,n=ee(je,r),h=xe(r),c=Ce(n.baseId,a),u=Se(n.baseId,a),m=a===n.value;return t.jsx(Be,{asChild:!0,...h,focusable:!i,active:m,children:t.jsx(D.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":u,"data-state":m?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:c,...l,ref:e,onMouseDown:q(s.onMouseDown,p=>{!i&&p.button===0&&p.ctrlKey===!1?n.onValueChange(a):p.preventDefault()}),onKeyDown:q(s.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&n.onValueChange(a)}),onFocus:q(s.onFocus,()=>{const p=n.activationMode!=="manual";!m&&!i&&p&&n.onValueChange(a)})})})});_e.displayName=je;var ye="TabsContent",Ne=f.forwardRef((s,e)=>{const{__scopeTabs:r,value:a,forceMount:i,children:l,...n}=s,h=ee(ye,r),c=Ce(h.baseId,a),u=Se(h.baseId,a),m=a===h.value,p=f.useRef(m);return f.useEffect(()=>{const o=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(o)},[]),t.jsx(Me,{present:i||m,children:({present:o})=>t.jsx(D.div,{"data-state":m?"active":"inactive","data-orientation":h.orientation,role:"tabpanel","aria-labelledby":c,hidden:!o,id:u,tabIndex:0,...n,ref:e,style:{...s.style,animationDuration:p.current?"0s":void 0},children:o&&l})})});Ne.displayName=ye;function Ce(s,e){return`${s}-trigger-${e}`}function Se(s,e){return`${s}-content-${e}`}var Ze=ve,et=ge,tt=_e,st=Ne;function at(s){const e=B.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let i;e[3]!==r?(i=A("flex flex-col gap-2",r),e[3]=r,e[4]=i):i=e[4];let l;return e[5]!==a||e[6]!==i?(l=t.jsx(Ze,{"data-slot":"tabs",className:i,...a}),e[5]=a,e[6]=i,e[7]=l):l=e[7],l}function rt(s){const e=B.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let i;e[3]!==r?(i=A("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",r),e[3]=r,e[4]=i):i=e[4];let l;return e[5]!==a||e[6]!==i?(l=t.jsx(et,{"data-slot":"tabs-list",className:i,...a}),e[5]=a,e[6]=i,e[7]=l):l=e[7],l}function ie(s){const e=B.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let i;e[3]!==r?(i=A("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",r),e[3]=r,e[4]=i):i=e[4];let l;return e[5]!==a||e[6]!==i?(l=t.jsx(tt,{"data-slot":"tabs-trigger",className:i,...a}),e[5]=a,e[6]=i,e[7]=l):l=e[7],l}function le(s){const e=B.c(8);let r,a;e[0]!==s?({className:r,...a}=s,e[0]=s,e[1]=r,e[2]=a):(r=e[1],a=e[2]);let i;e[3]!==r?(i=A("flex-1 outline-none",r),e[3]=r,e[4]=i):i=e[4];let l;return e[5]!==a||e[6]!==i?(l=t.jsx(st,{"data-slot":"tabs-content",className:i,...a}),e[5]=a,e[6]=i,e[7]=l):l=e[7],l}function It(s){const e=B.c(47),{logs:r,vehicles:a,filters:i}=s,{canCreate:l}=Ke();let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=ze(new Date,"yyyy-MM-dd"),e[0]=n):n=e[0];let h;e[1]===Symbol.for("react.memo_cache_sentinel")?(h={vehicle_id:"",start_km:"",end_km:"",activity_type:"",destination:"",date:n,fuel_liters:"",fuel_coupon:"",has_fuel:!1,receipt:null,observations:""},e[1]=h):h=e[1];const{data:c,setData:u,post:m,processing:p,errors:o,reset:g}=ke(h);let j;e[2]!==m||e[3]!==g?(j=d=>{d.preventDefault(),m("/vehicles/logs",{onSuccess:()=>g()})},e[2]=m,e[3]=g,e[4]=j):j=e[4];const y=j,$=ot;let v,C;e[5]===Symbol.for("react.memo_cache_sentinel")?(v=[{title:"Material Mayor",href:"/vehicles/dashboard"},{title:"Bitácora",href:"/vehicles/logs"}],C=t.jsx(we,{title:"Bitácora de Máquinas"}),e[5]=v,e[6]=C):(v=e[5],C=e[6]);let b;e[7]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Bitácora del Material Mayor"}),t.jsx("p",{className:"text-muted-foreground",children:"Control de kilometraje y movimientos de las unidades."})]}),e[7]=b):b=e[7];const V=l("vehicles.logs")?"register":"history";let S;e[8]!==l?(S=l("vehicles.logs")&&t.jsx(ie,{value:"register",children:"Registrar Movimiento"}),e[8]=l,e[9]=S):S=e[9];let L;e[10]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx(ie,{value:"history",children:"Ver Bitácoras"}),e[10]=L):L=e[10];let k;e[11]!==S?(k=t.jsxs(rt,{className:"grid w-full grid-cols-2 md:w-[400px]",children:[S,L]}),e[11]=S,e[12]=k):k=e[12];let w;e[13]!==l||e[14]!==c||e[15]!==o||e[16]!==p||e[17]!==u||e[18]!==y||e[19]!==a?(w=l("vehicles.logs")&&t.jsx(le,{value:"register",children:t.jsxs(te,{children:[t.jsxs(se,{children:[t.jsx(ae,{children:"Nueva Entrada de Bitácora"}),t.jsx(Ee,{children:"Registre la salida o movimiento de una unidad."})]}),t.jsx(re,{children:t.jsxs("form",{onSubmit:y,className:"max-w-2xl space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(x,{htmlFor:"vehicle",children:"Vehículo"}),t.jsxs(X,{onValueChange:d=>u("vehicle_id",d),value:c.vehicle_id,children:[t.jsx(Q,{children:t.jsx(Y,{placeholder:"Seleccione unidad"})}),t.jsx(Z,{children:a.map(nt)})]}),o.vehicle_id&&t.jsx("p",{className:"text-sm text-destructive",children:o.vehicle_id})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(x,{htmlFor:"date",children:"Fecha"}),t.jsx(N,{type:"date",value:c.date,onChange:d=>u("date",d.target.value)}),o.date&&t.jsx("p",{className:"text-sm text-destructive",children:o.date})]})]}),t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(x,{htmlFor:"start_km",children:"Kilometraje Inicio"}),t.jsx(N,{type:"number",value:c.start_km,onChange:d=>u("start_km",d.target.value)}),o.start_km&&t.jsx("p",{className:"text-sm text-destructive",children:o.start_km})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(x,{htmlFor:"end_km",children:"Kilometraje Fin (Opcional)"}),t.jsx(N,{type:"number",value:c.end_km,onChange:d=>u("end_km",d.target.value)}),o.end_km&&t.jsx("p",{className:"text-sm text-destructive",children:o.end_km})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(x,{htmlFor:"activity",children:"Tipo de Actividad"}),t.jsxs(X,{onValueChange:d=>u("activity_type",d),value:c.activity_type,children:[t.jsx(Q,{children:t.jsx(Y,{placeholder:"Seleccione tipo"})}),t.jsxs(Z,{children:[t.jsx(_,{value:"Emergencia",children:"Emergencia (10-0)"}),t.jsx(_,{value:"Academia",children:"Academia / Ejercicio"}),t.jsx(_,{value:"Tramite",children:"Trámite Administrativo"}),t.jsx(_,{value:"Taller",children:"Traslado a Taller"}),t.jsx(_,{value:"CargaCombustible",children:"Carga de Combustible"})]})]}),o.activity_type&&t.jsx("p",{className:"text-sm text-destructive",children:o.activity_type})]}),t.jsx("div",{className:"space-y-4 rounded-lg border p-4",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Xe,{id:"fuel-mode",checked:c.has_fuel,onCheckedChange:d=>u("has_fuel",d)}),t.jsx(x,{htmlFor:"fuel-mode",children:"¿Fue a Cargar Combustible?"})]})}),c.has_fuel&&t.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[t.jsx("h3",{className:"font-semibold",children:"Detalle de Carga"}),t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(x,{htmlFor:"fuel_liters",children:"Litros Cargados"}),t.jsx(N,{type:"number",step:"0.01",value:c.fuel_liters,onChange:d=>u("fuel_liters",d.target.value),placeholder:"0.0"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(x,{htmlFor:"fuel_coupon",children:"Nº Cupón / Vale"}),t.jsx(N,{value:c.fuel_coupon,onChange:d=>u("fuel_coupon",d.target.value),placeholder:"Nº Documento"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(x,{htmlFor:"receipt",children:"Fotografía Boleta/Vale"}),t.jsx(N,{id:"receipt",type:"file",accept:"image/*",onChange:d=>u("receipt",d.target.files?d.target.files[0]:null)})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(x,{htmlFor:"destination",children:"Destino / Detalle"}),t.jsx(N,{value:c.destination,onChange:d=>u("destination",d.target.value),placeholder:"Dirección o lugar de destino"}),o.destination&&t.jsx("p",{className:"text-sm text-destructive",children:o.destination})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(x,{htmlFor:"observations",children:"Observaciones (Opcional)"}),t.jsx(He,{value:c.observations,onChange:d=>u("observations",d.target.value),placeholder:"Detalle cualquier novedad o incidencia..."}),o.observations&&t.jsx("p",{className:"text-sm text-destructive",children:o.observations})]}),t.jsx(Ie,{type:"submit",disabled:p,children:"Registrar Movimiento"})]})})]})}),e[13]=l,e[14]=c,e[15]=o,e[16]=p,e[17]=u,e[18]=y,e[19]=a,e[20]=w):w=e[20];let H;e[21]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsx(ae,{children:"Historial de Bitácoras"}),e[21]=H):H=e[21];const W=i?.vehicle_id||"all";let K;e[22]===Symbol.for("react.memo_cache_sentinel")?(K=t.jsx(Q,{children:t.jsx(Y,{placeholder:"Filtrar por Vehículo"})}),e[22]=K):K=e[22];let z;e[23]===Symbol.for("react.memo_cache_sentinel")?(z=t.jsx(_,{value:"all",children:"Todos los Vehículos"}),e[23]=z):z=e[23];let T;e[24]!==a?(T=a.map(lt),e[24]=a,e[25]=T):T=e[25];let F;e[26]!==T?(F=t.jsxs(Z,{children:[z,T]}),e[26]=T,e[27]=F):F=e[27];let I;e[28]!==W||e[29]!==F?(I=t.jsxs(se,{className:"flex flex-row items-center justify-between",children:[H,t.jsx("div",{className:"w-[250px]",children:t.jsxs(X,{value:W,onValueChange:$,children:[K,F]})})]}),e[28]=W,e[29]=F,e[30]=I):I=e[30];let G;e[31]===Symbol.for("react.memo_cache_sentinel")?(G=t.jsx("thead",{className:"bg-muted/50",children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"h-12 px-4 text-left font-medium",children:"Fecha"}),t.jsx("th",{className:"h-12 px-4 text-left font-medium",children:"Unidad"}),t.jsx("th",{className:"h-12 px-4 text-left font-medium",children:"Actividad"}),t.jsx("th",{className:"h-12 px-4 text-left font-medium",children:"Destino"}),t.jsx("th",{className:"h-12 px-4 text-left font-medium",children:"Km Salida"}),t.jsx("th",{className:"h-12 px-4 text-left font-medium",children:"Km Llegada"}),t.jsx("th",{className:"h-12 px-4 text-left font-medium",children:"Conductor"})]})}),e[31]=G):G=e[31];let R;e[32]!==r.data?(R=r.data.map(it),e[32]=r.data,e[33]=R):R=e[33];let E;e[34]!==r.data.length?(E=r.data.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"p-4 text-center text-muted-foreground",children:"No hay registros."})}),e[34]=r.data.length,e[35]=E):E=e[35];let P;e[36]!==R||e[37]!==E?(P=t.jsx(re,{children:t.jsx("div",{className:"rounded-md border",children:t.jsxs("table",{className:"w-full text-sm",children:[G,t.jsxs("tbody",{children:[R,E]})]})})}),e[36]=R,e[37]=E,e[38]=P):P=e[38];let M;e[39]!==I||e[40]!==P?(M=t.jsx(le,{value:"history",children:t.jsxs(te,{children:[I,P]})}),e[39]=I,e[40]=P,e[41]=M):M=e[41];let O;return e[42]!==k||e[43]!==w||e[44]!==M||e[45]!==V?(O=t.jsxs(Le,{breadcrumbs:v,children:[C,t.jsxs("div",{className:"flex h-full flex-col gap-6 p-4",children:[b,t.jsxs(at,{defaultValue:V,className:"w-full",children:[k,w,M]})]})]}),e[42]=k,e[43]=w,e[44]=M,e[45]=V,e[46]=O):O=e[46],O}function it(s){return t.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[t.jsx("td",{className:"p-4",children:Re(s.date)}),t.jsx("td",{className:"p-4 font-medium",children:s.vehicle.name}),t.jsx("td",{className:"p-4",children:t.jsx(Fe,{variant:"outline",children:s.activity_type})}),t.jsx("td",{className:"p-4",children:s.destination}),t.jsx("td",{className:"p-4",children:s.start_km}),t.jsx("td",{className:"p-4",children:s.end_km||"-"}),t.jsx("td",{className:"p-4",children:s.driver?.name})]},s.id)}function lt(s){return t.jsx(_,{value:s.id.toString(),children:s.name},s.id)}function nt(s){return t.jsx(_,{value:s.id.toString(),children:s.name},s.id)}function ot(s){Te.get("/vehicles/logs",{vehicle_id:s==="all"?void 0:s},{preserveState:!0,preserveScroll:!0,replace:!0})}export{It as default};
