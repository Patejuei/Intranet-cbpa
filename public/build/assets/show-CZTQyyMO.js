import{c as St,u as wt,r as rt,b as Ct,j as s,a as nt,H as Tt}from"./app-BtEgdfcF.js";import{B as ct}from"./badge-CxInlYhR.js";import{B as h,f as mt}from"./button-D6GqUU0O.js";import{C as ne,b as ce,c as oe,a as de}from"./card-iiWvKbLz.js";import{C as ht}from"./checkbox-CfLpi9lJ.js";import{b as Et,D as It,a as Rt,f as Ft,c as $t,d as Dt}from"./dialog-CQOq-TQv.js";import{I as se}from"./input-BpiJp2GB.js";import{L as o}from"./label-v4ysgXpO.js";import{c as xt,S as ft,a as ut,b as pt,d as _t}from"./select-CTaw7EQf.js";import{S as ot}from"./separator-DzsNuzNo.js";import{u as Lt}from"./use-permissions-D8npY9c2.js";import{F as Pt,A as zt,W as Ot}from"./app-layout-BATKKDM7.js";import{C as gt}from"./circle-check-DXUVRc-w.js";import{P as At}from"./plus-CXKzvKKs.js";import{T as jt}from"./trash-2-DfrAxWsR.js";import{P as qt}from"./printer-D8uj2fG8.js";import{S as Mt}from"./save-Dp2d_Qtp.js";import{C as Bt}from"./calendar-DLyI4YfB.js";/* empty css            */import"./index-CXC6SExh.js";import"./index-Yy3YddJX.js";import"./index-B6_6Q1_M.js";import"./check-B4GYtr9p.js";import"./chevron-down-NgSwcKF5.js";import"./index-q7GIQJN5.js";import"./shield-Cdrx9xNT.js";function kl(n){const e=St.c(251),{maintenance:t,inventoryItems:Es}=n,vt=t.status,Is=t.tentative_exit_date||"";let me;e[0]!==t.tasks?(me=t.tasks.map(Qt),e[0]=t.tasks,e[1]=me):me=e[1];const Rs=me;let he;e[2]===Symbol.for("react.memo_cache_sentinel")?(he=[],e[2]=he):he=e[2];const Fs=t.withdrawal_responsible_name||"",$s=t.withdrawal_responsible_rut||"";let xe;e[3]!==t.status||e[4]!==Is||e[5]!==Rs||e[6]!==Fs||e[7]!==$s?(xe={status:vt,tentative_exit_date:Is,tasks:Rs,resolved_issue_ids:he,withdrawal_responsible_name:Fs,withdrawal_responsible_rut:$s},e[3]=t.status,e[4]=Is,e[5]=Rs,e[6]=Fs,e[7]=$s,e[8]=xe):xe=e[8];const{data:a,setData:r,put:Ds,processing:x}=wt(xe),[Ls,fe]=rt.useState(!1);let ue;e[9]===Symbol.for("react.memo_cache_sentinel")?(ue={inventory_item_id:"",quantity:1},e[9]=ue):ue=e[9];const[m,Ps]=rt.useState(ue),[zs,Os]=rt.useState(!1);let pe;e[10]===Symbol.for("react.memo_cache_sentinel")?(pe=["En Taller","Ingresado","Trabajando","En Espera de Repuestos","Pruebas Finales","Finalizado","Entregado"],e[10]=pe):pe=e[10];const bt=pe;let je;e[11]!==t.id||e[12]!==Ds?(je=l=>{l.preventDefault(),Ds(`/vehicles/workshop/${t.id}`)},e[11]=t.id,e[12]=Ds,e[13]=je):je=e[13];const As=je;let _e;e[14]!==a.tasks||e[15]!==r?(_e=l=>{const c=[...a.tasks];c[l].is_completed=!c[l].is_completed,r("tasks",c)},e[14]=a.tasks,e[15]=r,e[16]=_e):_e=e[16];const te=_e;let ge;e[17]!==a.tasks||e[18]!==r?(ge=(l,c)=>{const d=[...a.tasks];d[l].cost=c?parseFloat(c):null,r("tasks",d)},e[17]=a.tasks,e[18]=r,e[19]=ge):ge=e[19];const le=ge;let ve;e[20]!==a.tasks||e[21]!==r?(ve=(l,c)=>{const d=[...a.tasks];d[l].description=c,r("tasks",d)},e[20]=a.tasks,e[21]=r,e[22]=ve):ve=e[22];const ae=ve;let be;e[23]!==a.tasks||e[24]!==r?(be=()=>{r("tasks",[...a.tasks,{description:"",is_completed:!1,cost:null}])},e[23]=a.tasks,e[24]=r,e[25]=be):be=e[25];const qs=be;let Ne;e[26]!==a.tasks||e[27]!==r?(Ne=l=>{const c=a.tasks.filter((d,re)=>re!==l);r("tasks",c)},e[26]=a.tasks,e[27]=r,e[28]=Ne):Ne=e[28];const ie=Ne;let ye;e[29]!==a.resolved_issue_ids||e[30]!==r?(ye=l=>{const c=a.resolved_issue_ids;c.includes(l)?r("resolved_issue_ids",c.filter(d=>d!==l)):r("resolved_issue_ids",[...c,l])},e[29]=a.resolved_issue_ids,e[30]=r,e[31]=ye):ye=e[31];const Ms=ye;let ke;e[32]!==m||e[33]!==t.id?(ke=l=>{l.preventDefault(),!(!m.inventory_item_id||m.quantity<1)&&(Os(!0),nt.post(`/vehicles/maintenance/${t.id}/items`,m,{onSuccess:()=>{Ps({inventory_item_id:"",quantity:1}),Os(!1)},onError:()=>Os(!1),preserveScroll:!0}))},e[32]=m,e[33]=t.id,e[34]=ke):ke=e[34];const Bs=ke;let Se;e[35]!==t.id?(Se=l=>{confirm("¿Eliminar este ítem de la orden?")&&nt.delete(`/vehicles/maintenance/${t.id}/items/${l}`,{preserveScroll:!0})},e[35]=t.id,e[36]=Se):Se=e[36];const Ws=Se,dt=a.tasks.reduce(Kt,0),Hs=t.items?.reduce(Jt,0)||0,Us=dt+Hs;let we;e[37]!==a.tasks?(we=a.tasks.filter(Gt),e[37]=a.tasks,e[38]=we):we=e[38];const Vs=we.length;Ct();const{canEdit:Gs}=Lt();let Ce;e[39]!==Gs?(Ce=Gs("vehicles.workshop"),e[39]=Gs,e[40]=Ce):Ce=e[40];const i=!Ce;let Te,Ee;e[41]===Symbol.for("react.memo_cache_sentinel")?(Te={title:"Panel Principal",href:"/dashboard"},Ee={title:"Taller Mecánico",href:"/vehicles/workshop"},e[41]=Te,e[42]=Ee):(Te=e[41],Ee=e[42]);const Js=`Orden #${t.id}`,Ks=`/vehicles/workshop/${t.id}`;let Ie;e[43]!==Js||e[44]!==Ks?(Ie=[Te,Ee,{title:Js,href:Ks}],e[43]=Js,e[44]=Ks,e[45]=Ie):Ie=e[45];const Qs=`Orden de Trabajo #${t.id}`;let Re;e[46]!==Qs?(Re=s.jsx(Tt,{title:Qs}),e[46]=Qs,e[47]=Re):Re=e[47];let Fe;e[48]===Symbol.for("react.memo_cache_sentinel")?(Fe=s.jsx(Ot,{className:"h-6 w-6"}),e[48]=Fe):Fe=e[48];let f;e[49]!==t.id?(f=s.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-bold",children:[Fe,"Orden de Trabajo #",t.id]}),e[49]=t.id,e[50]=f):f=e[50];let u;e[51]!==t.vehicle.company||e[52]!==t.vehicle.name||e[53]!==t.vehicle.plate?(u=s.jsxs("p",{className:"text-muted-foreground",children:[t.vehicle.name," -"," ",t.vehicle.plate," (",t.vehicle.company,")"]}),e[51]=t.vehicle.company,e[52]=t.vehicle.name,e[53]=t.vehicle.plate,e[54]=u):u=e[54];let p;e[55]!==f||e[56]!==u?(p=s.jsxs("div",{children:[f,u]}),e[55]=f,e[56]=u,e[57]=p):p=e[57];let j;e[58]!==t.id||e[59]!==t.status?(j=(t.status==="Finalizado"||t.status==="Entregado")&&s.jsx(h,{variant:"outline",asChild:!0,className:"border-green-600 text-green-600 hover:bg-green-50",children:s.jsxs("a",{href:`/vehicles/workshop/${t.id}/print-exit`,target:"_blank",rel:"noopener noreferrer",children:[s.jsx(Pt,{className:"mr-2 h-4 w-4"}),"Imprimir Salida"]})}),e[58]=t.id,e[59]=t.status,e[60]=j):j=e[60];const Xs=`/vehicles/workshop/${t.id}/print`;let $e,De,Le;e[61]===Symbol.for("react.memo_cache_sentinel")?($e=s.jsx(qt,{className:"mr-2 h-4 w-4"}),De=s.jsx("span",{className:"hidden sm:inline",children:"Imprimir Orden"}),Le=s.jsx("span",{className:"sm:hidden",children:"Imprimir"}),e[61]=$e,e[62]=De,e[63]=Le):($e=e[61],De=e[62],Le=e[63]);let _;e[64]!==Xs?(_=s.jsx(h,{variant:"outline",asChild:!0,children:s.jsxs("a",{href:Xs,target:"_blank",rel:"noopener noreferrer",children:[$e,De,Le]})}),e[64]=Xs,e[65]=_):_=e[65];let g;e[66]!==As||e[67]!==i||e[68]!==x?(g=!i&&s.jsxs(h,{onClick:As,disabled:x,children:[s.jsx(Mt,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Guardar Cambios"})]}),e[66]=As,e[67]=i,e[68]=x,e[69]=g):g=e[69];let v;e[70]!==a||e[71]!==i||e[72]!==t.id||e[73]!==t.status||e[74]!==x?(v=!i&&t.status!=="Finalizado"&&t.status!=="Entregado"&&s.jsxs(h,{variant:"destructive",onClick:()=>{confirm("¿Está seguro de finalizar el trabajo? Esto resolverá las incidencias marcadas y generará el documento de salida.")&&nt.put(`/vehicles/workshop/${t.id}`,{...a,status:"Finalizado"})},disabled:x,children:[s.jsx(gt,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Finalizar"})]}),e[70]=a,e[71]=i,e[72]=t.id,e[73]=t.status,e[74]=x,e[75]=v):v=e[75];let b;e[76]!==j||e[77]!==_||e[78]!==g||e[79]!==v?(b=s.jsxs("div",{className:"flex gap-2",children:[j,_,g,v]}),e[76]=j,e[77]=_,e[78]=g,e[79]=v,e[80]=b):b=e[80];let Pe;e[81]!==p||e[82]!==b?(Pe=s.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[p,b]}),e[81]=p,e[82]=b,e[83]=Pe):Pe=e[83];let ze;e[84]===Symbol.for("react.memo_cache_sentinel")?(ze=s.jsx(ne,{children:s.jsx(de,{children:"Estado y Fechas"})}),e[84]=ze):ze=e[84];let Oe;e[85]===Symbol.for("react.memo_cache_sentinel")?(Oe=s.jsx(o,{children:"Estado Actual"}),e[85]=Oe):Oe=e[85];let N;e[86]!==r?(N=l=>{l==="Entregado"&&fe(!0),r("status",l)},e[86]=r,e[87]=N):N=e[87];let Ae;e[88]===Symbol.for("react.memo_cache_sentinel")?(Ae=s.jsx(ut,{children:s.jsx(pt,{})}),e[88]=Ae):Ae=e[88];let qe;e[89]===Symbol.for("react.memo_cache_sentinel")?(qe=s.jsx(xt,{children:bt.map(Vt)}),e[89]=qe):qe=e[89];let y;e[90]!==a.status||e[91]!==i||e[92]!==N?(y=s.jsxs("div",{className:"space-y-2",children:[Oe,s.jsxs(ft,{value:a.status,onValueChange:N,disabled:i,children:[Ae,qe]})]}),e[90]=a.status,e[91]=i,e[92]=N,e[93]=y):y=e[93];let Me;e[94]===Symbol.for("react.memo_cache_sentinel")?(Me=s.jsx(o,{children:"Fecha de Ingreso"}),e[94]=Me):Me=e[94];let Be;e[95]===Symbol.for("react.memo_cache_sentinel")?(Be=s.jsx(Bt,{className:"h-4 w-4"}),e[95]=Be):Be=e[95];let k;e[96]!==t.entry_date?(k=mt(t.entry_date),e[96]=t.entry_date,e[97]=k):k=e[97];let S;e[98]!==k?(S=s.jsxs("div",{className:"space-y-2",children:[Me,s.jsxs("div",{className:"flex items-center gap-2 rounded border bg-muted/50 p-2 text-sm",children:[Be,k]})]}),e[98]=k,e[99]=S):S=e[99];let We;e[100]===Symbol.for("react.memo_cache_sentinel")?(We=s.jsx(o,{children:"Fecha Tentativa Salida"}),e[100]=We):We=e[100];let w;e[101]!==r?(w=l=>r("tentative_exit_date",l.target.value),e[101]=r,e[102]=w):w=e[102];let C;e[103]!==a.tentative_exit_date||e[104]!==i||e[105]!==w?(C=s.jsxs("div",{className:"space-y-2",children:[We,s.jsx(se,{type:"date",value:a.tentative_exit_date,onChange:w,disabled:i})]}),e[103]=a.tentative_exit_date,e[104]=i,e[105]=w,e[106]=C):C=e[106];let He;e[107]===Symbol.for("react.memo_cache_sentinel")?(He=s.jsx(ot,{}),e[107]=He):He=e[107];let Ue;e[108]===Symbol.for("react.memo_cache_sentinel")?(Ue=s.jsx(o,{children:"Taller / Proveedor"}),e[108]=Ue):Ue=e[108];let T;e[109]!==t.workshop_name?(T=s.jsxs("div",{className:"space-y-2",children:[Ue,s.jsx("p",{className:"font-medium",children:t.workshop_name})]}),e[109]=t.workshop_name,e[110]=T):T=e[110];let E;e[111]!==y||e[112]!==S||e[113]!==C||e[114]!==T?(E=s.jsxs(ce,{children:[ze,s.jsxs(oe,{className:"space-y-4",children:[y,S,C,He,T]})]}),e[111]=y,e[112]=S,e[113]=C,e[114]=T,e[115]=E):E=e[115];let Ve;e[116]===Symbol.for("react.memo_cache_sentinel")?(Ve=s.jsx(ne,{children:s.jsx(de,{className:"text-base",children:"Detalles del Ingreso"})}),e[116]=Ve):Ve=e[116];let Ge;e[117]===Symbol.for("react.memo_cache_sentinel")?(Ge=s.jsx(o,{className:"text-xs text-muted-foreground",children:"Responsable"}),e[117]=Ge):Ge=e[117];const Ys=t.responsible_person||"-";let I;e[118]!==Ys?(I=s.jsxs("div",{children:[Ge,s.jsx("p",{className:"font-medium",children:Ys})]}),e[118]=Ys,e[119]=I):I=e[119];let Je;e[120]===Symbol.for("react.memo_cache_sentinel")?(Je=s.jsx(o,{className:"text-xs text-muted-foreground",children:"Kilometraje"}),e[120]=Je):Je=e[120];const Zs=t.mileage_in?`${t.mileage_in} km`:"-";let R;e[121]!==Zs?(R=s.jsxs("div",{children:[Je,s.jsx("p",{className:"font-medium",children:Zs})]}),e[121]=Zs,e[122]=R):R=e[122];let Ke;e[123]===Symbol.for("react.memo_cache_sentinel")?(Ke=s.jsx(o,{className:"text-xs text-muted-foreground",children:"Tracción"}),e[123]=Ke):Ke=e[123];const et=t.traction||"-";let F;e[124]!==et?(F=s.jsxs("div",{children:[Ke,s.jsx("p",{className:"font-medium",children:et})]}),e[124]=et,e[125]=F):F=e[125];let Qe;e[126]===Symbol.for("react.memo_cache_sentinel")?(Qe=s.jsx(o,{className:"text-xs text-muted-foreground",children:"Transmisión"}),e[126]=Qe):Qe=e[126];const st=t.transmission||"-";let $;e[127]!==st?($=s.jsxs("div",{children:[Qe,s.jsx("p",{className:"font-medium",children:st})]}),e[127]=st,e[128]=$):$=e[128];let Xe;e[129]===Symbol.for("react.memo_cache_sentinel")?(Xe=s.jsx(o,{className:"text-xs text-muted-foreground",children:"Combustible"}),e[129]=Xe):Xe=e[129];const tt=t.fuel_type||"-";let D;e[130]!==tt?(D=s.jsxs("div",{className:"col-span-2",children:[Xe,s.jsx("p",{className:"font-medium",children:tt})]}),e[130]=tt,e[131]=D):D=e[131];let L;e[132]!==I||e[133]!==R||e[134]!==F||e[135]!==$||e[136]!==D?(L=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I,R,F,$,D]}),e[132]=I,e[133]=R,e[134]=F,e[135]=$,e[136]=D,e[137]=L):L=e[137];let P;e[138]!==t.entry_checklist?(P=t.entry_checklist&&s.jsxs("div",{className:"mt-4",children:[s.jsx(o,{className:"mb-2 block text-xs text-muted-foreground",children:"Checklist de Recepción (Fallas)"}),s.jsx("div",{className:"space-y-1 rounded border p-2",children:(()=>{const l=Object.entries(t.entry_checklist).filter(Ut);return l.length===0?s.jsx("p",{className:"text-xs text-muted-foreground",children:"No se reportaron fallas en el ingreso."}):l.map(Ht)})()})]}),e[138]=t.entry_checklist,e[139]=P):P=e[139];let z;e[140]!==L||e[141]!==P?(z=s.jsxs(ce,{children:[Ve,s.jsxs(oe,{className:"space-y-4 text-sm",children:[L,P]})]}),e[140]=L,e[141]=P,e[142]=z):z=e[142];let Ye;e[143]===Symbol.for("react.memo_cache_sentinel")?(Ye=s.jsx(ne,{children:s.jsx(de,{className:"text-base",children:"Incidencias Vinculadas"})}),e[143]=Ye):Ye=e[143];let O;e[144]!==a.resolved_issue_ids||e[145]!==i||e[146]!==t.issues||e[147]!==Ms?(O=t.issues.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay incidencias vinculadas."}):t.issues.map(l=>s.jsxs("div",{className:"flex items-start gap-2 rounded border p-2",children:[s.jsx(ht,{checked:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id),disabled:i||l.status==="Resolved",onCheckedChange:()=>Ms(l.id)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium",children:l.description}),s.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-muted-foreground",children:mt(l.date)}),s.jsx(ct,{variant:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id)?"default":"secondary",children:l.status==="Resolved"?"Resuelto":a.resolved_issue_ids.includes(l.id)?"Marcado para Resolver":"Pendiente"})]})]})]},l.id)),e[144]=a.resolved_issue_ids,e[145]=i,e[146]=t.issues,e[147]=Ms,e[148]=O):O=e[148];let A;e[149]!==O?(A=s.jsxs(ce,{children:[Ye,s.jsx(oe,{className:"space-y-3",children:O})]}),e[149]=O,e[150]=A):A=e[150];let Ze;e[151]!==E||e[152]!==z||e[153]!==A?(Ze=s.jsxs("div",{className:"space-y-6 lg:col-span-1",children:[E,z,A]}),e[151]=E,e[152]=z,e[153]=A,e[154]=Ze):Ze=e[154];let es;e[155]===Symbol.for("react.memo_cache_sentinel")?(es=s.jsx(de,{children:"Repuestos e Insumos Utilizados"}),e[155]=es):es=e[155];const lt=t.items?.length||0;let ss;e[156]!==lt?(ss=s.jsxs(ne,{className:"flex flex-row items-center justify-between",children:[es,s.jsxs(ct,{variant:"secondary",className:"text-base",children:[lt," Ítems"]})]}),e[156]=lt,e[157]=ss):ss=e[157];let ts;e[158]!==Bs||e[159]!==m||e[160]!==Es||e[161]!==zs||e[162]!==i||e[163]!==t.status?(ts=!i&&t.status!=="Finalizado"&&s.jsxs("div",{className:"flex items-end gap-2 rounded bg-muted/30 p-4",children:[s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx(o,{children:"Item de Bodega"}),s.jsxs(ft,{value:m.inventory_item_id.toString(),onValueChange:l=>Ps({...m,inventory_item_id:l}),children:[s.jsx(ut,{children:s.jsx(pt,{placeholder:"Seleccionar ítem..."})}),s.jsx(xt,{children:Es.map(Wt)})]})]}),s.jsxs("div",{className:"w-24 space-y-2",children:[s.jsx(o,{children:"Cantidad"}),s.jsx(se,{type:"number",min:"1",value:m.quantity,onChange:l=>Ps({...m,quantity:parseInt(l.target.value)||1})})]}),s.jsxs(h,{onClick:Bs,disabled:zs||!m.inventory_item_id,children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),"Agregar"]})]}),e[158]=Bs,e[159]=m,e[160]=Es,e[161]=zs,e[162]=i,e[163]=t.status,e[164]=ts):ts=e[164];let ls,as,is,rs;e[165]===Symbol.for("react.memo_cache_sentinel")?(ls=s.jsx("th",{className:"p-3 font-medium",children:"Ítem"}),as=s.jsx("th",{className:"p-3 text-right font-medium",children:"Cant."}),is=s.jsx("th",{className:"p-3 text-right font-medium",children:"Costo Unit."}),rs=s.jsx("th",{className:"p-3 text-right font-medium",children:"Total"}),e[165]=ls,e[166]=as,e[167]=is,e[168]=rs):(ls=e[165],as=e[166],is=e[167],rs=e[168]);let q;e[169]!==i?(q=!i&&s.jsx("th",{className:"w-[50px] p-3 text-right font-medium text-muted-foreground"}),e[169]=i,e[170]=q):q=e[170];let ns;e[171]!==q?(ns=s.jsx("thead",{children:s.jsxs("tr",{className:"border-b bg-muted/50 text-left",children:[ls,as,is,rs,q]})}),e[171]=q,e[172]=ns):ns=e[172];let M;e[173]!==Ws||e[174]!==i||e[175]!==t.items?(M=!t.items||t.items.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"p-4 text-center text-muted-foreground",children:"No se han utilizado repuestos."})}):t.items.map(l=>s.jsxs("tr",{className:"border-b last:border-0",children:[s.jsxs("td",{className:"p-3",children:[s.jsx("div",{className:"font-medium",children:l.name}),s.jsx("div",{className:"text-xs text-muted-foreground",children:l.sku})]}),s.jsx("td",{className:"p-3 text-right",children:l.pivot.quantity}),s.jsxs("td",{className:"p-3 text-right",children:["$",l.pivot.unit_cost.toLocaleString("es-CL")]}),s.jsxs("td",{className:"p-3 text-right font-medium",children:["$",l.pivot.total_cost.toLocaleString("es-CL")]}),!i&&s.jsx("td",{className:"p-3 text-right",children:s.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:bg-destructive/10",onClick:()=>Ws(l.id),children:s.jsx(jt,{className:"h-4 w-4"})})})]},l.id)),e[173]=Ws,e[174]=i,e[175]=t.items,e[176]=M):M=e[176];let cs;e[177]!==M?(cs=s.jsx("tbody",{children:M}),e[177]=M,e[178]=cs):cs=e[178];let os;e[179]===Symbol.for("react.memo_cache_sentinel")?(os=s.jsx("td",{colSpan:3,className:"p-3 text-right font-semibold",children:"Total Repuestos:"}),e[179]=os):os=e[179];let ds;e[180]!==i?(ds=!i&&s.jsx("td",{}),e[180]=i,e[181]=ds):ds=e[181];let ms;e[182]===Symbol.for("react.memo_cache_sentinel")?(ms=s.jsx(de,{children:"Lista de Trabajos (Mano de Obra)"}),e[182]=ms):ms=e[182];let hs;e[183]!==Vs||e[184]!==a.tasks.length?(hs=s.jsxs(ne,{className:"flex flex-row items-center justify-between",children:[ms,s.jsxs(ct,{variant:"outline",className:"text-base",children:["Progreso: ",Vs," /"," ",a.tasks.length]})]}),e[183]=Vs,e[184]=a.tasks.length,e[185]=hs):hs=e[185];let xs;e[186]===Symbol.for("react.memo_cache_sentinel")?(xs=s.jsx(o,{children:"Descripción General / Observaciones"}),e[186]=xs):xs=e[186];const at=t.description||"Sin observaciones generales.";let fs;e[187]!==at?(fs=s.jsxs("div",{className:"space-y-2",children:[xs,s.jsx("p",{className:"min-h-[60px] rounded border bg-muted p-3 text-sm text-muted-foreground",children:at})]}),e[187]=at,e[188]=fs):fs=e[188];let us;e[189]===Symbol.for("react.memo_cache_sentinel")?(us=s.jsx(ot,{}),e[189]=us):us=e[189];let ps;e[190]===Symbol.for("react.memo_cache_sentinel")?(ps=s.jsx(o,{className:"text-base font-semibold",children:"Tareas Específicas"}),e[190]=ps):ps=e[190];let B;e[191]!==qs||e[192]!==i?(B=!i&&s.jsx(h,{size:"sm",variant:"secondary",onClick:qs,type:"button",children:"+ Agregar Tarea"}),e[191]=qs,e[192]=i,e[193]=B):B=e[193];let W;e[194]!==B?(W=s.jsxs("div",{className:"flex items-center justify-between",children:[ps,B]}),e[194]=B,e[195]=W):W=e[195];let H;e[196]!==a.tasks.length?(H=a.tasks.length===0&&s.jsx("p",{className:"rounded border-2 border-dashed py-8 text-center text-muted-foreground",children:"No hay tareas registradas. Agrega una para comenzar el seguimiento."}),e[196]=a.tasks.length,e[197]=H):H=e[197];let U;if(e[198]!==a.tasks||e[199]!==i||e[200]!==ie||e[201]!==te||e[202]!==le||e[203]!==ae){let l;e[205]!==i||e[206]!==ie||e[207]!==te||e[208]!==le||e[209]!==ae?(l=(c,d)=>s.jsxs("div",{className:"flex flex-col items-start gap-3 rounded border bg-card p-3 transition-colors hover:bg-accent/5 md:flex-row md:items-center",children:[s.jsx(ht,{checked:c.is_completed,onCheckedChange:()=>te(d),disabled:i,className:"mt-1 md:mt-0"}),s.jsxs("div",{className:"w-full flex-1 space-y-2 md:flex md:gap-4 md:space-y-0",children:[s.jsx(se,{value:c.description,onChange:re=>ae(d,re.target.value),placeholder:"Descripción de la tarea",disabled:i,className:c.is_completed?"text-muted-foreground line-through":""}),s.jsxs("div",{className:"flex w-full items-center gap-2 md:w-32",children:[s.jsx("span",{className:"text-sm font-semibold text-muted-foreground",children:"$"}),s.jsx(se,{type:"number",value:c.cost??"",onChange:re=>le(d,re.target.value),placeholder:"Costo",disabled:i})]})]}),!i&&s.jsx(h,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>ie(d),type:"button",children:s.jsx(jt,{className:"h-4 w-4"})})]},d),e[205]=i,e[206]=ie,e[207]=te,e[208]=le,e[209]=ae,e[210]=l):l=e[210],U=a.tasks.map(l),e[198]=a.tasks,e[199]=i,e[200]=ie,e[201]=te,e[202]=le,e[203]=ae,e[204]=U}else U=e[204];let js;e[211]!==W||e[212]!==H||e[213]!==U?(js=s.jsxs("div",{className:"space-y-4",children:[W,H,U]}),e[211]=W,e[212]=H,e[213]=U,e[214]=js):js=e[214];let _s;e[215]===Symbol.for("react.memo_cache_sentinel")?(_s=s.jsx(ot,{}),e[215]=_s):_s=e[215];let gs;e[216]===Symbol.for("react.memo_cache_sentinel")?(gs=s.jsx("span",{className:"text-sm",children:"Total Mano de Obra:"}),e[216]=gs):gs=e[216];const Nt="flex items-center justify-end gap-4 text-muted-foreground";let V;e[217]===Symbol.for("react.memo_cache_sentinel")?(V=s.jsx("span",{className:"text-sm",children:"Total Repuestos:"}),e[217]=V):V=e[217];const yt="font-semibold",kt="$",it=Hs.toLocaleString("es-CL");let G;e[218]!==it?(G=s.jsxs("span",{className:yt,children:[kt,it]}),e[218]=it,e[219]=G):G=e[219];let vs;e[220]!==V||e[221]!==G?(vs=s.jsxs("div",{className:Nt,children:[V,G]}),e[220]=V,e[221]=G,e[222]=vs):vs=e[222];let bs;e[223]===Symbol.for("react.memo_cache_sentinel")?(bs=s.jsx("span",{className:"text-lg font-bold",children:"Costo Total Estimado:"}),e[223]=bs):bs=e[223];let J;e[224]!==Us?(J=Us.toLocaleString("es-CL"),e[224]=Us,e[225]=J):J=e[225];let Ns;e[226]!==J?(Ns=s.jsxs("div",{className:"flex items-center justify-end gap-4 border-t pt-2",children:[bs,s.jsxs("span",{className:"text-2xl font-bold text-primary",children:["$",J]})]}),e[226]=J,e[227]=Ns):Ns=e[227];let ys;e[228]===Symbol.for("react.memo_cache_sentinel")?(ys=s.jsxs(Et,{children:[s.jsx(It,{children:"Confirmar Entrega de Unidad"}),s.jsx(Rt,{children:"Para registrar la salida, por favor ingrese los datos de quien retira el vehículo."})]}),e[228]=ys):ys=e[228];let ks;e[229]===Symbol.for("react.memo_cache_sentinel")?(ks=s.jsx(o,{children:"Nombre Responsable Retiro"}),e[229]=ks):ks=e[229];let K;e[230]!==r?(K=l=>r("withdrawal_responsible_name",l.target.value),e[230]=r,e[231]=K):K=e[231];let Q;e[232]!==a.withdrawal_responsible_name||e[233]!==K?(Q=s.jsxs("div",{className:"space-y-2",children:[ks,s.jsx(se,{value:a.withdrawal_responsible_name,onChange:K,placeholder:"Ej: Tte. Juan Perez"})]}),e[232]=a.withdrawal_responsible_name,e[233]=K,e[234]=Q):Q=e[234];let Ss;e[235]===Symbol.for("react.memo_cache_sentinel")?(Ss=s.jsx(o,{children:"RUT Responsable"}),e[235]=Ss):Ss=e[235];let X;e[236]!==r?(X=l=>r("withdrawal_responsible_rut",l.target.value),e[236]=r,e[237]=X):X=e[237];let Y;e[238]!==a.withdrawal_responsible_rut||e[239]!==X?(Y=s.jsxs("div",{className:"space-y-2",children:[Ss,s.jsx(se,{value:a.withdrawal_responsible_rut,onChange:X,placeholder:"12.345.678-9"})]}),e[238]=a.withdrawal_responsible_rut,e[239]=X,e[240]=Y):Y=e[240];let Z;e[241]!==Q||e[242]!==Y?(Z=s.jsxs("div",{className:"space-y-4 py-4",children:[Q,Y]}),e[241]=Q,e[242]=Y,e[243]=Z):Z=e[243];let ws;e[244]===Symbol.for("react.memo_cache_sentinel")?(ws=s.jsx(h,{variant:"outline",onClick:()=>fe(!1),children:"Cancelar"}),e[244]=ws):ws=e[244];let Cs;e[245]===Symbol.for("react.memo_cache_sentinel")?(Cs=s.jsxs(Ft,{children:[ws,s.jsx(h,{onClick:()=>{fe(!1)},children:"Confirmar Datos"})]}),e[245]=Cs):Cs=e[245];let ee;e[246]!==Z?(ee=s.jsxs($t,{children:[ys,Z,Cs]}),e[246]=Z,e[247]=ee):ee=e[247];let Ts;return e[248]!==Ls||e[249]!==ee?(Ts=s.jsx(Dt,{open:Ls,onOpenChange:fe,children:ee}),e[248]=Ls,e[249]=ee,e[250]=Ts):Ts=e[250],s.jsxs(zt,{breadcrumbs:Ie,children:[Re,s.jsxs("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-6 p-4",children:[Pe,s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[Ze,s.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[s.jsxs(ce,{children:[ss,s.jsxs(oe,{className:"space-y-6",children:[ts,s.jsx("div",{className:"rounded-md border",children:s.jsxs("table",{className:"w-full text-sm",children:[ns,cs,s.jsx("tfoot",{className:"bg-muted/20",children:s.jsxs("tr",{children:[os,s.jsxs("td",{className:"p-3 text-right font-bold",children:["$",Hs.toLocaleString("es-CL")]}),ds]})})]})})]})]}),s.jsxs(ce,{children:[hs,s.jsxs(oe,{className:"space-y-4",children:[fs,us,js,_s,s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-end gap-4 text-muted-foreground",children:[gs,s.jsxs("span",{className:"font-semibold",children:["$",dt.toLocaleString("es-CL")]})]}),vs,Ns]})]})]})]})]}),Ts]})]})}function Wt(n){return s.jsxs(_t,{value:n.id.toString(),children:[n.name," ","(",n.sku,") - Stock:"," ",n.stock]},n.id)}function Ht(n){const[e]=n;return s.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-600",children:[s.jsx(gt,{className:"h-3 w-3"}),s.jsx("span",{children:e})]},e)}function Ut(n){const[,e]=n;return e==="Fallas"}function Vt(n){return s.jsx(_t,{value:n,children:n},n)}function Gt(n){return n.is_completed}function Jt(n,e){return n+(e.pivot.total_cost||0)}function Kt(n,e){return n+(e.cost||0)}function Qt(n){return{...n,cost:n.cost?Number(n.cost):null}}export{kl as default};
