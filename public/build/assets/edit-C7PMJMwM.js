import{c as Be,b as ze,u as Ge,j as s,H as He}from"./app-DTzGg31E.js";import{C as Oe}from"./checkbox-DzJRVB0_.js";import{S as We}from"./scroll-area-BJf6EcXG.js";import{S as qe,a as Ee,b as Ae,c as Pe,d as Me}from"./select-DDwLlzdA.js";import{T as Je,A as Le}from"./app-layout-DbAy9MxU.js";import{S as Qe}from"./shield-DFV9Q0l-.js";/* empty css            */import"./button-C4eVOrdx.js";import"./index-BqADuB3m.js";import"./index-C2aZpJh8.js";import"./index-hZcGNbU4.js";import"./check-Bk6zulOm.js";import"./index-q7GIQJN5.js";const Re=[{id:"inventory",label:"Inventario",category:"Material Menor"},{id:"tickets",label:"Ticketera",category:"Material Menor"},{id:"batteries",label:"Baterías",category:"Material Menor"},{id:"deliveries",label:"Actas de Entrega",category:"Material Menor"},{id:"reception",label:"Actas de Recepción",category:"Material Menor"},{id:"vehicles.status",label:"M. Mayor - Estado de Carros",category:"Material Mayor"},{id:"vehicles.incidents",label:"M. Mayor - Incidencias",category:"Material Mayor"},{id:"vehicles.checklist",label:"M. Mayor - Checklist",category:"Material Mayor"},{id:"vehicles.logs",label:"M. Mayor - Bitácora",category:"Material Mayor"},{id:"vehicles.workshop",label:"M. Mayor - Taller",category:"Material Mayor"},{id:"vehicles.inventory",label:"M. Mayor - Inventario",category:"Material Mayor"},{id:"firefighters",label:"Bomberos",category:"Administración"}],Ke=["Material Menor","Material Mayor","Administración"],Xe=["Primera Compañía","Segunda Compañía","Tercera Compañía","Cuarta Compañía","Quinta Compañía","Sexta Compañía","Séptima Compañía","Octava Compañía","Novena Compañía","Décima Compañía","Brigada Juvenil","Comandancia"],Ye=o=>{const e=[{value:"user",label:"Usuario Estándar"},{value:"admin",label:"Administrador del Sistema"},{value:"comandante",label:"Comandante"},{value:"capitan",label:"Capitán"},{value:"teniente",label:"Teniente"},{value:"maquinista",label:"Maquinista"},{value:"ayudante",label:"Ayudante"},{value:"ayudante",label:"Ayudante"},{value:"cuartelero",label:"Cuartelero"},{value:"mechanic",label:"Taller Mecánico"},{value:"inspector",label:"Inspector General"}];if(o==="capitan"){const l=["user","teniente","maquinista","ayudante"];return e.filter(v=>l.includes(v.value))}return e},Ze=o=>{if(o==="capitan"){const e=["vehicles.inventory","vehicles.workshop","firefighters","vehicles","equipment"];return Re.filter(l=>!e.includes(l.id))}return Re};function gs(o){const e=Be.c(167),{user:l,availableVehicles:v}=o,{props:Ue}=ze(),te=Ue.auth.user?.role||"user",we=l.department||"";let g;e[0]!==l.permissions?(g=l.permissions??[],e[0]=l.permissions,e[1]=g):g=e[1];let y;e[2]!==l.driver_vehicles?(y=l.driver_vehicles?.map(is)??[],e[2]=l.driver_vehicles,e[3]=y):y=e[3];let le;e[4]!==we||e[5]!==g||e[6]!==y||e[7]!==l.company||e[8]!==l.email||e[9]!==l.name||e[10]!==l.role?(le={name:l.name,email:l.email,password:"",company:l.company,role:l.role,department:we,permissions:g,driver_vehicles:y},e[4]=we,e[5]=g,e[6]=y,e[7]=l.company,e[8]=l.email,e[9]=l.name,e[10]=l.role,e[11]=le):le=e[11];const{data:t,setData:r,put:ie,processing:Ce,errors:n}=Ge(le);let j,N,M,w,d,C,u,k,p,f,S,h,x,b,_;if(e[12]!==te||e[13]!==t.company||e[14]!==t.department||e[15]!==t.driver_vehicles||e[16]!==t.email||e[17]!==t.name||e[18]!==t.password||e[19]!==t.permissions||e[20]!==t.role||e[21]!==n.company||e[22]!==n.email||e[23]!==n.name||e[24]!==n.password||e[25]!==ie||e[26]!==r||e[27]!==l.id||e[28]!==l.name){const m=Ye(te),Te=Ze(te);let re;e[44]!==t.driver_vehicles||e[45]!==r?(re=i=>{const a=t.driver_vehicles;a.includes(i)?r("driver_vehicles",a.filter(c=>c!==i)):r("driver_vehicles",[...a,i])},e[44]=t.driver_vehicles,e[45]=r,e[46]=re):re=e[46],N=re;let ne;e[47]!==ie||e[48]!==l.id?(ne=i=>{i.preventDefault(),ie(`/admin/users/${l.id}`)},e[47]=ie,e[48]=l.id,e[49]=ne):ne=e[49];const De=ne;let oe;e[50]!==t.permissions||e[51]!==r?(oe=(i,a)=>{const c=t.permissions.filter($e=>!$e.startsWith(`${i}.`));a==="view"?c.push(`${i}.view`):a==="edit"?c.push(`${i}.view`,`${i}.edit`):a==="full"&&c.push(`${i}.view`,`${i}.edit`,`${i}.full`),["inventory","deliveries","reception"].includes(i)&&a!=="none"&&(c.some(ts)||c.push("equipment.view")),["vehicles.status","vehicles.incidents","vehicles.checklist","vehicles.logs","vehicles.workshop","vehicles.inventory"].includes(i)&&a!=="none"&&(c.some(ss)||c.push("vehicles.view")),r("permissions",c)},e[50]=t.permissions,e[51]=r,e[52]=oe):oe=e[52];const ce=oe;let me;e[53]!==t.permissions?(me=i=>{const a=t.permissions.includes(`${i}.full`),c=t.permissions.includes(`${i}.edit`),Ve=t.permissions.includes(`${i}.view`);return a?"full":c?"edit":Ve?"view":"none"},e[53]=t.permissions,e[54]=me):me=e[54];const de=me;j=Le;let ue,pe;e[55]===Symbol.for("react.memo_cache_sentinel")?(ue={title:"Panel Principal",href:"/dashboard"},pe={title:"Usuarios",href:"/admin/users"},e[55]=ue,e[56]=pe):(ue=e[55],pe=e[56]);const ke=`/admin/users/${l.id}/edit`;e[57]!==ke?(p=[ue,pe,{title:"Editar Usuario",href:ke}],e[57]=ke,e[58]=p):p=e[58],e[59]===Symbol.for("react.memo_cache_sentinel")?(f=s.jsx(He,{title:"Editar Usuario"}),e[59]=f):f=e[59],k="flex flex-col gap-6 p-4",C="max-w-4xl rounded-xl border bg-card p-6 shadow-sm";let V;e[60]!==l.name?(V=s.jsxs("h2",{className:"text-lg font-semibold text-foreground",children:["Editar Usuario: ",l.name]}),e[60]=l.name,e[61]=V):V=e[61];let fe;e[62]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsx("p",{className:"text-sm text-muted-foreground",children:"Modifique los detalles del usuario."}),e[62]=fe):fe=e[62],e[63]!==V?(u=s.jsxs("div",{className:"mb-6",children:[V,fe]}),e[63]=V,e[64]=u):u=e[64],M=De,w="space-y-6";let he;e[65]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Nombre Completo"}),e[65]=he):he=e[65];let R;e[66]!==r?(R=i=>r("name",i.target.value),e[66]=r,e[67]=R):R=e[67];let U;e[68]!==t.name||e[69]!==R?(U=s.jsx("input",{type:"text",value:t.name,onChange:R,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[68]=t.name,e[69]=R,e[70]=U):U=e[70];let D;e[71]!==n.name?(D=n.name&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.name}),e[71]=n.name,e[72]=D):D=e[72];let F;e[73]!==U||e[74]!==D?(F=s.jsxs("div",{children:[he,U,D]}),e[73]=U,e[74]=D,e[75]=F):F=e[75];let xe;e[76]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Correo Electrónico"}),e[76]=xe):xe=e[76];let B;e[77]!==r?(B=i=>r("email",i.target.value),e[77]=r,e[78]=B):B=e[78];let z;e[79]!==t.email||e[80]!==B?(z=s.jsx("input",{type:"email",value:t.email,onChange:B,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[79]=t.email,e[80]=B,e[81]=z):z=e[81];let G;e[82]!==n.email?(G=n.email&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.email}),e[82]=n.email,e[83]=G):G=e[83];let H;e[84]!==z||e[85]!==G?(H=s.jsxs("div",{children:[xe,z,G]}),e[84]=z,e[85]=G,e[86]=H):H=e[86];let O;e[87]!==F||e[88]!==H?(O=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[F,H]}),e[87]=F,e[88]=H,e[89]=O):O=e[89];let be;e[90]===Symbol.for("react.memo_cache_sentinel")?(be=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Contraseña (Opcional)"}),e[90]=be):be=e[90];let W;e[91]!==r?(W=i=>r("password",i.target.value),e[91]=r,e[92]=W):W=e[92];let J;e[93]!==t.password||e[94]!==W?(J=s.jsx("input",{type:"password",value:t.password,onChange:W,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",placeholder:"••••••••"}),e[93]=t.password,e[94]=W,e[95]=J):J=e[95];let L;e[96]!==n.password?(L=n.password&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.password}),e[96]=n.password,e[97]=L):L=e[97];let Q;e[98]!==J||e[99]!==L?(Q=s.jsxs("div",{children:[be,J,L]}),e[98]=J,e[99]=L,e[100]=Q):Q=e[100];let ve;e[101]===Symbol.for("react.memo_cache_sentinel")?(ve=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Compañía"}),e[101]=ve):ve=e[101];let K;e[102]!==r?(K=i=>r("company",i),e[102]=r,e[103]=K):K=e[103];const Se=te==="capitan"||t.role==="comandante"||t.role==="inspector";let ge;e[104]===Symbol.for("react.memo_cache_sentinel")?(ge=s.jsx(Ee,{className:"w-full",children:s.jsx(Ae,{placeholder:"Seleccione una Compañía"})}),e[104]=ge):ge=e[104];let ye;e[105]===Symbol.for("react.memo_cache_sentinel")?(ye=s.jsx(Pe,{children:Xe.map(es)}),e[105]=ye):ye=e[105];let X;e[106]!==t.company||e[107]!==K||e[108]!==Se?(X=s.jsxs(qe,{value:t.company,onValueChange:K,disabled:Se,children:[ge,ye]}),e[106]=t.company,e[107]=K,e[108]=Se,e[109]=X):X=e[109];let Y;e[110]!==n.company?(Y=n.company&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.company}),e[110]=n.company,e[111]=Y):Y=e[111];let Z;e[112]!==X||e[113]!==Y?(Z=s.jsxs("div",{children:[ve,X,Y]}),e[112]=X,e[113]=Y,e[114]=Z):Z=e[114];let I;e[115]!==Q||e[116]!==Z?(I=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[Q,Z]}),e[115]=Q,e[116]=Z,e[117]=I):I=e[117],e[118]!==O||e[119]!==I?(d=s.jsxs("div",{className:"space-y-4",children:[O,I]}),e[118]=O,e[119]=I,e[120]=d):d=e[120],S="rounded-lg border p-4",e[121]===Symbol.for("react.memo_cache_sentinel")?(h=s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(Qe,{className:"size-4"})," Roles y Permisos"]}),e[121]=h):h=e[121];let je;e[122]===Symbol.for("react.memo_cache_sentinel")?(je=s.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Rol del Sistema"}),e[122]=je):je=e[122];const Fe=t.role;let ee;e[123]!==r?(ee=i=>{r(a=>({...a,role:i,permissions:i==="admin"||i==="comandante"||i==="capitan"||i==="maquinista"||i==="inspector"||i==="mechanic"?[]:a.permissions,company:i==="comandante"||i==="inspector"?"Comandancia":a.company}))},e[123]=r,e[124]=ee):ee=e[124];let Ne;e[125]===Symbol.for("react.memo_cache_sentinel")?(Ne=s.jsx(Ee,{className:"w-full",children:s.jsx(Ae,{placeholder:"Seleccione un Rol"})}),e[125]=Ne):Ne=e[125];const _e=m.map(Ie);let se;e[126]!==_e?(se=s.jsx(Pe,{children:_e}),e[126]=_e,e[127]=se):se=e[127],e[128]!==t.role||e[129]!==ee||e[130]!==se?(x=s.jsxs("div",{className:"mb-6",children:[je,s.jsxs(qe,{value:Fe,onValueChange:ee,children:[Ne,se]})]}),e[128]=t.role,e[129]=ee,e[130]=se,e[131]=x):x=e[131],e[132]!==t.department||e[133]!==t.role||e[134]!==r?(b=t.role==="inspector"&&s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Departamento"}),s.jsxs(qe,{value:t.department,onValueChange:i=>r("department",i),children:[s.jsx(Ee,{className:"w-full",children:s.jsx(Ae,{placeholder:"Seleccione Departamento"})}),s.jsxs(Pe,{children:[s.jsx(Me,{value:"Material Mayor",children:"Material Mayor"}),s.jsx(Me,{value:"Material Menor",children:"Material Menor"})]})]})]}),e[132]=t.department,e[133]=t.role,e[134]=r,e[135]=b):b=e[135],_=t.role!=="admin"&&t.role!=="comandante"&&t.role!=="capitan"&&t.role!=="maquinista"&&t.role!=="inspector"&&t.role!=="mechanic"&&s.jsxs("div",{children:[s.jsx("label",{className:"mb-3 block text-sm font-medium",children:"Permisos por Módulo"}),s.jsx("div",{className:"space-y-6",children:Ke.map(i=>Te.some(a=>a.category===i)&&s.jsxs("div",{className:"rounded-md border p-3",children:[s.jsx("h4",{className:"mb-2 text-sm font-semibold text-foreground",children:i}),s.jsx("table",{className:"w-full text-sm",children:s.jsx("tbody",{className:"divide-y",children:Te.filter(a=>a.category===i).map(a=>s.jsxs("tr",{children:[s.jsx("td",{className:"w-1/3 py-2.5 font-medium",children:a.label}),s.jsx("td",{className:"py-2",children:s.jsxs("div",{className:"flex gap-1 rounded-md bg-muted/50 p-1",children:[s.jsx("button",{type:"button",onClick:()=>ce(a.id,"none"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${de(a.id)==="none"?"bg-background shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ninguno"}),s.jsx("button",{type:"button",onClick:()=>ce(a.id,"view"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${de(a.id)==="view"?"bg-blue-100 text-blue-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ver"}),s.jsx("button",{type:"button",onClick:()=>ce(a.id,"edit"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${de(a.id)==="edit"?"bg-green-100 text-green-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Editar"}),(a.id==="vehicles"||a.id==="equipment")&&s.jsx("button",{type:"button",onClick:()=>ce(a.id,"full"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${de(a.id)==="full"?"bg-purple-100 text-purple-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Total"})]})})]},a.id))})})]},i))}),s.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"'Editar' incluye permisos de 'Ver'."})]}),e[12]=te,e[13]=t.company,e[14]=t.department,e[15]=t.driver_vehicles,e[16]=t.email,e[17]=t.name,e[18]=t.password,e[19]=t.permissions,e[20]=t.role,e[21]=n.company,e[22]=n.email,e[23]=n.name,e[24]=n.password,e[25]=ie,e[26]=r,e[27]=l.id,e[28]=l.name,e[29]=j,e[30]=N,e[31]=M,e[32]=w,e[33]=d,e[34]=C,e[35]=u,e[36]=k,e[37]=p,e[38]=f,e[39]=S,e[40]=h,e[41]=x,e[42]=b,e[43]=_}else j=e[29],N=e[30],M=e[31],w=e[32],d=e[33],C=e[34],u=e[35],k=e[36],p=e[37],f=e[38],S=e[39],h=e[40],x=e[41],b=e[42],_=e[43];let $;e[136]!==S||e[137]!==h||e[138]!==x||e[139]!==b||e[140]!==_?($=s.jsxs("div",{className:S,children:[h,x,b,_]}),e[136]=S,e[137]=h,e[138]=x,e[139]=b,e[140]=_,e[141]=$):$=e[141];let q;e[142]!==v||e[143]!==t.driver_vehicles||e[144]!==N?(q=v&&v.length>0&&s.jsxs("div",{className:"rounded-lg border p-4",children:[s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(Je,{className:"size-4"})," Vehículos Permitidos (Maquinistas)"]}),s.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Seleccione los vehículos que este usuario está autorizado a conducir y registrar en bitácora."}),s.jsx(We,{className:"h-[200px] w-full rounded-md border p-4",children:s.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:v.map(m=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Oe,{id:`v-${m.id}`,checked:t.driver_vehicles.includes(m.id),onCheckedChange:()=>N(m.id)}),s.jsxs("label",{htmlFor:`v-${m.id}`,className:"text-sm leading-none font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[m.name," ",s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",m.company,")"]})]})]},m.id))})})]}),e[142]=v,e[143]=t.driver_vehicles,e[144]=N,e[145]=q):q=e[145];let E;e[146]!==Ce?(E=s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{type:"submit",disabled:Ce,className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-8 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90 focus-visible:ring-2 focus-visible:ring-primary focus-visible:outline-none disabled:opacity-50",children:"Guardar Cambios"})}),e[146]=Ce,e[147]=E):E=e[147];let A;e[148]!==M||e[149]!==w||e[150]!==d||e[151]!==$||e[152]!==q||e[153]!==E?(A=s.jsxs("form",{onSubmit:M,className:w,children:[d,$,q,E]}),e[148]=M,e[149]=w,e[150]=d,e[151]=$,e[152]=q,e[153]=E,e[154]=A):A=e[154];let P;e[155]!==C||e[156]!==u||e[157]!==A?(P=s.jsxs("div",{className:C,children:[u,A]}),e[155]=C,e[156]=u,e[157]=A,e[158]=P):P=e[158];let T;e[159]!==k||e[160]!==P?(T=s.jsx("div",{className:k,children:P}),e[159]=k,e[160]=P,e[161]=T):T=e[161];let ae;return e[162]!==j||e[163]!==p||e[164]!==f||e[165]!==T?(ae=s.jsxs(j,{breadcrumbs:p,children:[f,T]}),e[162]=j,e[163]=p,e[164]=f,e[165]=T,e[166]=ae):ae=e[166],ae}function Ie(o){return s.jsx(Me,{value:o.value,children:o.label},o.value)}function es(o){return s.jsx(Me,{value:o,children:o},o)}function ss(o){return o==="vehicles.view"||o==="vehicles.edit"||o==="vehicles.full"}function ts(o){return o.startsWith("equipment.")}function is(o){return o.id}export{gs as default};
