import{c as yt,u as kt,r as tt,b as wt,j as s,a as lt,H as St}from"./app-B9QcLIWa.js";import{B as at}from"./badge-eAW9tGW7.js";import{B as h,f as nt}from"./button-B8ZIXrdG.js";import{C as de,c as me,b as he,a as fe}from"./card-DruzLovC.js";import{C as ct}from"./checkbox-fEQupfDS.js";import{b as Ct,D as Tt,a as It,f as Et,c as Rt,d as Ft}from"./dialog-DMDnH513.js";import{I as xe}from"./input-DZa38r-y.js";import{L as c}from"./label-CFOF9-tx.js";import{c as ot,S as dt,a as mt,b as ht,d as xt}from"./select-pHLO16Ch.js";import{S as it}from"./separator-EBSKXJri.js";import{u as Dt}from"./use-permissions-CRR2HMyS.js";import{F as Pt,A as $t,W as zt}from"./app-layout-2OmtfUSy.js";import{C as ut}from"./circle-check-C_cysHfn.js";import{P as Lt}from"./plus-0nI6YiYh.js";import{T as ft}from"./trash-2-DaF_xQAD.js";import{P as Ot}from"./printer-DJwNoKdL.js";import{S as At}from"./save-BT90yWEf.js";import{C as qt}from"./calendar-Bmgg9nhI.js";/* empty css            */import"./index-BkrslbVE.js";import"./index-_Vutp5UC.js";import"./index-CIQYj8wZ.js";import"./check-BnDcz_kp.js";import"./chevron-down-BzGzei-I.js";import"./index-q7GIQJN5.js";import"./shield-DgM9RD2J.js";function Nl(n){const e=yt.c(251),{maintenance:t,inventoryItems:ks}=n,pt=t.status,ws=t.tentative_exit_date||"";let ue;e[0]!==t.tasks?(ue=t.tasks.map(Jt),e[0]=t.tasks,e[1]=ue):ue=e[1];const Ss=ue;let pe;e[2]===Symbol.for("react.memo_cache_sentinel")?(pe=[],e[2]=pe):pe=e[2];const Cs=t.withdrawal_responsible_name||"",Ts=t.withdrawal_responsible_rut||"";let je;e[3]!==t.status||e[4]!==ws||e[5]!==Ss||e[6]!==Cs||e[7]!==Ts?(je={status:pt,tentative_exit_date:ws,tasks:Ss,resolved_issue_ids:pe,withdrawal_responsible_name:Cs,withdrawal_responsible_rut:Ts},e[3]=t.status,e[4]=ws,e[5]=Ss,e[6]=Cs,e[7]=Ts,e[8]=je):je=e[8];const{data:a,setData:r,put:Is,processing:f}=kt(je),[Es,_e]=tt.useState(!1);let ge;e[9]===Symbol.for("react.memo_cache_sentinel")?(ge={inventory_item_id:"",quantity:1},e[9]=ge):ge=e[9];const[d,Rs]=tt.useState(ge),[Fs,Ds]=tt.useState(!1);let ve;e[10]===Symbol.for("react.memo_cache_sentinel")?(ve=["En Taller","Ingresado","Trabajando","En Espera de Repuestos","Pruebas Finales","Finalizado","Entregado"],e[10]=ve):ve=e[10];const jt=ve;let be;e[11]!==t.id||e[12]!==Is?(be=l=>{l.preventDefault(),Is(`/vehicles/workshop/${t.id}`)},e[11]=t.id,e[12]=Is,e[13]=be):be=e[13];const Ps=be;let Ne;e[14]!==a.tasks||e[15]!==r?(Ne=l=>{const o=[...a.tasks];o[l].is_completed=!o[l].is_completed,r("tasks",o)},e[14]=a.tasks,e[15]=r,e[16]=Ne):Ne=e[16];const ne=Ne;let ye;e[17]!==a.tasks||e[18]!==r?(ye=(l,o)=>{const m=[...a.tasks];m[l].description=o,r("tasks",m)},e[17]=a.tasks,e[18]=r,e[19]=ye):ye=e[19];const ce=ye;let ke;e[20]!==a.tasks||e[21]!==r?(ke=()=>{r("tasks",[...a.tasks,{description:"",is_completed:!1,cost:null}])},e[20]=a.tasks,e[21]=r,e[22]=ke):ke=e[22];const $s=ke;let we;e[23]!==a.tasks||e[24]!==r?(we=l=>{const o=a.tasks.filter((m,st)=>st!==l);r("tasks",o)},e[23]=a.tasks,e[24]=r,e[25]=we):we=e[25];const oe=we;let Se;e[26]!==a.resolved_issue_ids||e[27]!==r?(Se=l=>{const o=a.resolved_issue_ids;o.includes(l)?r("resolved_issue_ids",o.filter(m=>m!==l)):r("resolved_issue_ids",[...o,l])},e[26]=a.resolved_issue_ids,e[27]=r,e[28]=Se):Se=e[28];const zs=Se;let Ce;e[29]!==d||e[30]!==t.id?(Ce=l=>{l.preventDefault(),!(!d.inventory_item_id||d.quantity<1)&&(Ds(!0),lt.post(`/vehicles/workshop/${t.id}/items`,d,{onSuccess:()=>{Rs({inventory_item_id:"",quantity:1}),Ds(!1)},onError:()=>Ds(!1),preserveScroll:!0}))},e[29]=d,e[30]=t.id,e[31]=Ce):Ce=e[31];const Ls=Ce;let Te;e[32]!==t.id?(Te=l=>{confirm("¿Eliminar este ítem de la orden?")&&lt.delete(`/vehicles/workshop/${t.id}/items/${l}`,{preserveScroll:!0})},e[32]=t.id,e[33]=Te):Te=e[33];const Os=Te,rt=t.items?.reduce(Gt,0)||0;let Ie;e[34]!==a.tasks?(Ie=a.tasks.filter(Vt),e[34]=a.tasks,e[35]=Ie):Ie=e[35];const As=Ie.length;wt();const{canEdit:qs}=Dt();let Ee;e[36]!==qs?(Ee=qs("vehicles.workshop"),e[36]=qs,e[37]=Ee):Ee=e[37];const i=!Ee;let Re,Fe;e[38]===Symbol.for("react.memo_cache_sentinel")?(Re={title:"Panel Principal",href:"/dashboard"},Fe={title:"Taller Mecánico",href:"/vehicles/workshop"},e[38]=Re,e[39]=Fe):(Re=e[38],Fe=e[39]);const Bs=`Orden #${t.id}`,Ws=`/vehicles/workshop/${t.id}`;let De;e[40]!==Bs||e[41]!==Ws?(De=[Re,Fe,{title:Bs,href:Ws}],e[40]=Bs,e[41]=Ws,e[42]=De):De=e[42];const Hs=`Orden de Trabajo #${t.id}`;let Pe;e[43]!==Hs?(Pe=s.jsx(St,{title:Hs}),e[43]=Hs,e[44]=Pe):Pe=e[44];let $e;e[45]===Symbol.for("react.memo_cache_sentinel")?($e=s.jsx(zt,{className:"h-6 w-6"}),e[45]=$e):$e=e[45];let x;e[46]!==t.id?(x=s.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-bold",children:[$e,"Orden de Trabajo #",t.id]}),e[46]=t.id,e[47]=x):x=e[47];let u;e[48]!==t.vehicle.company||e[49]!==t.vehicle.name||e[50]!==t.vehicle.plate?(u=s.jsxs("p",{className:"text-muted-foreground",children:[t.vehicle.name," -"," ",t.vehicle.plate," (",t.vehicle.company,")"]}),e[48]=t.vehicle.company,e[49]=t.vehicle.name,e[50]=t.vehicle.plate,e[51]=u):u=e[51];let p;e[52]!==x||e[53]!==u?(p=s.jsxs("div",{children:[x,u]}),e[52]=x,e[53]=u,e[54]=p):p=e[54];let j;e[55]!==t.id||e[56]!==t.status?(j=(t.status==="Finalizado"||t.status==="Entregado")&&s.jsx(h,{variant:"outline",asChild:!0,className:"border-green-600 text-green-600 hover:bg-green-50",children:s.jsxs("a",{href:`/vehicles/workshop/${t.id}/print-exit`,target:"_blank",rel:"noopener noreferrer",children:[s.jsx(Pt,{className:"mr-2 h-4 w-4"}),"Imprimir Salida"]})}),e[55]=t.id,e[56]=t.status,e[57]=j):j=e[57];const Ms=`/vehicles/workshop/${t.id}/print`;let ze,Le,Oe;e[58]===Symbol.for("react.memo_cache_sentinel")?(ze=s.jsx(Ot,{className:"mr-2 h-4 w-4"}),Le=s.jsx("span",{className:"hidden sm:inline",children:"Imprimir Orden"}),Oe=s.jsx("span",{className:"sm:hidden",children:"Imprimir"}),e[58]=ze,e[59]=Le,e[60]=Oe):(ze=e[58],Le=e[59],Oe=e[60]);let _;e[61]!==Ms?(_=s.jsx(h,{variant:"outline",asChild:!0,children:s.jsxs("a",{href:Ms,target:"_blank",rel:"noopener noreferrer",children:[ze,Le,Oe]})}),e[61]=Ms,e[62]=_):_=e[62];let g;e[63]!==Ps||e[64]!==i||e[65]!==f?(g=!i&&s.jsxs(h,{onClick:Ps,disabled:f,children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Guardar Cambios"})]}),e[63]=Ps,e[64]=i,e[65]=f,e[66]=g):g=e[66];let v;e[67]!==a||e[68]!==i||e[69]!==t.id||e[70]!==t.status||e[71]!==f?(v=!i&&t.status!=="Finalizado"&&t.status!=="Entregado"&&s.jsxs(h,{variant:"destructive",onClick:()=>{confirm("¿Está seguro de finalizar el trabajo? Esto resolverá las incidencias marcadas y generará el documento de salida.")&&lt.put(`/vehicles/workshop/${t.id}`,{...a,status:"Finalizado"})},disabled:f,children:[s.jsx(ut,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Finalizar"})]}),e[67]=a,e[68]=i,e[69]=t.id,e[70]=t.status,e[71]=f,e[72]=v):v=e[72];let b;e[73]!==j||e[74]!==_||e[75]!==g||e[76]!==v?(b=s.jsxs("div",{className:"flex gap-2",children:[j,_,g,v]}),e[73]=j,e[74]=_,e[75]=g,e[76]=v,e[77]=b):b=e[77];let Ae;e[78]!==p||e[79]!==b?(Ae=s.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[p,b]}),e[78]=p,e[79]=b,e[80]=Ae):Ae=e[80];let qe;e[81]===Symbol.for("react.memo_cache_sentinel")?(qe=s.jsx(de,{children:s.jsx(fe,{children:"Estado y Fechas"})}),e[81]=qe):qe=e[81];let Be;e[82]===Symbol.for("react.memo_cache_sentinel")?(Be=s.jsx(c,{children:"Estado Actual"}),e[82]=Be):Be=e[82];let N;e[83]!==r?(N=l=>{l==="Entregado"&&_e(!0),r("status",l)},e[83]=r,e[84]=N):N=e[84];let We;e[85]===Symbol.for("react.memo_cache_sentinel")?(We=s.jsx(mt,{children:s.jsx(ht,{})}),e[85]=We):We=e[85];let He;e[86]===Symbol.for("react.memo_cache_sentinel")?(He=s.jsx(ot,{children:jt.map(Ut)}),e[86]=He):He=e[86];let y;e[87]!==a.status||e[88]!==i||e[89]!==N?(y=s.jsxs("div",{className:"space-y-2",children:[Be,s.jsxs(dt,{value:a.status,onValueChange:N,disabled:i,children:[We,He]})]}),e[87]=a.status,e[88]=i,e[89]=N,e[90]=y):y=e[90];let Me;e[91]===Symbol.for("react.memo_cache_sentinel")?(Me=s.jsx(c,{children:"Fecha de Ingreso"}),e[91]=Me):Me=e[91];let Ue;e[92]===Symbol.for("react.memo_cache_sentinel")?(Ue=s.jsx(qt,{className:"h-4 w-4"}),e[92]=Ue):Ue=e[92];let k;e[93]!==t.entry_date?(k=nt(t.entry_date),e[93]=t.entry_date,e[94]=k):k=e[94];let w;e[95]!==k?(w=s.jsxs("div",{className:"space-y-2",children:[Me,s.jsxs("div",{className:"flex items-center gap-2 rounded border bg-muted/50 p-2 text-sm",children:[Ue,k]})]}),e[95]=k,e[96]=w):w=e[96];let Ve;e[97]===Symbol.for("react.memo_cache_sentinel")?(Ve=s.jsx(c,{children:"Fecha Tentativa Salida"}),e[97]=Ve):Ve=e[97];let S;e[98]!==r?(S=l=>r("tentative_exit_date",l.target.value),e[98]=r,e[99]=S):S=e[99];let C;e[100]!==a.tentative_exit_date||e[101]!==i||e[102]!==S?(C=s.jsxs("div",{className:"space-y-2",children:[Ve,s.jsx(xe,{type:"date",value:a.tentative_exit_date,onChange:S,onClick:Mt,disabled:i})]}),e[100]=a.tentative_exit_date,e[101]=i,e[102]=S,e[103]=C):C=e[103];let Ge;e[104]===Symbol.for("react.memo_cache_sentinel")?(Ge=s.jsx(it,{}),e[104]=Ge):Ge=e[104];let Je;e[105]===Symbol.for("react.memo_cache_sentinel")?(Je=s.jsx(c,{children:"Taller / Proveedor"}),e[105]=Je):Je=e[105];let T;e[106]!==t.workshop_name?(T=s.jsxs("div",{className:"space-y-2",children:[Je,s.jsx("p",{className:"font-medium",children:t.workshop_name})]}),e[106]=t.workshop_name,e[107]=T):T=e[107];let I;e[108]!==y||e[109]!==w||e[110]!==C||e[111]!==T?(I=s.jsxs(he,{children:[qe,s.jsxs(me,{className:"space-y-4",children:[y,w,C,Ge,T]})]}),e[108]=y,e[109]=w,e[110]=C,e[111]=T,e[112]=I):I=e[112];let Ke;e[113]===Symbol.for("react.memo_cache_sentinel")?(Ke=s.jsx(de,{children:s.jsx(fe,{className:"text-base",children:"Detalles del Ingreso"})}),e[113]=Ke):Ke=e[113];let Qe;e[114]===Symbol.for("react.memo_cache_sentinel")?(Qe=s.jsx(c,{className:"text-xs text-muted-foreground",children:"Responsable"}),e[114]=Qe):Qe=e[114];const Us=t.responsible_person||"-";let E;e[115]!==Us?(E=s.jsxs("div",{children:[Qe,s.jsx("p",{className:"font-medium",children:Us})]}),e[115]=Us,e[116]=E):E=e[116];let Xe;e[117]===Symbol.for("react.memo_cache_sentinel")?(Xe=s.jsx(c,{className:"text-xs text-muted-foreground",children:"Kilometraje"}),e[117]=Xe):Xe=e[117];const Vs=t.mileage_in?`${t.mileage_in} km`:"-";let R;e[118]!==Vs?(R=s.jsxs("div",{children:[Xe,s.jsx("p",{className:"font-medium",children:Vs})]}),e[118]=Vs,e[119]=R):R=e[119];let Ye;e[120]===Symbol.for("react.memo_cache_sentinel")?(Ye=s.jsx(c,{className:"text-xs text-muted-foreground",children:"Tracción"}),e[120]=Ye):Ye=e[120];const Gs=t.traction||"-";let F;e[121]!==Gs?(F=s.jsxs("div",{children:[Ye,s.jsx("p",{className:"font-medium",children:Gs})]}),e[121]=Gs,e[122]=F):F=e[122];let Ze;e[123]===Symbol.for("react.memo_cache_sentinel")?(Ze=s.jsx(c,{className:"text-xs text-muted-foreground",children:"Transmisión"}),e[123]=Ze):Ze=e[123];const Js=t.transmission||"-";let D;e[124]!==Js?(D=s.jsxs("div",{children:[Ze,s.jsx("p",{className:"font-medium",children:Js})]}),e[124]=Js,e[125]=D):D=e[125];let es;e[126]===Symbol.for("react.memo_cache_sentinel")?(es=s.jsx(c,{className:"text-xs text-muted-foreground",children:"Combustible"}),e[126]=es):es=e[126];const Ks=t.fuel_type||"-";let P;e[127]!==Ks?(P=s.jsxs("div",{className:"col-span-2",children:[es,s.jsx("p",{className:"font-medium",children:Ks})]}),e[127]=Ks,e[128]=P):P=e[128];let $;e[129]!==E||e[130]!==R||e[131]!==F||e[132]!==D||e[133]!==P?($=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E,R,F,D,P]}),e[129]=E,e[130]=R,e[131]=F,e[132]=D,e[133]=P,e[134]=$):$=e[134];let z;e[135]!==t.entry_checklist?(z=t.entry_checklist&&s.jsxs("div",{className:"mt-4",children:[s.jsx(c,{className:"mb-2 block text-xs text-muted-foreground",children:"Checklist de Recepción (Fallas)"}),s.jsx("div",{className:"space-y-1 rounded border p-2",children:(()=>{const l=Object.entries(t.entry_checklist).filter(Ht);return l.length===0?s.jsx("p",{className:"text-xs text-muted-foreground",children:"No se reportaron fallas en el ingreso."}):l.map(Wt)})()})]}),e[135]=t.entry_checklist,e[136]=z):z=e[136];let L;e[137]!==$||e[138]!==z?(L=s.jsxs(he,{children:[Ke,s.jsxs(me,{className:"space-y-4 text-sm",children:[$,z]})]}),e[137]=$,e[138]=z,e[139]=L):L=e[139];let ss;e[140]===Symbol.for("react.memo_cache_sentinel")?(ss=s.jsx(de,{children:s.jsx(fe,{className:"text-base",children:"Incidencias Vinculadas"})}),e[140]=ss):ss=e[140];let O;e[141]!==a.resolved_issue_ids||e[142]!==i||e[143]!==t.issues||e[144]!==zs?(O=t.issues.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay incidencias vinculadas."}):t.issues.map(l=>s.jsxs("div",{className:"flex items-start gap-2 rounded border p-2",children:[s.jsx(ct,{checked:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id),disabled:i||l.status==="Resolved",onCheckedChange:()=>zs(l.id)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium",children:l.description}),s.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-muted-foreground",children:nt(l.date)}),s.jsx(at,{variant:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id)?"default":"secondary",children:l.status==="Resolved"?"Resuelto":a.resolved_issue_ids.includes(l.id)?"Marcado para Resolver":"Pendiente"})]})]})]},l.id)),e[141]=a.resolved_issue_ids,e[142]=i,e[143]=t.issues,e[144]=zs,e[145]=O):O=e[145];let A;e[146]!==O?(A=s.jsxs(he,{children:[ss,s.jsx(me,{className:"space-y-3",children:O})]}),e[146]=O,e[147]=A):A=e[147];let ts;e[148]!==I||e[149]!==L||e[150]!==A?(ts=s.jsxs("div",{className:"space-y-6 lg:col-span-1",children:[I,L,A]}),e[148]=I,e[149]=L,e[150]=A,e[151]=ts):ts=e[151];let ls;e[152]===Symbol.for("react.memo_cache_sentinel")?(ls=s.jsx(fe,{children:"Repuestos e Insumos Utilizados"}),e[152]=ls):ls=e[152];const Qs=t.items?.length||0;let as;e[153]!==Qs?(as=s.jsxs(de,{className:"flex flex-row items-center justify-between",children:[ls,s.jsxs(at,{variant:"secondary",className:"text-base",children:[Qs," Ítems"]})]}),e[153]=Qs,e[154]=as):as=e[154];let is;e[155]!==Ls||e[156]!==d||e[157]!==ks||e[158]!==Fs||e[159]!==i||e[160]!==t.status?(is=!i&&t.status!=="Finalizado"&&s.jsxs("div",{className:"flex items-end gap-2 rounded bg-muted/30 p-4",children:[s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx(c,{children:"Item de Bodega"}),s.jsxs(dt,{value:d.inventory_item_id.toString(),onValueChange:l=>Rs({...d,inventory_item_id:l}),children:[s.jsx(mt,{children:s.jsx(ht,{placeholder:"Seleccionar ítem..."})}),s.jsx(ot,{children:ks.map(Bt)})]})]}),s.jsxs("div",{className:"w-24 space-y-2",children:[s.jsx(c,{children:"Cantidad"}),s.jsx(xe,{type:"number",min:"1",value:d.quantity,onChange:l=>Rs({...d,quantity:parseInt(l.target.value)||1})})]}),s.jsxs(h,{onClick:Ls,disabled:Fs||!d.inventory_item_id,children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),"Agregar"]})]}),e[155]=Ls,e[156]=d,e[157]=ks,e[158]=Fs,e[159]=i,e[160]=t.status,e[161]=is):is=e[161];let rs,ns,cs,os;e[162]===Symbol.for("react.memo_cache_sentinel")?(rs=s.jsx("th",{className:"p-3 font-medium",children:"Ítem"}),ns=s.jsx("th",{className:"p-3 text-right font-medium",children:"Cant."}),cs=s.jsx("th",{className:"p-3 text-right font-medium",children:"Costo Unit."}),os=s.jsx("th",{className:"p-3 text-right font-medium",children:"Total"}),e[162]=rs,e[163]=ns,e[164]=cs,e[165]=os):(rs=e[162],ns=e[163],cs=e[164],os=e[165]);let q;e[166]!==i?(q=!i&&s.jsx("th",{className:"w-[50px] p-3 text-right font-medium text-muted-foreground"}),e[166]=i,e[167]=q):q=e[167];let ds;e[168]!==q?(ds=s.jsx("thead",{children:s.jsxs("tr",{className:"border-b bg-muted/50 text-left",children:[rs,ns,cs,os,q]})}),e[168]=q,e[169]=ds):ds=e[169];let B;e[170]!==Os||e[171]!==i||e[172]!==t.items?(B=!t.items||t.items.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"p-4 text-center text-muted-foreground",children:"No se han utilizado repuestos."})}):t.items.map(l=>s.jsxs("tr",{className:"border-b last:border-0",children:[s.jsxs("td",{className:"p-3",children:[s.jsx("div",{className:"font-medium",children:l.name}),s.jsx("div",{className:"text-xs text-muted-foreground",children:l.sku})]}),s.jsx("td",{className:"p-3 text-right",children:l.pivot.quantity}),s.jsxs("td",{className:"p-3 text-right",children:["$",l.pivot.unit_cost.toLocaleString("es-CL")]}),s.jsxs("td",{className:"p-3 text-right font-medium",children:["$",l.pivot.total_cost.toLocaleString("es-CL")]}),!i&&s.jsx("td",{className:"p-3 text-right",children:s.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:bg-destructive/10",onClick:()=>Os(l.id),children:s.jsx(ft,{className:"h-4 w-4"})})})]},l.id)),e[170]=Os,e[171]=i,e[172]=t.items,e[173]=B):B=e[173];let ms;e[174]!==B?(ms=s.jsx("tbody",{children:B}),e[174]=B,e[175]=ms):ms=e[175];let hs;e[176]===Symbol.for("react.memo_cache_sentinel")?(hs=s.jsx("td",{colSpan:3,className:"p-3 text-right font-semibold",children:"Total Repuestos:"}),e[176]=hs):hs=e[176];let fs;e[177]!==i?(fs=!i&&s.jsx("td",{}),e[177]=i,e[178]=fs):fs=e[178];const Xs=he;let xs;e[179]===Symbol.for("react.memo_cache_sentinel")?(xs=s.jsx(fe,{children:"Lista de Trabajos"}),e[179]=xs):xs=e[179];let W;e[180]!==As||e[181]!==a.tasks.length?(W=s.jsxs(de,{className:"flex flex-row items-center justify-between",children:[xs,s.jsxs(at,{variant:"outline",className:"text-base",children:["Progreso: ",As," /"," ",a.tasks.length]})]}),e[180]=As,e[181]=a.tasks.length,e[182]=W):W=e[182];const Ys=me,_t="space-y-4";let us;e[183]===Symbol.for("react.memo_cache_sentinel")?(us=s.jsx(c,{children:"Descripción General / Observaciones"}),e[183]=us):us=e[183];const Zs=t.description||"Sin observaciones generales.";let H;e[184]!==Zs?(H=s.jsxs("div",{className:"space-y-2",children:[us,s.jsx("p",{className:"min-h-[60px] rounded border bg-muted p-3 text-sm text-muted-foreground",children:Zs})]}),e[184]=Zs,e[185]=H):H=e[185];let M;e[186]===Symbol.for("react.memo_cache_sentinel")?(M=s.jsx(it,{}),e[186]=M):M=e[186];let ps;e[187]===Symbol.for("react.memo_cache_sentinel")?(ps=s.jsx(c,{className:"text-base font-semibold",children:"Tareas Específicas"}),e[187]=ps):ps=e[187];let U;e[188]!==$s||e[189]!==i?(U=!i&&s.jsx(h,{size:"sm",variant:"secondary",onClick:$s,type:"button",children:"+ Agregar Tarea"}),e[188]=$s,e[189]=i,e[190]=U):U=e[190];let V;e[191]!==U?(V=s.jsxs("div",{className:"flex items-center justify-between",children:[ps,U]}),e[191]=U,e[192]=V):V=e[192];let G;e[193]!==a.tasks.length?(G=a.tasks.length===0&&s.jsx("p",{className:"rounded border-2 border-dashed py-8 text-center text-muted-foreground",children:"No hay tareas registradas. Agrega una para comenzar el seguimiento."}),e[193]=a.tasks.length,e[194]=G):G=e[194];let J;if(e[195]!==a.tasks||e[196]!==i||e[197]!==oe||e[198]!==ne||e[199]!==ce){let l;e[201]!==i||e[202]!==oe||e[203]!==ne||e[204]!==ce?(l=(o,m)=>s.jsxs("div",{className:"flex flex-col items-start gap-3 rounded border bg-card p-3 transition-colors hover:bg-accent/5 md:flex-row md:items-center",children:[s.jsx(ct,{checked:o.is_completed,onCheckedChange:()=>ne(m),disabled:i,className:"mt-1 md:mt-0"}),s.jsx("div",{className:"w-full flex-1 space-y-2 md:flex md:gap-4 md:space-y-0",children:s.jsx(xe,{value:o.description,onChange:st=>ce(m,st.target.value),placeholder:"Descripción de la tarea",disabled:i,className:o.is_completed?"text-muted-foreground line-through":""})}),!i&&s.jsx(h,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>oe(m),type:"button",children:s.jsx(ft,{className:"h-4 w-4"})})]},m),e[201]=i,e[202]=oe,e[203]=ne,e[204]=ce,e[205]=l):l=e[205],J=a.tasks.map(l),e[195]=a.tasks,e[196]=i,e[197]=oe,e[198]=ne,e[199]=ce,e[200]=J}else J=e[200];let K;e[206]!==V||e[207]!==G||e[208]!==J?(K=s.jsxs("div",{className:"space-y-4",children:[V,G,J]}),e[206]=V,e[207]=G,e[208]=J,e[209]=K):K=e[209];let Q;e[210]===Symbol.for("react.memo_cache_sentinel")?(Q=s.jsx(it,{}),e[210]=Q):Q=e[210];const gt="space-y-2",vt="flex items-center justify-end gap-4 text-muted-foreground";let X;e[211]===Symbol.for("react.memo_cache_sentinel")?(X=s.jsx("span",{className:"text-sm",children:"Total Repuestos:"}),e[211]=X):X=e[211];const bt="font-semibold",Nt="$",et=rt.toLocaleString("es-CL");let Y;e[212]!==et?(Y=s.jsxs("span",{className:bt,children:[Nt,et]}),e[212]=et,e[213]=Y):Y=e[213];let Z;e[214]!==X||e[215]!==Y?(Z=s.jsx("div",{className:gt,children:s.jsxs("div",{className:vt,children:[X,Y]})}),e[214]=X,e[215]=Y,e[216]=Z):Z=e[216];let ee;e[217]!==Ys||e[218]!==H||e[219]!==M||e[220]!==K||e[221]!==Q||e[222]!==Z?(ee=s.jsxs(Ys,{className:_t,children:[H,M,K,Q,Z]}),e[217]=Ys,e[218]=H,e[219]=M,e[220]=K,e[221]=Q,e[222]=Z,e[223]=ee):ee=e[223];let js;e[224]!==Xs||e[225]!==ee||e[226]!==W?(js=s.jsxs(Xs,{children:[W,ee]}),e[224]=Xs,e[225]=ee,e[226]=W,e[227]=js):js=e[227];let _s;e[228]===Symbol.for("react.memo_cache_sentinel")?(_s=s.jsxs(Ct,{children:[s.jsx(Tt,{children:"Confirmar Entrega de Unidad"}),s.jsx(It,{children:"Para registrar la salida, por favor ingrese los datos de quien retira el vehículo."})]}),e[228]=_s):_s=e[228];let gs;e[229]===Symbol.for("react.memo_cache_sentinel")?(gs=s.jsx(c,{children:"Nombre Responsable Retiro"}),e[229]=gs):gs=e[229];let se;e[230]!==r?(se=l=>r("withdrawal_responsible_name",l.target.value),e[230]=r,e[231]=se):se=e[231];let te;e[232]!==a.withdrawal_responsible_name||e[233]!==se?(te=s.jsxs("div",{className:"space-y-2",children:[gs,s.jsx(xe,{value:a.withdrawal_responsible_name,onChange:se,placeholder:"Ej: Tte. Juan Perez"})]}),e[232]=a.withdrawal_responsible_name,e[233]=se,e[234]=te):te=e[234];let vs;e[235]===Symbol.for("react.memo_cache_sentinel")?(vs=s.jsx(c,{children:"RUT Responsable"}),e[235]=vs):vs=e[235];let le;e[236]!==r?(le=l=>r("withdrawal_responsible_rut",l.target.value),e[236]=r,e[237]=le):le=e[237];let ae;e[238]!==a.withdrawal_responsible_rut||e[239]!==le?(ae=s.jsxs("div",{className:"space-y-2",children:[vs,s.jsx(xe,{value:a.withdrawal_responsible_rut,onChange:le,placeholder:"12.345.678-9"})]}),e[238]=a.withdrawal_responsible_rut,e[239]=le,e[240]=ae):ae=e[240];let ie;e[241]!==te||e[242]!==ae?(ie=s.jsxs("div",{className:"space-y-4 py-4",children:[te,ae]}),e[241]=te,e[242]=ae,e[243]=ie):ie=e[243];let bs;e[244]===Symbol.for("react.memo_cache_sentinel")?(bs=s.jsx(h,{variant:"outline",onClick:()=>_e(!1),children:"Cancelar"}),e[244]=bs):bs=e[244];let Ns;e[245]===Symbol.for("react.memo_cache_sentinel")?(Ns=s.jsxs(Et,{children:[bs,s.jsx(h,{onClick:()=>{_e(!1)},children:"Confirmar Datos"})]}),e[245]=Ns):Ns=e[245];let re;e[246]!==ie?(re=s.jsxs(Rt,{children:[_s,ie,Ns]}),e[246]=ie,e[247]=re):re=e[247];let ys;return e[248]!==Es||e[249]!==re?(ys=s.jsx(Ft,{open:Es,onOpenChange:_e,children:re}),e[248]=Es,e[249]=re,e[250]=ys):ys=e[250],s.jsxs($t,{breadcrumbs:De,children:[Pe,s.jsxs("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-6 p-4",children:[Ae,s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[ts,s.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[s.jsxs(he,{children:[as,s.jsxs(me,{className:"space-y-6",children:[is,s.jsx("div",{className:"rounded-md border",children:s.jsxs("table",{className:"w-full text-sm",children:[ds,ms,s.jsx("tfoot",{className:"bg-muted/20",children:s.jsxs("tr",{children:[hs,s.jsxs("td",{className:"p-3 text-right font-bold",children:["$",rt.toLocaleString("es-CL")]}),fs]})})]})})]})]}),js]})]}),ys]})]})}function Bt(n){return s.jsxs(xt,{value:n.id.toString(),children:[n.name," ","(",n.sku,") - Stock:"," ",n.stock]},n.id)}function Wt(n){const[e]=n;return s.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-600",children:[s.jsx(ut,{className:"h-3 w-3"}),s.jsx("span",{children:e})]},e)}function Ht(n){const[,e]=n;return e==="Fallas"}function Mt(n){return n.currentTarget.showPicker()}function Ut(n){return s.jsx(xt,{value:n,children:n},n)}function Vt(n){return n.is_completed}function Gt(n,e){return n+(e.pivot.total_cost||0)}function Jt(n){return{...n,cost:n.cost?Number(n.cost):null}}export{Nl as default};
