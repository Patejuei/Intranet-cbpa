import{c as Pe,b as ze,u as Be,j as s,L as _e,H as Re}from"./app-C6T-jTXr.js";import{B as Ae}from"./badge-CMrn5U0i.js";import{a as We,B as Z,f as te}from"./button-CobyvyvC.js";import{b as j,C as ee,a as se,c as g}from"./card-BznEPpEu.js";import{d as qe,e as Ue,c as Ge,b as Je,D as Ke,a as Qe,f as Xe}from"./dialog-CS0KWPCG.js";import{I as $e}from"./input-CiN28aHX.js";import{L as Ee}from"./label-CKYe9Wtw.js";import{W as Me,A as Ye,C as Ze,F as es}from"./app-layout-w5ysdp2Y.js";import{C as Fe}from"./calendar-GnR5hDKY.js";import{C as Ie}from"./circle-check-DFGh5fe5.js";import{C as Oe}from"./circle-alert-BabCgYFO.js";import{A as ss}from"./arrow-left-DspzxsHS.js";/* empty css            */import"./index-BbUHeYab.js";import"./index-DRrjhBZS.js";import"./index-C4J_hXM0.js";import"./shield-skb7p-i4.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],as=We("DollarSign",ts);function Ls(a){const e=Pe.c(154),{vehicle:t,totalMaintenanceCost:ae}=a,l=ze().props,r=t.issues?.[0],i=t.maintenances?.[0],Ve=xs,Ne=ms,be=t.technical_review_expires_at||"",ve=t.circulation_permit_expires_at||"",ye=t.insurance_expires_at||"";let ne;e[0]!==be||e[1]!==ve||e[2]!==ye?(ne={technical_review_expires_at:be,circulation_permit_expires_at:ve,insurance_expires_at:ye},e[0]=be,e[1]=ve,e[2]=ye,e[3]=ne):ne=e[3];const{data:p,setData:f,patch:we,processing:le,errors:c}=Be(ne);let de;e[4]!==we||e[5]!==t.id?(de=re=>{re.preventDefault(),we(`/vehicles/${t.id}/documents`,{onSuccess:os})},e[4]=we,e[5]=t.id,e[6]=de):de=e[6];const ie=de;let _,N,b,n,d,v,o,y,w,m,k,x,h,C,S,D,u;if(e[7]!==l.auth||e[8]!==p||e[9]!==c||e[10]!==le||e[11]!==f||e[12]!==ie||e[13]!==t.circulation_permit_expires_at||e[14]!==t.company||e[15]!==t.id||e[16]!==t.insurance_expires_at||e[17]!==t.make||e[18]!==t.model||e[19]!==t.name||e[20]!==t.plate||e[21]!==t.status||e[22]!==t.technical_review_expires_at||e[23]!==t.year){const re=[{label:"Revisión Técnica",date:t.technical_review_expires_at,check:Ne(t.technical_review_expires_at)},{label:"Permiso de Circulación",date:t.circulation_permit_expires_at,check:Ne(t.circulation_permit_expires_at)},{label:"Seguro Obligatorio",date:t.insurance_expires_at,check:Ne(t.insurance_expires_at)}];b=Ye;let me;e[41]===Symbol.for("react.memo_cache_sentinel")?(me={title:"Material Mayor",href:"/vehicles/status"},e[41]=me):me=e[41];const ke=`/vehicles/status/${t.id}`;e[42]!==ke||e[43]!==t.name?(x=[me,{title:t.name,href:ke}],e[42]=ke,e[43]=t.name,e[44]=x):x=e[44];const Ce=`Detalle ${t.name}`;e[45]!==Ce?(h=s.jsx(Re,{title:Ce}),e[45]=Ce,e[46]=h):h=e[46],w="mx-auto flex w-full max-w-7xl flex-col gap-6 p-4";let xe;e[47]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx(Z,{variant:"ghost",size:"icon",asChild:!0,children:s.jsx(_e,{href:"/vehicles/status",children:s.jsx(ss,{className:"h-5 w-5"})})}),e[47]=xe):xe=e[47];const He=t.name,Se=Ve(t.status),De=t.status==="Operative"?"En Servicio":t.status==="Workshop"?"En Taller":"Fuera de Servicio";let P;e[48]!==Se||e[49]!==De?(P=s.jsx(Ae,{className:Se,children:De}),e[48]=Se,e[49]=De,e[50]=P):P=e[50];let z;e[51]!==P||e[52]!==t.name?(z=s.jsxs("h1",{className:"flex items-center gap-3 text-2xl font-bold",children:[He,P]}),e[51]=P,e[52]=t.name,e[53]=z):z=e[53];let B;e[54]!==t.company||e[55]!==t.make||e[56]!==t.model?(B=s.jsxs("p",{className:"text-muted-foreground",children:[t.company," - ",t.make," ",t.model]}),e[54]=t.company,e[55]=t.make,e[56]=t.model,e[57]=B):B=e[57];let R;e[58]!==z||e[59]!==B?(R=s.jsxs("div",{className:"flex items-center gap-4",children:[xe,s.jsxs("div",{children:[z,B]})]}),e[58]=z,e[59]=B,e[60]=R):R=e[60];const Te=`/vehicles/logs?vehicle_id=${t.id}`;let he;e[61]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx(Ze,{className:"mr-2 h-4 w-4"}),e[61]=he):he=e[61];let W;e[62]!==Te?(W=s.jsx(Z,{variant:"outline",asChild:!0,children:s.jsxs(_e,{href:Te,children:[he,"Ver Bitácora"]})}),e[62]=Te,e[63]=W):W=e[63];const Le=`/vehicles/checklists?vehicle_id=${t.id}`;let ue;e[64]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx(es,{className:"mr-2 h-4 w-4"}),e[64]=ue):ue=e[64];let q;e[65]!==Le?(q=s.jsx(Z,{variant:"outline",asChild:!0,children:s.jsxs(_e,{href:Le,children:[ue,"Ver Checklists"]})}),e[65]=Le,e[66]=q):q=e[66];let U;e[67]!==l.auth||e[68]!==t.id?(U=l.auth?.user&&(l.auth.user.role==="admin"||l.auth.user.role==="capitan")&&s.jsx(Z,{asChild:!0,children:s.jsxs(_e,{href:`/vehicles/${t.id}/edit`,children:[s.jsx(Me,{className:"mr-2 h-4 w-4"}),"Editar Unidad"]})}),e[67]=l.auth,e[68]=t.id,e[69]=U):U=e[69];let G;e[70]!==l.auth||e[71]!==p||e[72]!==c||e[73]!==le||e[74]!==f||e[75]!==ie?(G=l.auth?.user&&(l.auth.user.role==="admin"||l.auth.user.role==="capitan"||l.auth.user.permissions&&l.auth.user.permissions.includes("vehicles.edit"))&&s.jsxs(qe,{children:[s.jsx(Ue,{asChild:!0,children:s.jsxs(Z,{variant:"secondary",children:[s.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Actualizar Vencimientos"]})}),s.jsxs(Ge,{children:[s.jsxs(Je,{children:[s.jsx(Ke,{children:"Actualizar Documentación"}),s.jsx(Qe,{children:"Modifique las fechas de vencimiento de los documentos del vehículo."})]}),s.jsxs("form",{onSubmit:ie,children:[s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Ee,{htmlFor:"technical_review",children:"Revisión Técnica"}),s.jsx($e,{type:"date",value:p.technical_review_expires_at,onChange:ce=>f("technical_review_expires_at",ce.target.value)}),c.technical_review_expires_at&&s.jsx("span",{className:"text-sm text-destructive",children:c.technical_review_expires_at})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Ee,{htmlFor:"circulation_permit",children:"Permiso de Circulación"}),s.jsx($e,{type:"date",value:p.circulation_permit_expires_at,onChange:ce=>f("circulation_permit_expires_at",ce.target.value)}),c.circulation_permit_expires_at&&s.jsx("span",{className:"text-sm text-destructive",children:c.circulation_permit_expires_at})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Ee,{htmlFor:"insurance",children:"Seguro Obligatorio"}),s.jsx($e,{type:"date",value:p.insurance_expires_at,onChange:ce=>f("insurance_expires_at",ce.target.value)}),c.insurance_expires_at&&s.jsx("span",{className:"text-sm text-destructive",children:c.insurance_expires_at})]})]}),s.jsx(Xe,{children:s.jsx(Z,{type:"submit",disabled:le,children:"Guardar Cambios"})})]})]})]}),e[70]=l.auth,e[71]=p,e[72]=c,e[73]=le,e[74]=f,e[75]=ie,e[76]=G):G=e[76];let J;e[77]!==W||e[78]!==q||e[79]!==U||e[80]!==G?(J=s.jsxs("div",{className:"flex flex-wrap gap-2",children:[W,q,U,G]}),e[77]=W,e[78]=q,e[79]=U,e[80]=G,e[81]=J):J=e[81],e[82]!==R||e[83]!==J?(m=s.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[R,J]}),e[82]=R,e[83]=J,e[84]=m):m=e[84],k=re.some(ds)&&s.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:re.map(ns)}),y="grid grid-cols-1 gap-6 md:grid-cols-3",N=j,v="md:col-span-2",e[85]===Symbol.for("react.memo_cache_sentinel")?(o=s.jsx(ee,{children:s.jsx(se,{children:"Información del Vehículo"})}),e[85]=o):o=e[85],_=g,D="space-y-4";let pe;e[86]===Symbol.for("react.memo_cache_sentinel")?(pe=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Patente"}),e[86]=pe):pe=e[86];let K;e[87]!==t.plate?(K=s.jsxs("div",{children:[pe,s.jsx("p",{className:"text-lg font-semibold",children:t.plate})]}),e[87]=t.plate,e[88]=K):K=e[88];let fe;e[89]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Año"}),e[89]=fe):fe=e[89];let Q;e[90]!==t.year?(Q=s.jsxs("div",{children:[fe,s.jsx("p",{className:"text-lg font-semibold",children:t.year})]}),e[90]=t.year,e[91]=Q):Q=e[91];let je;e[92]===Symbol.for("react.memo_cache_sentinel")?(je=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Marca"}),e[92]=je):je=e[92];let X;e[93]!==t.make?(X=s.jsxs("div",{children:[je,s.jsx("p",{className:"text-lg font-semibold",children:t.make})]}),e[93]=t.make,e[94]=X):X=e[94];let ge;e[95]===Symbol.for("react.memo_cache_sentinel")?(ge=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Modelo"}),e[95]=ge):ge=e[95];let Y;e[96]!==t.model?(Y=s.jsxs("div",{children:[ge,s.jsx("p",{className:"text-lg font-semibold",children:t.model})]}),e[96]=t.model,e[97]=Y):Y=e[97],e[98]!==K||e[99]!==Q||e[100]!==X||e[101]!==Y?(u=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K,Q,X,Y]}),e[98]=K,e[99]=Q,e[100]=X,e[101]=Y,e[102]=u):u=e[102],e[103]===Symbol.for("react.memo_cache_sentinel")?(n=s.jsx("hr",{className:"my-4"}),d=s.jsx("h3",{className:"mb-2 font-medium",children:"Documentación"}),e[103]=n,e[104]=d):(n=e[103],d=e[104]),C="grid grid-cols-1 gap-4 sm:grid-cols-3",S=re.map(cs),e[7]=l.auth,e[8]=p,e[9]=c,e[10]=le,e[11]=f,e[12]=ie,e[13]=t.circulation_permit_expires_at,e[14]=t.company,e[15]=t.id,e[16]=t.insurance_expires_at,e[17]=t.make,e[18]=t.model,e[19]=t.name,e[20]=t.plate,e[21]=t.status,e[22]=t.technical_review_expires_at,e[23]=t.year,e[24]=_,e[25]=N,e[26]=b,e[27]=n,e[28]=d,e[29]=v,e[30]=o,e[31]=y,e[32]=w,e[33]=m,e[34]=k,e[35]=x,e[36]=h,e[37]=C,e[38]=S,e[39]=D,e[40]=u}else _=e[24],N=e[25],b=e[26],n=e[27],d=e[28],v=e[29],o=e[30],y=e[31],w=e[32],m=e[33],k=e[34],x=e[35],h=e[36],C=e[37],S=e[38],D=e[39],u=e[40];let T;e[105]!==C||e[106]!==S?(T=s.jsx("div",{className:C,children:S}),e[105]=C,e[106]=S,e[107]=T):T=e[107];let L;e[108]!==l.auth||e[109]!==ae?(L=l.auth?.user&&(l.auth.user.company==="Comandancia"||l.auth.user.role==="admin")&&s.jsxs("div",{className:"mt-4 rounded-md bg-blue-50 p-4",children:[s.jsxs("div",{className:"mb-1 flex items-center gap-2 text-blue-800",children:[s.jsx(as,{className:"h-5 w-5"}),s.jsx("span",{className:"font-bold",children:"Inversión Total en Mantenimiento"})]}),s.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:["$",(ae||0).toLocaleString("es-CL")]}),s.jsx("p",{className:"mt-1 text-xs text-blue-700",children:"Suma histórica de todas los trabajos realizados."})]}),e[108]=l.auth,e[109]=ae,e[110]=L):L=e[110];let $;e[111]!==_||e[112]!==n||e[113]!==d||e[114]!==T||e[115]!==L||e[116]!==D||e[117]!==u?($=s.jsxs(_,{className:D,children:[u,n,d,T,L]}),e[111]=_,e[112]=n,e[113]=d,e[114]=T,e[115]=L,e[116]=D,e[117]=u,e[118]=$):$=e[118];let E;e[119]!==N||e[120]!==v||e[121]!==o||e[122]!==$?(E=s.jsxs(N,{className:v,children:[o,$]}),e[119]=N,e[120]=v,e[121]=o,e[122]=$,e[123]=E):E=e[123];let M;e[124]!==t.status?(M=t.status==="Operative"&&s.jsxs(j,{className:"border-green-200 bg-green-50",children:[s.jsx(ee,{className:"pb-2",children:s.jsxs(se,{className:"flex items-center gap-2 text-green-800",children:[s.jsx(Ie,{className:"h-5 w-5"}),"Unidad Operativa"]})}),s.jsx(g,{children:s.jsx("p",{className:"text-sm text-green-700",children:"La unidad se encuentra operativa y disponible para el servicio."})})]}),e[124]=t.status,e[125]=M):M=e[125];let F;e[126]!==r||e[127]!==t.status?(F=t.status==="Out of Service"&&r&&s.jsxs(j,{className:"border-red-200 bg-red-50",children:[s.jsx(ee,{className:"pb-2",children:s.jsxs(se,{className:"flex items-center gap-2 text-red-800",children:[s.jsx(Oe,{className:"h-5 w-5"}),"Fuera de Servicio"]})}),s.jsxs(g,{className:"space-y-2",children:[s.jsx("p",{className:"text-sm font-medium text-red-900",children:"Motivo:"}),s.jsx("p",{className:"text-sm text-red-800",children:r.description}),s.jsxs("div",{className:"mt-2 flex gap-2 text-xs text-red-700",children:[s.jsx(Fe,{className:"h-3 w-3"})," ",r.date?te(r.date):te(r.created_at)]})]})]}),e[126]=r,e[127]=t.status,e[128]=F):F=e[128];let A;e[129]!==r||e[130]!==i||e[131]!==t.status?(A=(t.status==="Workshop"||t.status==="Out of Service"&&!r&&i)&&(i?s.jsxs(j,{className:"border-yellow-200 bg-yellow-50",children:[s.jsx(ee,{className:"pb-2",children:s.jsxs(se,{className:"flex items-center gap-2 text-yellow-800",children:[s.jsx(Me,{className:"h-5 w-5"}),"En Taller (",i.status==="Scheduled"?"Agendado":"En Proceso",")"]})}),s.jsxs(g,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-yellow-900",children:i.workshop_name}),s.jsx("p",{className:"text-sm text-yellow-800",children:i.description}),s.jsxs("div",{className:"mt-1 flex gap-2 text-xs text-yellow-700",children:[s.jsx(Fe,{className:"h-3 w-3"})," ","Ingreso:"," ",te(i.entry_date)]})]}),i.tasks&&i.tasks.length>0&&s.jsxs("div",{className:"rounded-md bg-white/50 p-3",children:[s.jsx("h4",{className:"mb-2 text-xs font-bold tracking-wider text-yellow-900 uppercase",children:"Tareas"}),s.jsx("div",{className:"space-y-2",children:i.tasks.map(rs)})]}),i.issues&&i.issues.length>0&&s.jsxs("div",{className:"rounded-md bg-white/50 p-3",children:[s.jsx("h4",{className:"mb-2 text-xs font-bold tracking-wider text-yellow-900 uppercase",children:"Incidencias Asociadas"}),s.jsx("ul",{className:"list-disc pl-4 text-sm text-slate-700",children:i.issues.map(is)})]})]})]}):s.jsxs(j,{className:"border-yellow-200 bg-yellow-50",children:[s.jsx(ee,{className:"pb-2",children:s.jsxs(se,{className:"flex items-center gap-2 text-yellow-800",children:[s.jsx(Me,{className:"h-5 w-5"}),"En Taller"]})}),s.jsx(g,{children:s.jsx("p",{className:"text-sm text-yellow-800",children:"No hay información detallada de la orden de trabajo."})})]})),e[129]=r,e[130]=i,e[131]=t.status,e[132]=A):A=e[132];let I;e[133]!==M||e[134]!==F||e[135]!==A?(I=s.jsxs("div",{className:"space-y-6",children:[M,F,A]}),e[133]=M,e[134]=F,e[135]=A,e[136]=I):I=e[136];let O;e[137]!==y||e[138]!==E||e[139]!==I?(O=s.jsxs("div",{className:y,children:[E,I]}),e[137]=y,e[138]=E,e[139]=I,e[140]=O):O=e[140];let V;e[141]!==t.maintenances?(V=t.maintenances&&t.maintenances.length>0&&s.jsxs(j,{children:[s.jsx(ee,{children:s.jsx(se,{children:"Historial de Órdenes de Trabajo"})}),s.jsx(g,{children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left text-sm",children:[s.jsx("thead",{className:"border-b bg-muted/50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-2 py-3 font-medium",children:"Fecha Ingreso"}),s.jsx("th",{className:"p-2 py-3 font-medium",children:"Taller"}),s.jsx("th",{className:"p-2 py-3 font-medium",children:"Trabajo"}),s.jsx("th",{className:"p-2 py-3 font-medium",children:"Estado"}),s.jsx("th",{className:"p-2 py-3 text-right font-medium",children:"Costo"})]})}),s.jsx("tbody",{children:t.maintenances.map(ls)})]})})})]}),e[141]=t.maintenances,e[142]=V):V=e[142];let H;e[143]!==w||e[144]!==m||e[145]!==k||e[146]!==O||e[147]!==V?(H=s.jsxs("div",{className:w,children:[m,k,O,V]}),e[143]=w,e[144]=m,e[145]=k,e[146]=O,e[147]=V,e[148]=H):H=e[148];let oe;return e[149]!==b||e[150]!==x||e[151]!==h||e[152]!==H?(oe=s.jsxs(b,{breadcrumbs:x,children:[h,H]}),e[149]=b,e[150]=x,e[151]=h,e[152]=H,e[153]=oe):oe=e[153],oe}function ls(a){return s.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/20",children:[s.jsx("td",{className:"p-2 py-3",children:te(a.entry_date)}),s.jsx("td",{className:"p-2 py-3",children:a.workshop_name}),s.jsx("td",{className:"p-2 py-3",children:a.description}),s.jsx("td",{className:"p-2 py-3",children:s.jsx(Ae,{variant:"outline",className:["Finalizado","Entregado"].includes(a.status)?"border-green-200 bg-green-50 text-green-700":"border-yellow-200 bg-yellow-50 text-yellow-700",children:a.status})}),s.jsx("td",{className:"p-2 py-3 text-right",children:a.cost>0?`$${a.cost.toLocaleString("es-CL")}`:"-"})]},a.id)}function is(a){return s.jsxs("li",{children:[a.description,a.status==="Resolved"&&s.jsx("span",{className:"ml-2 text-xs font-bold text-green-600",children:"(Solucionado)"})]},a.id)}function rs(a){return s.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[a.is_completed?s.jsx(Ie,{className:"mt-0.5 h-4 w-4 text-green-600"}):s.jsx("div",{className:"mt-0.5 h-4 w-4 rounded-full border-2 border-slate-300"}),s.jsx("span",{className:a.is_completed?"text-slate-700 line-through opacity-70":"font-medium text-slate-800",children:a.description})]},a.id)}function cs(a,e){return s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:a.label}),s.jsx("p",{className:"text-sm font-semibold",children:a.date?te(a.date):"No registrado"})]},e)}function ns(a,e){return!a.check||a.check.status==="ok"?null:s.jsx(j,{className:`border-l-4 ${a.check.status==="expired"?"border-l-red-500 bg-red-50":"border-l-yellow-500 bg-yellow-50"}`,children:s.jsx(g,{className:"pt-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Oe,{className:`h-5 w-5 ${a.check.status==="expired"?"text-red-600":"text-yellow-600"}`}),s.jsxs("div",{children:[s.jsxs("p",{className:`font-semibold ${a.check.status==="expired"?"text-red-700":"text-yellow-700"}`,children:[a.label," ",a.check.status==="expired"?"Vencido":"Por Vencer"]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Vence:"," ",te(a.date)," ",s.jsxs("span",{className:"font-medium",children:["(",Math.abs(a.check.days)," ","días"," ",a.check.status==="expired"?"atrasado":"restantes",")"]})]})]})]})})},e)}function ds(a){return a.check?.status==="expired"||a.check?.status==="warning"}function os(){}function ms(a){if(!a)return null;const e=new Date(a),t=new Date,ae=e.getTime()-t.getTime(),l=Math.ceil(ae/864e5);return l<0?{status:"expired",days:l}:l<=30?{status:"warning",days:l}:{status:"ok",days:l}}function xs(a){switch(a){case"Operative":return"bg-green-100 text-green-800";case"Workshop":return"bg-yellow-100 text-yellow-800";case"Out of Service":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}export{Ls as default};
