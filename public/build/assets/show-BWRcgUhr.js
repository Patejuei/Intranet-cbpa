import{c as J,d as K,u as H,j as s,L,H as Q}from"./app-BzTiI1vx.js";import{B as y}from"./badge-D1BqYX3d.js";import{c as U,B as $}from"./createLucideIcon-BwNl2ouA.js";import{I as V}from"./input-biSxcUox.js";import{L as W}from"./label-Czzj5tKt.js";import{T as X,S as Y}from"./textarea-B3UJsDmo.js";import{A as Z}from"./app-layout-nP07Hnxr.js";/* empty css            */import"./index-BiALZKL6.js";import"./index-Cc9F1Pjn.js";import"./index-C4J_hXM0.js";import"./shield-Dgb1-bwJ.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],M=U("Paperclip",ee);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],te=U("User",se);function he(k){const e=J.c(62),{ticket:t}=k,{auth:F}=K().props,r=F.user;let w;e[0]===Symbol.for("react.memo_cache_sentinel")?(w={message:"",image:null},e[0]=w):w=e[0];const{data:v,setData:R,post:A,processing:P,reset:D}=H(w);let E;e[1]!==t.status?(E={status:t.status},e[1]=t.status,e[2]=E):E=e[2],H(E);let _;e[3]!==A||e[4]!==D||e[5]!==t.id?(_=a=>{a.preventDefault(),A(`/tickets/${t.id}/reply`,{onSuccess:()=>D()})},e[3]=A,e[4]=D,e[5]=t.id,e[6]=_):_=e[6];const T=_,q=ae;let C,O;e[7]===Symbol.for("react.memo_cache_sentinel")?(C={title:"Panel Principal",href:"/dashboard"},O={title:"Ticketera",href:"/tickets"},e[7]=C,e[8]=O):(C=e[7],O=e[8]);const z=`Ticket #${t.id}`,B=`/tickets/${t.id}`;let i;e[9]!==z||e[10]!==B?(i=[C,O,{title:z,href:B}],e[9]=z,e[10]=B,e[11]=i):i=e[11];const I=`Ticket #${t.id}`;let l;e[12]!==I?(l=s.jsx(Q,{title:I}),e[12]=I,e[13]=l):l=e[13];let c;e[14]!==t.id||e[15]!==t.subject?(c=s.jsxs("h2",{className:"text-xl font-bold",children:["#",t.id," - ",t.subject]}),e[14]=t.id,e[15]=t.subject,e[16]=c):c=e[16];let d;e[17]!==t.status?(d=q(t.status),e[17]=t.status,e[18]=d):d=e[18];let n;e[19]!==t.priority?(n=s.jsx(y,{variant:"outline",children:t.priority}),e[19]=t.priority,e[20]=n):n=e[20];let o;e[21]!==c||e[22]!==d||e[23]!==n?(o=s.jsxs("div",{className:"flex items-center gap-2",children:[c,d,n]}),e[21]=c,e[22]=d,e[23]=n,e[24]=o):o=e[24];let m;e[25]!==t.user.name?(m=s.jsx("span",{className:"font-medium text-foreground",children:t.user.name}),e[25]=t.user.name,e[26]=m):m=e[26];const G=t.company;let u;e[27]!==t.created_at?(u=new Date(t.created_at).toLocaleDateString(),e[27]=t.created_at,e[28]=u):u=e[28];let x;e[29]!==m||e[30]!==u||e[31]!==t.company?(x=s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Iniciado por"," ",m," ","(",G,") el"," ",u]}),e[29]=m,e[30]=u,e[31]=t.company,e[32]=x):x=e[32];let p;e[33]!==o||e[34]!==x?(p=s.jsxs("div",{className:"space-y-1",children:[o,x]}),e[33]=o,e[34]=x,e[35]=p):p=e[35];let f;e[36]!==r.company||e[37]!==t.id||e[38]!==t.status?(f=r.company==="Comandancia"&&s.jsxs("div",{className:"flex items-center gap-2",children:[t.status!=="ABIERTO"&&s.jsx(L,{href:`/tickets/${t.id}/status`,method:"patch",data:{status:"ABIERTO"},as:"button",children:s.jsx($,{variant:"outline",size:"sm",children:"Reabrir"})}),t.status!=="EN_PROCESO"&&t.status!=="CERRADO"&&s.jsx(L,{href:`/tickets/${t.id}/status`,method:"patch",data:{status:"EN_PROCESO"},as:"button",children:s.jsx($,{variant:"default",size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:"Marcar En Proceso"})}),t.status!=="CERRADO"&&s.jsx(L,{href:`/tickets/${t.id}/status`,method:"patch",data:{status:"CERRADO"},as:"button",children:s.jsx($,{variant:"secondary",size:"sm",children:"Cerrar Ticket"})})]}),e[36]=r.company,e[37]=t.id,e[38]=t.status,e[39]=f):f=e[39];let h;e[40]!==p||e[41]!==f?(h=s.jsxs("div",{className:"flex flex-col justify-between gap-4 rounded-xl border bg-card p-4 shadow-sm md:flex-row md:p-6",children:[p,f]}),e[40]=p,e[41]=f,e[42]=h):h=e[42];let g;e[43]!==r.id||e[44]!==t.messages?(g=t.messages.length===0?s.jsx("div",{className:"py-10 text-center text-muted-foreground",children:"No hay mensajes."}):t.messages.map(a=>s.jsxs("div",{className:`flex gap-3 ${a.user.id===r.id?"flex-row-reverse":""}`,children:[s.jsx("div",{className:"flex size-8 shrink-0 items-center justify-center rounded-full bg-primary/20",children:s.jsx(te,{className:"size-4 text-primary"})}),s.jsxs("div",{className:`flex max-w-[80%] flex-col ${a.user.id===r.id?"items-end":""}`,children:[s.jsxs("div",{className:"mb-1 flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:a.user.name}),s.jsx("span",{className:"text-[10px] text-muted-foreground/70",children:new Date(a.created_at).toLocaleString()})]}),s.jsx("div",{className:`rounded-lg p-3 text-sm ${a.user.id===r.id?"rounded-tr-none bg-primary text-primary-foreground":"rounded-tl-none border bg-card shadow-sm"}`,children:s.jsx("p",{className:"whitespace-pre-wrap",children:a.message})}),a.image_path&&s.jsx("div",{className:"mt-2 max-w-[200px] overflow-hidden rounded-md border",children:s.jsx("img",{src:`/storage/${a.image_path}`,alt:"Adjunto",className:"h-auto w-full"})})]})]},a.id)),e[43]=r.id,e[44]=t.messages,e[45]=g):g=e[45];let j;e[46]!==g?(j=s.jsx("div",{className:"flex-1 space-y-4 overflow-y-auto rounded-xl border bg-muted/20 p-4",children:g}),e[46]=g,e[47]=j):j=e[47];let b;e[48]!==v||e[49]!==P||e[50]!==R||e[51]!==T||e[52]!==t.status?(b=s.jsx("div",{className:"rounded-xl border bg-card p-4 shadow-sm",children:t.status==="CERRADO"?s.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Este ticket está cerrado. Reabra el ticket para responder."}):s.jsxs("form",{onSubmit:T,className:"flex flex-col gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(X,{placeholder:"Escriba su respuesta...",value:v.message,onChange:a=>R("message",a.target.value),className:"min-h-[80px] resize-none pr-12",required:!0}),s.jsxs("div",{className:"absolute right-2 bottom-2",children:[s.jsx(W,{htmlFor:"msg-image",className:"block cursor-pointer rounded-full p-2 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",children:s.jsx(M,{className:"size-4"})}),s.jsx(V,{id:"msg-image",type:"file",className:"hidden",accept:"image/*",onChange:a=>R("image",a.target.files?a.target.files[0]:null)})]})]}),v.image&&s.jsxs("div",{className:"flex w-fit items-center gap-1 rounded bg-blue-50 px-2 py-1 text-xs text-blue-600",children:[s.jsx(M,{className:"size-3"}),"Imagen adjunta: ",v.image.name]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Comandancia vs Compañía"}),s.jsxs($,{type:"submit",disabled:P,className:"gap-2",children:[s.jsx(Y,{className:"size-4"}),"Responder"]})]})]})}),e[48]=v,e[49]=P,e[50]=R,e[51]=T,e[52]=t.status,e[53]=b):b=e[53];let N;e[54]!==h||e[55]!==j||e[56]!==b?(N=s.jsxs("div",{className:"mx-auto flex h-[calc(100vh-120px)] w-full max-w-5xl flex-col gap-6 p-4",children:[h,j,b]}),e[54]=h,e[55]=j,e[56]=b,e[57]=N):N=e[57];let S;return e[58]!==l||e[59]!==N||e[60]!==i?(S=s.jsxs(Z,{breadcrumbs:i,children:[l,N]}),e[58]=l,e[59]=N,e[60]=i,e[61]=S):S=e[61],S}function ae(k){switch(k){case"ABIERTO":return s.jsx(y,{className:"bg-yellow-500",children:"Pendiente"});case"EN_PROCESO":return s.jsx(y,{className:"bg-blue-500",children:"En Proceso"});case"CERRADO":return s.jsx(y,{variant:"secondary",children:"Cerrado"});default:return s.jsx(y,{variant:"outline",children:k})}}export{he as default};
