import{c as Te,b as Ve,u as Ue,j as s,H as De}from"./app-B61HxmhB.js";import{C as Fe}from"./checkbox-2mot1yDm.js";import{S as Be}from"./scroll-area-DYEdr7Fd.js";import{S as Ce,a as ke,b as Se,c as _e,d as ve}from"./select-C57hq6k-.js";import{T as ze,A as He}from"./app-layout-B6JJyxYC.js";import{S as We}from"./shield-BxyVENHa.js";/* empty css            */import"./button-DEfvv7zK.js";import"./index-DnuNE2iH.js";import"./index-BDoUajTH.js";import"./index-0lwPlNm7.js";import"./check-CNavjS5x.js";import"./index-q7GIQJN5.js";const Ge=["Primera Compañía","Segunda Compañía","Tercera Compañía","Cuarta Compañía","Quinta Compañía","Sexta Compañía","Séptima Compañía","Octava Compañía","Novena Compañía","Décima Compañía","Brigada Juvenil","Comandancia"],Pe=[{id:"inventory",label:"Inventario",category:"Material Menor"},{id:"tickets",label:"Ticketera",category:"Material Menor"},{id:"batteries",label:"Baterías",category:"Material Menor"},{id:"deliveries",label:"Actas de Entrega",category:"Material Menor"},{id:"reception",label:"Actas de Recepción",category:"Material Menor"},{id:"vehicles.status",label:"M. Mayor - Estado de Carros",category:"Material Mayor"},{id:"vehicles.incidents",label:"M. Mayor - Incidencias",category:"Material Mayor"},{id:"vehicles.checklist",label:"M. Mayor - Checklist",category:"Material Mayor"},{id:"vehicles.logs",label:"M. Mayor - Bitácora",category:"Material Mayor"},{id:"vehicles.workshop",label:"M. Mayor - Taller",category:"Material Mayor"},{id:"vehicles.inventory",label:"M. Mayor - Inventario",category:"Material Mayor"},{id:"firefighters",label:"Bomberos",category:"Administración"}],Je=["Material Menor","Material Mayor","Administración"],Le=n=>{const e=[{value:"user",label:"Usuario Estándar"},{value:"admin",label:"Administrador del Sistema"},{value:"comandante",label:"Comandante"},{value:"capitan",label:"Capitán"},{value:"teniente",label:"Teniente"},{value:"maquinista",label:"Maquinista"},{value:"ayudante",label:"Ayudante"},{value:"ayudante",label:"Ayudante"},{value:"cuartelero",label:"Cuartelero"},{value:"mechanic",label:"Taller Mecánico"},{value:"inspector",label:"Inspector General"}];if(n==="capitan"){const c=["user","teniente","maquinista","ayudante"];return e.filter(ge=>c.includes(ge.value))}return e},Oe=n=>{if(n==="capitan"){const e=["vehicles.inventory","vehicles.workshop","firefighters","vehicles","equipment"];return Pe.filter(c=>!e.includes(c.id))}return Pe};function ps(n){const e=Te.c(149),{availableVehicles:c}=n,{props:ge}=Ve(),qe=ge.auth.user,v=qe?.role||"user",ye=v==="capitan"&&qe.company||"";let ee;e[0]===Symbol.for("react.memo_cache_sentinel")?(ee=[],e[0]=ee):ee=e[0];let se;e[1]===Symbol.for("react.memo_cache_sentinel")?(se=[],e[1]=se):se=e[1];let te;e[2]!==ye?(te={name:"",email:"",password:"",company:ye,role:"user",department:"",permissions:ee,driver_vehicles:se},e[2]=ye,e[3]=te):te=e[3];const{data:t,setData:a,post:I,processing:je,errors:r}=Ue(te);let g,y,j,N,d,M,u,w,p,f,C,h,x,b,k;if(e[4]!==v||e[5]!==t.company||e[6]!==t.department||e[7]!==t.driver_vehicles||e[8]!==t.email||e[9]!==t.name||e[10]!==t.password||e[11]!==t.permissions||e[12]!==t.role||e[13]!==r.company||e[14]!==r.email||e[15]!==r.name||e[16]!==r.password||e[17]!==I||e[18]!==a){const m=Le(v),$e=Oe(v);let le;e[34]!==t.driver_vehicles||e[35]!==a?(le=i=>{const l=t.driver_vehicles;l.includes(i)?a("driver_vehicles",l.filter(o=>o!==i)):a("driver_vehicles",[...l,i])},e[34]=t.driver_vehicles,e[35]=a,e[36]=le):le=e[36],y=le;let ae;e[37]!==I?(ae=i=>{i.preventDefault(),I("/admin/users")},e[37]=I,e[38]=ae):ae=e[38];const Ee=ae;let re;e[39]!==t.permissions||e[40]!==a?(re=(i,l)=>{const o=t.permissions.filter(we=>!we.startsWith(`${i}.`));l==="view"?o.push(`${i}.view`):l==="edit"?o.push(`${i}.view`,`${i}.edit`):l==="full"&&o.push(`${i}.view`,`${i}.edit`,`${i}.full`),["inventory","deliveries","reception"].includes(i)&&l!=="none"&&!o.some(Ze)&&(o.some(Ye)||o.push("equipment.view")),["vehicles.status","vehicles.incidents","vehicles.checklist","vehicles.logs","vehicles.workshop","vehicles.inventory"].includes(i)&&l!=="none"&&(o.some(Xe)||o.push("vehicles.view")),a("permissions",o)},e[39]=t.permissions,e[40]=a,e[41]=re):re=e[41];const ne=re;let oe;e[42]!==t.permissions?(oe=i=>{const l=t.permissions.includes(`${i}.full`),o=t.permissions.includes(`${i}.edit`),Ae=t.permissions.includes(`${i}.view`);return l?"full":o?"edit":Ae?"view":"none"},e[42]=t.permissions,e[43]=oe):oe=e[43];const ce=oe;g=He,e[44]===Symbol.for("react.memo_cache_sentinel")?(p=[{title:"Panel Principal",href:"/dashboard"},{title:"Usuarios",href:"/admin/users"},{title:"Nuevo Usuario",href:"/admin/users/create"}],f=s.jsx(De,{title:"Crear Usuario"}),e[44]=p,e[45]=f):(p=e[44],f=e[45]),w="flex flex-col gap-6 p-4",M="max-w-4xl rounded-xl border bg-card p-6 shadow-sm",e[46]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Crear Nuevo Usuario"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete los detalles para registrar un nuevo usuario en el sistema."})]}),e[46]=u):u=e[46],j=Ee,N="space-y-6";let me;e[47]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Nombre Completo"}),e[47]=me):me=e[47];let E;e[48]!==a?(E=i=>a("name",i.target.value),e[48]=a,e[49]=E):E=e[49];let R;e[50]!==t.name||e[51]!==E?(R=s.jsx("input",{type:"text",value:t.name,onChange:E,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[50]=t.name,e[51]=E,e[52]=R):R=e[52];let T;e[53]!==r.name?(T=r.name&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.name}),e[53]=r.name,e[54]=T):T=e[54];let V;e[55]!==R||e[56]!==T?(V=s.jsxs("div",{children:[me,R,T]}),e[55]=R,e[56]=T,e[57]=V):V=e[57];let de;e[58]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Correo Electrónico"}),e[58]=de):de=e[58];let U;e[59]!==a?(U=i=>a("email",i.target.value),e[59]=a,e[60]=U):U=e[60];let D;e[61]!==t.email||e[62]!==U?(D=s.jsx("input",{type:"email",value:t.email,onChange:U,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[61]=t.email,e[62]=U,e[63]=D):D=e[63];let F;e[64]!==r.email?(F=r.email&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.email}),e[64]=r.email,e[65]=F):F=e[65];let B;e[66]!==D||e[67]!==F?(B=s.jsxs("div",{children:[de,D,F]}),e[66]=D,e[67]=F,e[68]=B):B=e[68];let z;e[69]!==V||e[70]!==B?(z=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[V,B]}),e[69]=V,e[70]=B,e[71]=z):z=e[71];let ue;e[72]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Contraseña"}),e[72]=ue):ue=e[72];let H;e[73]!==a?(H=i=>a("password",i.target.value),e[73]=a,e[74]=H):H=e[74];let W;e[75]!==t.password||e[76]!==H?(W=s.jsx("input",{type:"password",value:t.password,onChange:H,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[75]=t.password,e[76]=H,e[77]=W):W=e[77];let G;e[78]!==r.password?(G=r.password&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.password}),e[78]=r.password,e[79]=G):G=e[79];let J;e[80]!==W||e[81]!==G?(J=s.jsxs("div",{children:[ue,W,G]}),e[80]=W,e[81]=G,e[82]=J):J=e[82];let pe;e[83]===Symbol.for("react.memo_cache_sentinel")?(pe=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Compañía"}),e[83]=pe):pe=e[83];let L;e[84]!==a?(L=i=>a("company",i),e[84]=a,e[85]=L):L=e[85];const Ne=v==="capitan"||t.role==="comandante"||t.role==="inspector";let fe;e[86]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsx(ke,{className:"w-full",children:s.jsx(Se,{placeholder:"Seleccione una Compañía"})}),e[86]=fe):fe=e[86];let he;e[87]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx(_e,{children:Ge.map(Ke)}),e[87]=he):he=e[87];let O;e[88]!==t.company||e[89]!==L||e[90]!==Ne?(O=s.jsxs(Ce,{value:t.company,onValueChange:L,disabled:Ne,children:[fe,he]}),e[88]=t.company,e[89]=L,e[90]=Ne,e[91]=O):O=e[91];let Q;e[92]!==r.company?(Q=r.company&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.company}),e[92]=r.company,e[93]=Q):Q=e[93];let K;e[94]!==O||e[95]!==Q?(K=s.jsxs("div",{children:[pe,O,Q]}),e[94]=O,e[95]=Q,e[96]=K):K=e[96];let X;e[97]!==J||e[98]!==K?(X=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[J,K]}),e[97]=J,e[98]=K,e[99]=X):X=e[99],e[100]!==z||e[101]!==X?(d=s.jsxs("div",{className:"space-y-4",children:[z,X]}),e[100]=z,e[101]=X,e[102]=d):d=e[102],C="rounded-lg border p-4",e[103]===Symbol.for("react.memo_cache_sentinel")?(h=s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(We,{className:"size-4"})," Roles y Permisos"]}),e[103]=h):h=e[103];let xe;e[104]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Rol del Sistema"}),e[104]=xe):xe=e[104];const Re=t.role;let Y;e[105]!==a?(Y=i=>{a(l=>({...l,role:i,permissions:i==="admin"||i==="comandante"||i==="capitan"||i==="maquinista"||i==="inspector"||i==="mechanic"?[]:l.permissions,company:i==="comandante"||i==="inspector"?"Comandancia":l.company}))},e[105]=a,e[106]=Y):Y=e[106];let be;e[107]===Symbol.for("react.memo_cache_sentinel")?(be=s.jsx(ke,{className:"w-full",children:s.jsx(Se,{placeholder:"Seleccione un Rol"})}),e[107]=be):be=e[107];const Me=m.map(Qe);let Z;e[108]!==Me?(Z=s.jsx(_e,{children:Me}),e[108]=Me,e[109]=Z):Z=e[109],e[110]!==t.role||e[111]!==Y||e[112]!==Z?(x=s.jsxs("div",{className:"mb-6",children:[xe,s.jsxs(Ce,{value:Re,onValueChange:Y,children:[be,Z]})]}),e[110]=t.role,e[111]=Y,e[112]=Z,e[113]=x):x=e[113],e[114]!==t.department||e[115]!==t.role||e[116]!==a?(b=t.role==="inspector"&&s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Departamento"}),s.jsxs(Ce,{value:t.department,onValueChange:i=>a("department",i),children:[s.jsx(ke,{className:"w-full",children:s.jsx(Se,{placeholder:"Seleccione Departamento"})}),s.jsxs(_e,{children:[s.jsx(ve,{value:"Material Mayor",children:"Material Mayor"}),s.jsx(ve,{value:"Material Menor",children:"Material Menor"})]})]})]}),e[114]=t.department,e[115]=t.role,e[116]=a,e[117]=b):b=e[117],k=t.role!=="admin"&&t.role!=="comandante"&&t.role!=="capitan"&&t.role!=="maquinista"&&t.role!=="inspector"&&s.jsxs("div",{children:[s.jsx("label",{className:"mb-3 block text-sm font-medium",children:"Permisos por Módulo"}),s.jsx("div",{className:"space-y-6",children:Je.map(i=>$e.some(l=>l.category===i)&&s.jsxs("div",{className:"rounded-md border p-3",children:[s.jsx("h4",{className:"mb-2 text-sm font-semibold text-foreground",children:i}),s.jsx("table",{className:"w-full text-sm",children:s.jsx("tbody",{className:"divide-y",children:$e.filter(l=>l.category===i).map(l=>s.jsxs("tr",{children:[s.jsx("td",{className:"w-1/3 py-2.5 font-medium",children:l.label}),s.jsx("td",{className:"py-2",children:s.jsxs("div",{className:"flex gap-1 rounded-md bg-muted/50 p-1",children:[s.jsx("button",{type:"button",onClick:()=>ne(l.id,"none"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(l.id)==="none"?"bg-background shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ninguno"}),s.jsx("button",{type:"button",onClick:()=>ne(l.id,"view"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(l.id)==="view"?"bg-blue-100 text-blue-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ver"}),s.jsx("button",{type:"button",onClick:()=>ne(l.id,"edit"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(l.id)==="edit"?"bg-green-100 text-green-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Editar"}),(l.id==="vehicles"||l.id==="equipment")&&s.jsx("button",{type:"button",onClick:()=>ne(l.id,"full"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(l.id)==="full"?"bg-purple-100 text-purple-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Total"})]})})]},l.id))})})]},i))}),s.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"'Editar' incluye permisos de 'Ver'."})]}),e[4]=v,e[5]=t.company,e[6]=t.department,e[7]=t.driver_vehicles,e[8]=t.email,e[9]=t.name,e[10]=t.password,e[11]=t.permissions,e[12]=t.role,e[13]=r.company,e[14]=r.email,e[15]=r.name,e[16]=r.password,e[17]=I,e[18]=a,e[19]=g,e[20]=y,e[21]=j,e[22]=N,e[23]=d,e[24]=M,e[25]=u,e[26]=w,e[27]=p,e[28]=f,e[29]=C,e[30]=h,e[31]=x,e[32]=b,e[33]=k}else g=e[19],y=e[20],j=e[21],N=e[22],d=e[23],M=e[24],u=e[25],w=e[26],p=e[27],f=e[28],C=e[29],h=e[30],x=e[31],b=e[32],k=e[33];let S;e[118]!==C||e[119]!==h||e[120]!==x||e[121]!==b||e[122]!==k?(S=s.jsxs("div",{className:C,children:[h,x,b,k]}),e[118]=C,e[119]=h,e[120]=x,e[121]=b,e[122]=k,e[123]=S):S=e[123];let _;e[124]!==c||e[125]!==t.driver_vehicles||e[126]!==y?(_=c&&c.length>0&&s.jsxs("div",{className:"rounded-lg border p-4",children:[s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(ze,{className:"size-4"})," Vehículos Permitidos (Maquinistas)"]}),s.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Seleccione los vehículos que este usuario está autorizado a conducir y registrar en bitácora."}),s.jsx(Be,{className:"h-[200px] w-full rounded-md border p-4",children:s.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:c.map(m=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Fe,{id:`v-${m.id}`,checked:t.driver_vehicles.includes(m.id),onCheckedChange:()=>y(m.id)}),s.jsxs("label",{htmlFor:`v-${m.id}`,className:"text-sm leading-none font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[m.name," ",s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",m.company,")"]})]})]},m.id))})})]}),e[124]=c,e[125]=t.driver_vehicles,e[126]=y,e[127]=_):_=e[127];let q;e[128]!==je?(q=s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{type:"submit",disabled:je,className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-8 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90 focus-visible:ring-2 focus-visible:ring-primary focus-visible:outline-none disabled:opacity-50",children:"Registrar Usuario"})}),e[128]=je,e[129]=q):q=e[129];let $;e[130]!==j||e[131]!==N||e[132]!==d||e[133]!==S||e[134]!==_||e[135]!==q?($=s.jsxs("form",{onSubmit:j,className:N,children:[d,S,_,q]}),e[130]=j,e[131]=N,e[132]=d,e[133]=S,e[134]=_,e[135]=q,e[136]=$):$=e[136];let A;e[137]!==M||e[138]!==u||e[139]!==$?(A=s.jsxs("div",{className:M,children:[u,$]}),e[137]=M,e[138]=u,e[139]=$,e[140]=A):A=e[140];let P;e[141]!==w||e[142]!==A?(P=s.jsx("div",{className:w,children:A}),e[141]=w,e[142]=A,e[143]=P):P=e[143];let ie;return e[144]!==g||e[145]!==p||e[146]!==f||e[147]!==P?(ie=s.jsxs(g,{breadcrumbs:p,children:[f,P]}),e[144]=g,e[145]=p,e[146]=f,e[147]=P,e[148]=ie):ie=e[148],ie}function Qe(n){return s.jsx(ve,{value:n.value,children:n.label},n.value)}function Ke(n){return s.jsx(ve,{value:n,children:n},n)}function Xe(n){return n==="vehicles.view"||n==="vehicles.edit"||n==="vehicles.full"}function Ye(n){return n.startsWith("equipment.")}function Ze(n){return n==="equipment.view"||n==="equipment.edit"||n==="equipment.full"}export{ps as default};
