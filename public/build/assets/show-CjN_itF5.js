import{c as Q,b as V,u as U,j as s,a as L,L as M,H as W}from"./app-Bf-ojoLk.js";import{B as k}from"./badge-ekAfoPog.js";import{a as J,B as v,f as X}from"./button-RDZROtyk.js";import{s as Y,t as Z,v as ee,w as H,A as se}from"./app-layout-By4TFRiQ.js";import{I as te}from"./input-C9ya--bm.js";import{L as ae}from"./label-BK_x2Y1w.js";import{T as re}from"./textarea-DnOV8aQ3.js";import{S as ie}from"./send-DFivzFjz.js";/* empty css            */import"./index-BSE0trOz.js";import"./index-B2C5_TXF.js";import"./index-q7GIQJN5.js";import"./shield-AbyImIQU.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],F=J("Paperclip",le);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ne=J("User",ce);function ke(w){const e=Q.c(64),{ticket:t}=w,{auth:q}=V().props,r=q.user;let C;e[0]===Symbol.for("react.memo_cache_sentinel")?(C={message:"",image:null},e[0]=C):C=e[0];const{data:N,setData:E,post:O,processing:T,reset:P}=U(C);let R;e[1]!==t.status?(R={status:t.status},e[1]=t.status,e[2]=R):R=e[2],U(R);let A;e[3]!==O||e[4]!==P||e[5]!==t.id?(A=a=>{a.preventDefault(),O(`/tickets/${t.id}/reply`,{onSuccess:()=>P()})},e[3]=O,e[4]=P,e[5]=t.id,e[6]=A):A=e[6];const S=A,G=de;let _,$;e[7]===Symbol.for("react.memo_cache_sentinel")?(_={title:"Panel Principal",href:"/dashboard"},$={title:"Ticketera",href:"/tickets"},e[7]=_,e[8]=$):(_=e[7],$=e[8]);const I=`Ticket #${t.id}`,z=`/tickets/${t.id}`;let i;e[9]!==I||e[10]!==z?(i=[_,$,{title:I,href:z}],e[9]=I,e[10]=z,e[11]=i):i=e[11];const B=`Ticket #${t.id}`;let l;e[12]!==B?(l=s.jsx(W,{title:B}),e[12]=B,e[13]=l):l=e[13];let c;e[14]!==t.id||e[15]!==t.subject?(c=s.jsxs("h2",{className:"text-xl font-bold",children:["#",t.id," - ",t.subject]}),e[14]=t.id,e[15]=t.subject,e[16]=c):c=e[16];let n;e[17]!==t.status?(n=G(t.status),e[17]=t.status,e[18]=n):n=e[18];let d;e[19]!==r.company||e[20]!==t.id||e[21]!==t.priority?(d=r.company==="Comandancia"?s.jsxs(Y,{children:[s.jsx(Z,{asChild:!0,children:s.jsxs(v,{variant:"outline",size:"sm",className:"h-6 gap-1 text-xs",children:[t.priority,s.jsx("span",{className:"sr-only",children:"Cambiar Prioridad"})]})}),s.jsxs(ee,{align:"start",children:[s.jsx(H,{onClick:()=>L.patch(`/tickets/${t.id}/priority`,{priority:"BAJA"}),children:"BAJA"}),s.jsx(H,{onClick:()=>L.patch(`/tickets/${t.id}/priority`,{priority:"MEDIA"}),children:"MEDIA"}),s.jsx(H,{onClick:()=>L.patch(`/tickets/${t.id}/priority`,{priority:"ALTA"}),children:"ALTA"})]})]}):s.jsx(k,{variant:"outline",children:t.priority}),e[19]=r.company,e[20]=t.id,e[21]=t.priority,e[22]=d):d=e[22];let o;e[23]!==c||e[24]!==n||e[25]!==d?(o=s.jsxs("div",{className:"flex items-center gap-2",children:[c,n,d]}),e[23]=c,e[24]=n,e[25]=d,e[26]=o):o=e[26];let m;e[27]!==t.user.name?(m=s.jsx("span",{className:"font-medium text-foreground",children:t.user.name}),e[27]=t.user.name,e[28]=m):m=e[28];const K=t.company;let u;e[29]!==t.created_at?(u=X(t.created_at),e[29]=t.created_at,e[30]=u):u=e[30];let x;e[31]!==m||e[32]!==u||e[33]!==t.company?(x=s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Iniciado por"," ",m," ","(",K,") el"," ",u]}),e[31]=m,e[32]=u,e[33]=t.company,e[34]=x):x=e[34];let p;e[35]!==o||e[36]!==x?(p=s.jsxs("div",{className:"space-y-1",children:[o,x]}),e[35]=o,e[36]=x,e[37]=p):p=e[37];let h;e[38]!==r.company||e[39]!==t.id||e[40]!==t.status?(h=r.company==="Comandancia"&&s.jsxs("div",{className:"flex items-center gap-2",children:[t.status!=="ABIERTO"&&s.jsx(M,{href:`/tickets/${t.id}/status`,method:"patch",data:{status:"ABIERTO"},as:"button",children:s.jsx(v,{variant:"outline",size:"sm",children:"Reabrir"})}),t.status!=="EN_PROCESO"&&t.status!=="CERRADO"&&s.jsx(M,{href:`/tickets/${t.id}/status`,method:"patch",data:{status:"EN_PROCESO"},as:"button",children:s.jsx(v,{variant:"default",size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:"Marcar En Proceso"})}),t.status!=="CERRADO"&&s.jsx(M,{href:`/tickets/${t.id}/status`,method:"patch",data:{status:"CERRADO"},as:"button",children:s.jsx(v,{variant:"secondary",size:"sm",children:"Cerrar Ticket"})})]}),e[38]=r.company,e[39]=t.id,e[40]=t.status,e[41]=h):h=e[41];let f;e[42]!==p||e[43]!==h?(f=s.jsxs("div",{className:"flex flex-col justify-between gap-4 rounded-xl border bg-card p-4 shadow-sm md:flex-row md:p-6",children:[p,h]}),e[42]=p,e[43]=h,e[44]=f):f=e[44];let j;e[45]!==r.id||e[46]!==t.messages?(j=t.messages.length===0?s.jsx("div",{className:"py-10 text-center text-muted-foreground",children:"No hay mensajes."}):t.messages.map(a=>s.jsxs("div",{className:`flex gap-3 ${a.user.id===r.id?"flex-row-reverse":""}`,children:[s.jsx("div",{className:"flex size-8 shrink-0 items-center justify-center rounded-full bg-primary/20",children:s.jsx(ne,{className:"size-4 text-primary"})}),s.jsxs("div",{className:`flex max-w-[80%] flex-col ${a.user.id===r.id?"items-end":""}`,children:[s.jsxs("div",{className:"mb-1 flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:a.user.name}),s.jsx("span",{className:"text-[10px] text-muted-foreground/70",children:new Date(a.created_at).toLocaleString()})]}),s.jsx("div",{className:`rounded-lg p-3 text-sm ${a.user.id===r.id?"rounded-tr-none bg-primary text-primary-foreground":"rounded-tl-none border bg-card shadow-sm"}`,children:s.jsx("p",{className:"whitespace-pre-wrap",children:a.message})}),a.image_path&&s.jsx("div",{className:"mt-2 max-w-[200px] overflow-hidden rounded-md border",children:s.jsx("img",{src:`/storage/${a.image_path}`,alt:"Adjunto",className:"h-auto w-full"})})]})]},a.id)),e[45]=r.id,e[46]=t.messages,e[47]=j):j=e[47];let g;e[48]!==j?(g=s.jsx("div",{className:"flex-1 space-y-4 overflow-y-auto rounded-xl border bg-muted/20 p-4",children:j}),e[48]=j,e[49]=g):g=e[49];let b;e[50]!==N||e[51]!==T||e[52]!==E||e[53]!==S||e[54]!==t.status?(b=s.jsx("div",{className:"rounded-xl border bg-card p-4 shadow-sm",children:t.status==="CERRADO"?s.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Este ticket está cerrado. Reabra el ticket para responder."}):s.jsxs("form",{onSubmit:S,className:"flex flex-col gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(re,{placeholder:"Escriba su respuesta...",value:N.message,onChange:a=>E("message",a.target.value),className:"min-h-[80px] resize-none pr-12",required:!0}),s.jsxs("div",{className:"absolute right-2 bottom-2",children:[s.jsx(ae,{htmlFor:"msg-image",className:"block cursor-pointer rounded-full p-2 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",children:s.jsx(F,{className:"size-4"})}),s.jsx(te,{id:"msg-image",type:"file",className:"hidden",accept:"image/*",onChange:a=>E("image",a.target.files?a.target.files[0]:null)})]})]}),N.image&&s.jsxs("div",{className:"flex w-fit items-center gap-1 rounded bg-blue-50 px-2 py-1 text-xs text-blue-600",children:[s.jsx(F,{className:"size-3"}),"Imagen adjunta: ",N.image.name]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Comandancia vs Compañía"}),s.jsxs(v,{type:"submit",disabled:T,className:"gap-2",children:[s.jsx(ie,{className:"size-4"}),"Responder"]})]})]})}),e[50]=N,e[51]=T,e[52]=E,e[53]=S,e[54]=t.status,e[55]=b):b=e[55];let y;e[56]!==f||e[57]!==g||e[58]!==b?(y=s.jsxs("div",{className:"mx-auto flex h-[calc(100vh-120px)] w-full max-w-5xl flex-col gap-6 p-4",children:[f,g,b]}),e[56]=f,e[57]=g,e[58]=b,e[59]=y):y=e[59];let D;return e[60]!==l||e[61]!==y||e[62]!==i?(D=s.jsxs(se,{breadcrumbs:i,children:[l,y]}),e[60]=l,e[61]=y,e[62]=i,e[63]=D):D=e[63],D}function de(w){switch(w){case"ABIERTO":return s.jsx(k,{className:"bg-yellow-500",children:"Pendiente"});case"EN_PROCESO":return s.jsx(k,{className:"bg-blue-500",children:"En Proceso"});case"CERRADO":return s.jsx(k,{variant:"secondary",children:"Cerrado"});default:return s.jsx(k,{variant:"outline",children:w})}}export{ke as default};
