import{c as ot,u as dt,r as Ks,b as mt,j as s,a as Hs,H as ht}from"./app-BOBspnt-.js";import{B as Ws}from"./badge-DrfcEP6J.js";import{B as h,f as Js}from"./button-Di1XbPUP.js";import{C as ee,b as se,c as te,a as le}from"./card-DPyGVBSH.js";import{C as Qs}from"./checkbox-juppE8cW.js";import{I as us}from"./input-NKLVhLUo.js";import{L as d}from"./label-C6BinEqh.js";import{c as Xs,S as Ys,a as Zs,b as et,d as tt}from"./select-CT-xYwsE.js";import{S as Gs}from"./separator-CDJvSxFQ.js";import{u as xt}from"./use-permissions-DjJ6jjbi.js";import{F as ft,A as ut,W as pt}from"./app-layout-9l6tE_1t.js";import{C as lt}from"./circle-check-CiV2Cxo_.js";import{P as jt}from"./plus-BNc2IPm8.js";import{T as st}from"./trash-2-DiYqUGef.js";import{P as vt}from"./printer-CSw9_0Gz.js";import{S as gt}from"./save-kSniIzgZ.js";import{C as _t}from"./calendar-l8Z89Nu-.js";/* empty css            */import"./index-D4ApCw5w.js";import"./index-C8ghYhS1.js";import"./index-CZ3UvfYP.js";import"./check-vR_3gxU-.js";import"./chevron-down-CKj7OiL3.js";import"./index-C4J_hXM0.js";import"./shield-DVba0A4o.js";function sl(r){const e=ot.c(226),{maintenance:t,inventoryItems:ps}=r,at=t.status,js=t.tentative_exit_date||"";let ae;e[0]!==t.tasks?(ae=t.tasks.map(Tt),e[0]=t.tasks,e[1]=ae):ae=e[1];const vs=ae;let ie;e[2]===Symbol.for("react.memo_cache_sentinel")?(ie=[],e[2]=ie):ie=e[2];let re;e[3]!==t.status||e[4]!==js||e[5]!==vs?(re={status:at,tentative_exit_date:js,tasks:vs,resolved_issue_ids:ie},e[3]=t.status,e[4]=js,e[5]=vs,e[6]=re):re=e[6];const{data:a,setData:n,put:gs,processing:x}=dt(re);let ne;e[7]===Symbol.for("react.memo_cache_sentinel")?(ne={inventory_item_id:"",quantity:1},e[7]=ne):ne=e[7];const[m,_s]=Ks.useState(ne),[bs,Ns]=Ks.useState(!1);let ce;e[8]===Symbol.for("react.memo_cache_sentinel")?(ce=["En Taller","Ingresado","Trabajando","En Espera de Repuestos","Pruebas Finales","Finalizado","Entregado"],e[8]=ce):ce=e[8];const it=ce;let oe;e[9]!==t.id||e[10]!==gs?(oe=l=>{l.preventDefault(),gs(`/vehicles/workshop/${t.id}`)},e[9]=t.id,e[10]=gs,e[11]=oe):oe=e[11];const ys=oe;let de;e[12]!==a.tasks||e[13]!==n?(de=l=>{const c=[...a.tasks];c[l].is_completed=!c[l].is_completed,n("tasks",c)},e[12]=a.tasks,e[13]=n,e[14]=de):de=e[14];const J=de;let me;e[15]!==a.tasks||e[16]!==n?(me=(l,c)=>{const o=[...a.tasks];o[l].cost=c?parseFloat(c):null,n("tasks",o)},e[15]=a.tasks,e[16]=n,e[17]=me):me=e[17];const Q=me;let he;e[18]!==a.tasks||e[19]!==n?(he=(l,c)=>{const o=[...a.tasks];o[l].description=c,n("tasks",o)},e[18]=a.tasks,e[19]=n,e[20]=he):he=e[20];const X=he;let xe;e[21]!==a.tasks||e[22]!==n?(xe=()=>{n("tasks",[...a.tasks,{description:"",is_completed:!1,cost:null}])},e[21]=a.tasks,e[22]=n,e[23]=xe):xe=e[23];const ks=xe;let fe;e[24]!==a.tasks||e[25]!==n?(fe=l=>{const c=a.tasks.filter((o,Z)=>Z!==l);n("tasks",c)},e[24]=a.tasks,e[25]=n,e[26]=fe):fe=e[26];const Y=fe;let ue;e[27]!==a.resolved_issue_ids||e[28]!==n?(ue=l=>{const c=a.resolved_issue_ids;c.includes(l)?n("resolved_issue_ids",c.filter(o=>o!==l)):n("resolved_issue_ids",[...c,l])},e[27]=a.resolved_issue_ids,e[28]=n,e[29]=ue):ue=e[29];const Ss=ue;let pe;e[30]!==m||e[31]!==t.id?(pe=l=>{l.preventDefault(),!(!m.inventory_item_id||m.quantity<1)&&(Ns(!0),Hs.post(`/vehicles/maintenance/${t.id}/items`,m,{onSuccess:()=>{_s({inventory_item_id:"",quantity:1}),Ns(!1)},onError:()=>Ns(!1),preserveScroll:!0}))},e[30]=m,e[31]=t.id,e[32]=pe):pe=e[32];const Cs=pe;let je;e[33]!==t.id?(je=l=>{confirm("¿Eliminar este ítem de la orden?")&&Hs.delete(`/vehicles/maintenance/${t.id}/items/${l}`,{preserveScroll:!0})},e[33]=t.id,e[34]=je):je=e[34];const ws=je,Us=a.tasks.reduce(wt,0),Ts=t.items?.reduce(Ct,0)||0,Is=Us+Ts;let ve;e[35]!==a.tasks?(ve=a.tasks.filter(St),e[35]=a.tasks,e[36]=ve):ve=e[36];const Es=ve.length;mt();const{canEdit:$s}=xt();let ge;e[37]!==$s?(ge=$s("vehicles.workshop"),e[37]=$s,e[38]=ge):ge=e[38];const i=!ge;let _e,be;e[39]===Symbol.for("react.memo_cache_sentinel")?(_e={title:"Panel Principal",href:"/dashboard"},be={title:"Taller Mecánico",href:"/vehicles/workshop"},e[39]=_e,e[40]=be):(_e=e[39],be=e[40]);const Fs=`Orden #${t.id}`,Rs=`/vehicles/workshop/${t.id}`;let Ne;e[41]!==Fs||e[42]!==Rs?(Ne=[_e,be,{title:Fs,href:Rs}],e[41]=Fs,e[42]=Rs,e[43]=Ne):Ne=e[43];const Ls=`Orden de Trabajo #${t.id}`;let ye;e[44]!==Ls?(ye=s.jsx(ht,{title:Ls}),e[44]=Ls,e[45]=ye):ye=e[45];let ke;e[46]===Symbol.for("react.memo_cache_sentinel")?(ke=s.jsx(pt,{className:"h-6 w-6"}),e[46]=ke):ke=e[46];let f;e[47]!==t.id?(f=s.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-bold",children:[ke,"Orden de Trabajo #",t.id]}),e[47]=t.id,e[48]=f):f=e[48];let u;e[49]!==t.vehicle.company||e[50]!==t.vehicle.name||e[51]!==t.vehicle.plate?(u=s.jsxs("p",{className:"text-muted-foreground",children:[t.vehicle.name," -"," ",t.vehicle.plate," (",t.vehicle.company,")"]}),e[49]=t.vehicle.company,e[50]=t.vehicle.name,e[51]=t.vehicle.plate,e[52]=u):u=e[52];let p;e[53]!==f||e[54]!==u?(p=s.jsxs("div",{children:[f,u]}),e[53]=f,e[54]=u,e[55]=p):p=e[55];let j;e[56]!==t.id||e[57]!==t.status?(j=(t.status==="Finalizado"||t.status==="Entregado")&&s.jsx(h,{variant:"outline",asChild:!0,className:"border-green-600 text-green-600 hover:bg-green-50",children:s.jsxs("a",{href:`/vehicles/workshop/${t.id}/print-exit`,target:"_blank",rel:"noopener noreferrer",children:[s.jsx(ft,{className:"mr-2 h-4 w-4"}),"Imprimir Salida"]})}),e[56]=t.id,e[57]=t.status,e[58]=j):j=e[58];const Ps=`/vehicles/workshop/${t.id}/print`;let Se,Ce,we;e[59]===Symbol.for("react.memo_cache_sentinel")?(Se=s.jsx(vt,{className:"mr-2 h-4 w-4"}),Ce=s.jsx("span",{className:"hidden sm:inline",children:"Imprimir Orden"}),we=s.jsx("span",{className:"sm:hidden",children:"Imprimir"}),e[59]=Se,e[60]=Ce,e[61]=we):(Se=e[59],Ce=e[60],we=e[61]);let v;e[62]!==Ps?(v=s.jsx(h,{variant:"outline",asChild:!0,children:s.jsxs("a",{href:Ps,target:"_blank",rel:"noopener noreferrer",children:[Se,Ce,we]})}),e[62]=Ps,e[63]=v):v=e[63];let g;e[64]!==ys||e[65]!==i||e[66]!==x?(g=!i&&s.jsxs(h,{onClick:ys,disabled:x,children:[s.jsx(gt,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Guardar Cambios"})]}),e[64]=ys,e[65]=i,e[66]=x,e[67]=g):g=e[67];let _;e[68]!==a||e[69]!==i||e[70]!==t.id||e[71]!==t.status||e[72]!==x?(_=!i&&t.status!=="Finalizado"&&t.status!=="Entregado"&&s.jsxs(h,{variant:"destructive",onClick:()=>{confirm("¿Está seguro de finalizar el trabajo? Esto resolverá las incidencias marcadas y generará el documento de salida.")&&Hs.put(`/vehicles/workshop/${t.id}`,{...a,status:"Finalizado"})},disabled:x,children:[s.jsx(lt,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Finalizar"})]}),e[68]=a,e[69]=i,e[70]=t.id,e[71]=t.status,e[72]=x,e[73]=_):_=e[73];let b;e[74]!==j||e[75]!==v||e[76]!==g||e[77]!==_?(b=s.jsxs("div",{className:"flex gap-2",children:[j,v,g,_]}),e[74]=j,e[75]=v,e[76]=g,e[77]=_,e[78]=b):b=e[78];let Te;e[79]!==p||e[80]!==b?(Te=s.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[p,b]}),e[79]=p,e[80]=b,e[81]=Te):Te=e[81];let Ie;e[82]===Symbol.for("react.memo_cache_sentinel")?(Ie=s.jsx(ee,{children:s.jsx(le,{children:"Estado y Fechas"})}),e[82]=Ie):Ie=e[82];let Ee;e[83]===Symbol.for("react.memo_cache_sentinel")?(Ee=s.jsx(d,{children:"Estado Actual"}),e[83]=Ee):Ee=e[83];let N;e[84]!==n?(N=l=>n("status",l),e[84]=n,e[85]=N):N=e[85];let $e;e[86]===Symbol.for("react.memo_cache_sentinel")?($e=s.jsx(Zs,{children:s.jsx(et,{})}),e[86]=$e):$e=e[86];let Fe;e[87]===Symbol.for("react.memo_cache_sentinel")?(Fe=s.jsx(Xs,{children:it.map(kt)}),e[87]=Fe):Fe=e[87];let y;e[88]!==a.status||e[89]!==i||e[90]!==N?(y=s.jsxs("div",{className:"space-y-2",children:[Ee,s.jsxs(Ys,{value:a.status,onValueChange:N,disabled:i,children:[$e,Fe]})]}),e[88]=a.status,e[89]=i,e[90]=N,e[91]=y):y=e[91];let Re;e[92]===Symbol.for("react.memo_cache_sentinel")?(Re=s.jsx(d,{children:"Fecha de Ingreso"}),e[92]=Re):Re=e[92];let Le;e[93]===Symbol.for("react.memo_cache_sentinel")?(Le=s.jsx(_t,{className:"h-4 w-4"}),e[93]=Le):Le=e[93];let k;e[94]!==t.entry_date?(k=Js(t.entry_date),e[94]=t.entry_date,e[95]=k):k=e[95];let S;e[96]!==k?(S=s.jsxs("div",{className:"space-y-2",children:[Re,s.jsxs("div",{className:"flex items-center gap-2 rounded border bg-muted/50 p-2 text-sm",children:[Le,k]})]}),e[96]=k,e[97]=S):S=e[97];let Pe;e[98]===Symbol.for("react.memo_cache_sentinel")?(Pe=s.jsx(d,{children:"Fecha Tentativa Salida"}),e[98]=Pe):Pe=e[98];let C;e[99]!==n?(C=l=>n("tentative_exit_date",l.target.value),e[99]=n,e[100]=C):C=e[100];let w;e[101]!==a.tentative_exit_date||e[102]!==i||e[103]!==C?(w=s.jsxs("div",{className:"space-y-2",children:[Pe,s.jsx(us,{type:"date",value:a.tentative_exit_date,onChange:C,disabled:i})]}),e[101]=a.tentative_exit_date,e[102]=i,e[103]=C,e[104]=w):w=e[104];let ze;e[105]===Symbol.for("react.memo_cache_sentinel")?(ze=s.jsx(Gs,{}),e[105]=ze):ze=e[105];let Oe;e[106]===Symbol.for("react.memo_cache_sentinel")?(Oe=s.jsx(d,{children:"Taller / Proveedor"}),e[106]=Oe):Oe=e[106];let T;e[107]!==t.workshop_name?(T=s.jsxs("div",{className:"space-y-2",children:[Oe,s.jsx("p",{className:"font-medium",children:t.workshop_name})]}),e[107]=t.workshop_name,e[108]=T):T=e[108];let I;e[109]!==y||e[110]!==S||e[111]!==w||e[112]!==T?(I=s.jsxs(se,{children:[Ie,s.jsxs(te,{className:"space-y-4",children:[y,S,w,ze,T]})]}),e[109]=y,e[110]=S,e[111]=w,e[112]=T,e[113]=I):I=e[113];let Ae;e[114]===Symbol.for("react.memo_cache_sentinel")?(Ae=s.jsx(ee,{children:s.jsx(le,{className:"text-base",children:"Detalles del Ingreso"})}),e[114]=Ae):Ae=e[114];let De;e[115]===Symbol.for("react.memo_cache_sentinel")?(De=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Responsable"}),e[115]=De):De=e[115];const zs=t.responsible_person||"-";let E;e[116]!==zs?(E=s.jsxs("div",{children:[De,s.jsx("p",{className:"font-medium",children:zs})]}),e[116]=zs,e[117]=E):E=e[117];let qe;e[118]===Symbol.for("react.memo_cache_sentinel")?(qe=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Kilometraje"}),e[118]=qe):qe=e[118];const Os=t.mileage_in?`${t.mileage_in} km`:"-";let $;e[119]!==Os?($=s.jsxs("div",{children:[qe,s.jsx("p",{className:"font-medium",children:Os})]}),e[119]=Os,e[120]=$):$=e[120];let Be;e[121]===Symbol.for("react.memo_cache_sentinel")?(Be=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Tracción"}),e[121]=Be):Be=e[121];const As=t.traction||"-";let F;e[122]!==As?(F=s.jsxs("div",{children:[Be,s.jsx("p",{className:"font-medium",children:As})]}),e[122]=As,e[123]=F):F=e[123];let Me;e[124]===Symbol.for("react.memo_cache_sentinel")?(Me=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Transmisión"}),e[124]=Me):Me=e[124];const Ds=t.transmission||"-";let R;e[125]!==Ds?(R=s.jsxs("div",{children:[Me,s.jsx("p",{className:"font-medium",children:Ds})]}),e[125]=Ds,e[126]=R):R=e[126];let Ve;e[127]===Symbol.for("react.memo_cache_sentinel")?(Ve=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Combustible"}),e[127]=Ve):Ve=e[127];const qs=t.fuel_type||"-";let L;e[128]!==qs?(L=s.jsxs("div",{className:"col-span-2",children:[Ve,s.jsx("p",{className:"font-medium",children:qs})]}),e[128]=qs,e[129]=L):L=e[129];let P;e[130]!==E||e[131]!==$||e[132]!==F||e[133]!==R||e[134]!==L?(P=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E,$,F,R,L]}),e[130]=E,e[131]=$,e[132]=F,e[133]=R,e[134]=L,e[135]=P):P=e[135];let z;e[136]!==t.entry_checklist?(z=t.entry_checklist&&s.jsxs("div",{className:"mt-4",children:[s.jsx(d,{className:"mb-2 block text-xs text-muted-foreground",children:"Checklist de Recepción (Fallas)"}),s.jsx("div",{className:"space-y-1 rounded border p-2",children:(()=>{const l=Object.entries(t.entry_checklist).filter(yt);return l.length===0?s.jsx("p",{className:"text-xs text-muted-foreground",children:"No se reportaron fallas en el ingreso."}):l.map(Nt)})()})]}),e[136]=t.entry_checklist,e[137]=z):z=e[137];let O;e[138]!==P||e[139]!==z?(O=s.jsxs(se,{children:[Ae,s.jsxs(te,{className:"space-y-4 text-sm",children:[P,z]})]}),e[138]=P,e[139]=z,e[140]=O):O=e[140];let He;e[141]===Symbol.for("react.memo_cache_sentinel")?(He=s.jsx(ee,{children:s.jsx(le,{className:"text-base",children:"Incidencias Vinculadas"})}),e[141]=He):He=e[141];let A;e[142]!==a.resolved_issue_ids||e[143]!==i||e[144]!==t.issues||e[145]!==Ss?(A=t.issues.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay incidencias vinculadas."}):t.issues.map(l=>s.jsxs("div",{className:"flex items-start gap-2 rounded border p-2",children:[s.jsx(Qs,{checked:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id),disabled:i||l.status==="Resolved",onCheckedChange:()=>Ss(l.id)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium",children:l.description}),s.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-muted-foreground",children:Js(l.date)}),s.jsx(Ws,{variant:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id)?"default":"secondary",children:l.status==="Resolved"?"Resuelto":a.resolved_issue_ids.includes(l.id)?"Marcado para Resolver":"Pendiente"})]})]})]},l.id)),e[142]=a.resolved_issue_ids,e[143]=i,e[144]=t.issues,e[145]=Ss,e[146]=A):A=e[146];let D;e[147]!==A?(D=s.jsxs(se,{children:[He,s.jsx(te,{className:"space-y-3",children:A})]}),e[147]=A,e[148]=D):D=e[148];let We;e[149]!==I||e[150]!==O||e[151]!==D?(We=s.jsxs("div",{className:"space-y-6 lg:col-span-1",children:[I,O,D]}),e[149]=I,e[150]=O,e[151]=D,e[152]=We):We=e[152];let Ge;e[153]===Symbol.for("react.memo_cache_sentinel")?(Ge=s.jsx(le,{children:"Repuestos e Insumos Utilizados"}),e[153]=Ge):Ge=e[153];const Bs=t.items?.length||0;let Ue;e[154]!==Bs?(Ue=s.jsxs(ee,{className:"flex flex-row items-center justify-between",children:[Ge,s.jsxs(Ws,{variant:"secondary",className:"text-base",children:[Bs," Ítems"]})]}),e[154]=Bs,e[155]=Ue):Ue=e[155];let Ke;e[156]!==Cs||e[157]!==m||e[158]!==ps||e[159]!==bs||e[160]!==i||e[161]!==t.status?(Ke=!i&&t.status!=="Finalizado"&&s.jsxs("div",{className:"flex items-end gap-2 rounded bg-muted/30 p-4",children:[s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx(d,{children:"Item de Bodega"}),s.jsxs(Ys,{value:m.inventory_item_id.toString(),onValueChange:l=>_s({...m,inventory_item_id:l}),children:[s.jsx(Zs,{children:s.jsx(et,{placeholder:"Seleccionar ítem..."})}),s.jsx(Xs,{children:ps.map(bt)})]})]}),s.jsxs("div",{className:"w-24 space-y-2",children:[s.jsx(d,{children:"Cantidad"}),s.jsx(us,{type:"number",min:"1",value:m.quantity,onChange:l=>_s({...m,quantity:parseInt(l.target.value)||1})})]}),s.jsxs(h,{onClick:Cs,disabled:bs||!m.inventory_item_id,children:[s.jsx(jt,{className:"mr-2 h-4 w-4"}),"Agregar"]})]}),e[156]=Cs,e[157]=m,e[158]=ps,e[159]=bs,e[160]=i,e[161]=t.status,e[162]=Ke):Ke=e[162];let Je,Qe,Xe,Ye;e[163]===Symbol.for("react.memo_cache_sentinel")?(Je=s.jsx("th",{className:"p-3 font-medium",children:"Ítem"}),Qe=s.jsx("th",{className:"p-3 text-right font-medium",children:"Cant."}),Xe=s.jsx("th",{className:"p-3 text-right font-medium",children:"Costo Unit."}),Ye=s.jsx("th",{className:"p-3 text-right font-medium",children:"Total"}),e[163]=Je,e[164]=Qe,e[165]=Xe,e[166]=Ye):(Je=e[163],Qe=e[164],Xe=e[165],Ye=e[166]);let q;e[167]!==i?(q=!i&&s.jsx("th",{className:"w-[50px] p-3 text-right font-medium text-muted-foreground"}),e[167]=i,e[168]=q):q=e[168];let Ze;e[169]!==q?(Ze=s.jsx("thead",{children:s.jsxs("tr",{className:"border-b bg-muted/50 text-left",children:[Je,Qe,Xe,Ye,q]})}),e[169]=q,e[170]=Ze):Ze=e[170];let B;e[171]!==ws||e[172]!==i||e[173]!==t.items?(B=!t.items||t.items.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"p-4 text-center text-muted-foreground",children:"No se han utilizado repuestos."})}):t.items.map(l=>s.jsxs("tr",{className:"border-b last:border-0",children:[s.jsxs("td",{className:"p-3",children:[s.jsx("div",{className:"font-medium",children:l.name}),s.jsx("div",{className:"text-xs text-muted-foreground",children:l.sku})]}),s.jsx("td",{className:"p-3 text-right",children:l.pivot.quantity}),s.jsxs("td",{className:"p-3 text-right",children:["$",l.pivot.unit_cost.toLocaleString("es-CL")]}),s.jsxs("td",{className:"p-3 text-right font-medium",children:["$",l.pivot.total_cost.toLocaleString("es-CL")]}),!i&&s.jsx("td",{className:"p-3 text-right",children:s.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:bg-destructive/10",onClick:()=>ws(l.id),children:s.jsx(st,{className:"h-4 w-4"})})})]},l.id)),e[171]=ws,e[172]=i,e[173]=t.items,e[174]=B):B=e[174];let es;e[175]!==B?(es=s.jsx("tbody",{children:B}),e[175]=B,e[176]=es):es=e[176];let ss;e[177]===Symbol.for("react.memo_cache_sentinel")?(ss=s.jsx("td",{colSpan:3,className:"p-3 text-right font-semibold",children:"Total Repuestos:"}),e[177]=ss):ss=e[177];let ts;e[178]!==i?(ts=!i&&s.jsx("td",{}),e[178]=i,e[179]=ts):ts=e[179];let ls;e[180]===Symbol.for("react.memo_cache_sentinel")?(ls=s.jsx(le,{children:"Lista de Trabajos (Mano de Obra)"}),e[180]=ls):ls=e[180];let as;e[181]!==Es||e[182]!==a.tasks.length?(as=s.jsxs(ee,{className:"flex flex-row items-center justify-between",children:[ls,s.jsxs(Ws,{variant:"outline",className:"text-base",children:["Progreso: ",Es," /"," ",a.tasks.length]})]}),e[181]=Es,e[182]=a.tasks.length,e[183]=as):as=e[183];let is;e[184]===Symbol.for("react.memo_cache_sentinel")?(is=s.jsx(d,{children:"Descripción General / Observaciones"}),e[184]=is):is=e[184];const Ms=t.description||"Sin observaciones generales.";let rs;e[185]!==Ms?(rs=s.jsxs("div",{className:"space-y-2",children:[is,s.jsx("p",{className:"min-h-[60px] rounded border bg-muted p-3 text-sm text-muted-foreground",children:Ms})]}),e[185]=Ms,e[186]=rs):rs=e[186];let ns;e[187]===Symbol.for("react.memo_cache_sentinel")?(ns=s.jsx(Gs,{}),e[187]=ns):ns=e[187];let cs;e[188]===Symbol.for("react.memo_cache_sentinel")?(cs=s.jsx(d,{className:"text-base font-semibold",children:"Tareas Específicas"}),e[188]=cs):cs=e[188];let M;e[189]!==ks||e[190]!==i?(M=!i&&s.jsx(h,{size:"sm",variant:"secondary",onClick:ks,type:"button",children:"+ Agregar Tarea"}),e[189]=ks,e[190]=i,e[191]=M):M=e[191];let V;e[192]!==M?(V=s.jsxs("div",{className:"flex items-center justify-between",children:[cs,M]}),e[192]=M,e[193]=V):V=e[193];let H;e[194]!==a.tasks.length?(H=a.tasks.length===0&&s.jsx("p",{className:"rounded border-2 border-dashed py-8 text-center text-muted-foreground",children:"No hay tareas registradas. Agrega una para comenzar el seguimiento."}),e[194]=a.tasks.length,e[195]=H):H=e[195];let W;if(e[196]!==a.tasks||e[197]!==i||e[198]!==Y||e[199]!==J||e[200]!==Q||e[201]!==X){let l;e[203]!==i||e[204]!==Y||e[205]!==J||e[206]!==Q||e[207]!==X?(l=(c,o)=>s.jsxs("div",{className:"flex flex-col items-start gap-3 rounded border bg-card p-3 transition-colors hover:bg-accent/5 md:flex-row md:items-center",children:[s.jsx(Qs,{checked:c.is_completed,onCheckedChange:()=>J(o),disabled:i,className:"mt-1 md:mt-0"}),s.jsxs("div",{className:"w-full flex-1 space-y-2 md:flex md:gap-4 md:space-y-0",children:[s.jsx(us,{value:c.description,onChange:Z=>X(o,Z.target.value),placeholder:"Descripción de la tarea",disabled:i,className:c.is_completed?"text-muted-foreground line-through":""}),s.jsxs("div",{className:"flex w-full items-center gap-2 md:w-32",children:[s.jsx("span",{className:"text-sm font-semibold text-muted-foreground",children:"$"}),s.jsx(us,{type:"number",value:c.cost??"",onChange:Z=>Q(o,Z.target.value),placeholder:"Costo",disabled:i})]})]}),!i&&s.jsx(h,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>Y(o),type:"button",children:s.jsx(st,{className:"h-4 w-4"})})]},o),e[203]=i,e[204]=Y,e[205]=J,e[206]=Q,e[207]=X,e[208]=l):l=e[208],W=a.tasks.map(l),e[196]=a.tasks,e[197]=i,e[198]=Y,e[199]=J,e[200]=Q,e[201]=X,e[202]=W}else W=e[202];let os;e[209]!==V||e[210]!==H||e[211]!==W?(os=s.jsxs("div",{className:"space-y-4",children:[V,H,W]}),e[209]=V,e[210]=H,e[211]=W,e[212]=os):os=e[212];let ds;e[213]===Symbol.for("react.memo_cache_sentinel")?(ds=s.jsx(Gs,{}),e[213]=ds):ds=e[213];let ms;e[214]===Symbol.for("react.memo_cache_sentinel")?(ms=s.jsx("span",{className:"text-sm",children:"Total Mano de Obra:"}),e[214]=ms):ms=e[214];const rt="flex items-center justify-end gap-4 text-muted-foreground";let G;e[215]===Symbol.for("react.memo_cache_sentinel")?(G=s.jsx("span",{className:"text-sm",children:"Total Repuestos:"}),e[215]=G):G=e[215];const nt="font-semibold",ct="$",Vs=Ts.toLocaleString("es-CL");let U;e[216]!==Vs?(U=s.jsxs("span",{className:nt,children:[ct,Vs]}),e[216]=Vs,e[217]=U):U=e[217];let hs;e[218]!==G||e[219]!==U?(hs=s.jsxs("div",{className:rt,children:[G,U]}),e[218]=G,e[219]=U,e[220]=hs):hs=e[220];let xs;e[221]===Symbol.for("react.memo_cache_sentinel")?(xs=s.jsx("span",{className:"text-lg font-bold",children:"Costo Total Estimado:"}),e[221]=xs):xs=e[221];let K;e[222]!==Is?(K=Is.toLocaleString("es-CL"),e[222]=Is,e[223]=K):K=e[223];let fs;return e[224]!==K?(fs=s.jsxs("div",{className:"flex items-center justify-end gap-4 border-t pt-2",children:[xs,s.jsxs("span",{className:"text-2xl font-bold text-primary",children:["$",K]})]}),e[224]=K,e[225]=fs):fs=e[225],s.jsxs(ut,{breadcrumbs:Ne,children:[ye,s.jsxs("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-6 p-4",children:[Te,s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[We,s.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[s.jsxs(se,{children:[Ue,s.jsxs(te,{className:"space-y-6",children:[Ke,s.jsx("div",{className:"rounded-md border",children:s.jsxs("table",{className:"w-full text-sm",children:[Ze,es,s.jsx("tfoot",{className:"bg-muted/20",children:s.jsxs("tr",{children:[ss,s.jsxs("td",{className:"p-3 text-right font-bold",children:["$",Ts.toLocaleString("es-CL")]}),ts]})})]})})]})]}),s.jsxs(se,{children:[as,s.jsxs(te,{className:"space-y-4",children:[rs,ns,os,ds,s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-end gap-4 text-muted-foreground",children:[ms,s.jsxs("span",{className:"font-semibold",children:["$",Us.toLocaleString("es-CL")]})]}),hs,fs]})]})]})]})]})]})]})}function bt(r){return s.jsxs(tt,{value:r.id.toString(),children:[r.name," ","(",r.sku,") - Stock:"," ",r.stock]},r.id)}function Nt(r){const[e]=r;return s.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-600",children:[s.jsx(lt,{className:"h-3 w-3"}),s.jsx("span",{children:e})]},e)}function yt(r){const[,e]=r;return e==="Fallas"}function kt(r){return s.jsx(tt,{value:r,children:r},r)}function St(r){return r.is_completed}function Ct(r,e){return r+(e.pivot.total_cost||0)}function wt(r,e){return r+(e.cost||0)}function Tt(r){return{...r,cost:r.cost?Number(r.cost):null}}export{sl as default};
