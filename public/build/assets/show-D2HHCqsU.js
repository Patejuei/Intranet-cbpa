import{c as ms,u as hs,j as s,H as fs}from"./app-Y3wPkO7k.js";import{B as cs}from"./badge-A8f5rW1Z.js";import{a as ps,B as me}from"./button-IaI-p2sT.js";import{C as ss,a as ts,b as ls,c as as}from"./card-DrCK2JXg.js";import{C as ns}from"./checkbox-DzK31TVD.js";import{I as is}from"./input-Ci3WR__e.js";import{L as he}from"./label-CIN9rteu.js";import{c as xs,S as us,a as _s,b as js,d as vs}from"./select-yIse2YFz.js";import{S as rs}from"./separator-D6hmsHdu.js";import{F as gs,A as bs,W as ks}from"./app-layout-LB7JlbCh.js";import{C as ys}from"./circle-check-Dd4x3c2F.js";import{P as Ns}from"./printer-D43ZnIcf.js";import{S as Ss}from"./save-D94ebxxy.js";import{C as ws}from"./calendar-DuOOf5wz.js";/* empty css            */import"./index-CxTk-NYF.js";import"./index-CwZq2zaV.js";import"./index-DHyoASyW.js";import"./check-CxauaCCR.js";import"./chevron-down-DRs0A40W.js";import"./index-C4J_hXM0.js";import"./shield-YzFc6gme.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Ts=ps("Trash2",Cs);function st(n){const e=ms.c(217),{maintenance:t}=n,os=t.status,Je=t.tentative_exit_date||"";let _e;e[0]!==t.tasks?(_e=t.tasks.map(Rs),e[0]=t.tasks,e[1]=_e):_e=e[1];const Ke=_e;let je;e[2]===Symbol.for("react.memo_cache_sentinel")?(je=[],e[2]=je):je=e[2];let ve;e[3]!==t.status||e[4]!==Je||e[5]!==Ke?(ve={status:os,tentative_exit_date:Je,tasks:Ke,resolved_issue_ids:je},e[3]=t.status,e[4]=Je,e[5]=Ke,e[6]=ve):ve=e[6];const{data:l,setData:a,put:d,processing:m}=hs(ve);let ge;e[7]===Symbol.for("react.memo_cache_sentinel")?(ge=["En Taller","Ingresado","Trabajando","En Espera de Repuestos","Pruebas Finales","Finalizado","Entregado"],e[7]=ge):ge=e[7];const ds=ge;let be;e[8]!==t.id||e[9]!==d?(be=c=>{c.preventDefault(),d(`/vehicles/workshop/${t.id}`)},e[8]=t.id,e[9]=d,e[10]=be):be=e[10];const fe=be;let ke;e[11]!==l.tasks||e[12]!==a?(ke=c=>{const r=[...l.tasks];r[c].is_completed=!r[c].is_completed,a("tasks",r)},e[11]=l.tasks,e[12]=a,e[13]=ke):ke=e[13];const k=ke;let ye;e[14]!==l.tasks||e[15]!==a?(ye=(c,r)=>{const o=[...l.tasks];o[c].cost=r?parseFloat(r):null,a("tasks",o)},e[14]=l.tasks,e[15]=a,e[16]=ye):ye=e[16];const y=ye;let Ne;e[17]!==l.tasks||e[18]!==a?(Ne=(c,r)=>{const o=[...l.tasks];o[c].description=r,a("tasks",o)},e[17]=l.tasks,e[18]=a,e[19]=Ne):Ne=e[19];const N=Ne;let Se;e[20]!==l.tasks||e[21]!==a?(Se=()=>{a("tasks",[...l.tasks,{description:"",is_completed:!1,cost:null}])},e[20]=l.tasks,e[21]=a,e[22]=Se):Se=e[22];const pe=Se;let we;e[23]!==l.tasks||e[24]!==a?(we=c=>{const r=l.tasks.filter((o,W)=>W!==c);a("tasks",r)},e[23]=l.tasks,e[24]=a,e[25]=we):we=e[25];const S=we;let Ce;e[26]!==l.resolved_issue_ids||e[27]!==a?(Ce=c=>{const r=l.resolved_issue_ids;r.includes(c)?a("resolved_issue_ids",r.filter(o=>o!==c)):a("resolved_issue_ids",[...r,c])},e[26]=l.resolved_issue_ids,e[27]=a,e[28]=Ce):Ce=e[28];const xe=Ce;let w,C,T,E,F,I,R,h,$,f,p,x,u,_,z,P,j,L,v,g,b;if(e[29]!==pe||e[30]!==l||e[31]!==fe||e[32]!==t.description||e[33]!==t.entry_date||e[34]!==t.id||e[35]!==t.issues||e[36]!==t.status||e[37]!==t.vehicle.company||e[38]!==t.vehicle.name||e[39]!==t.vehicle.plate||e[40]!==t.workshop_name||e[41]!==m||e[42]!==d||e[43]!==S||e[44]!==a||e[45]!==xe||e[46]!==k||e[47]!==y||e[48]!==N){const c=l.tasks.reduce(Is,0);let r;e[70]!==l.tasks?(r=l.tasks.filter(Fs),e[70]=l.tasks,e[71]=r):r=e[71];const o=r.length;T=bs;let W,Ee;e[72]===Symbol.for("react.memo_cache_sentinel")?(W={title:"Panel Principal",href:"/dashboard"},Ee={title:"Taller Mecánico",href:"/vehicles/workshop"},e[72]=W,e[73]=Ee):(W=e[72],Ee=e[73]);const Qe=`Orden #${t.id}`,Ue=`/vehicles/workshop/${t.id}`;e[74]!==Qe||e[75]!==Ue?(g=[W,Ee,{title:Qe,href:Ue}],e[74]=Qe,e[75]=Ue,e[76]=g):g=e[76];const Xe=`Orden de Trabajo #${t.id}`;e[77]!==Xe?(b=s.jsx(fs,{title:Xe}),e[77]=Xe,e[78]=b):b=e[78],L="mx-auto flex w-full max-w-7xl flex-col gap-6 p-4";let Fe;e[79]===Symbol.for("react.memo_cache_sentinel")?(Fe=s.jsx(ks,{className:"h-6 w-6"}),e[79]=Fe):Fe=e[79];let G;e[80]!==t.id?(G=s.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-bold",children:[Fe,"Orden de Trabajo #",t.id]}),e[80]=t.id,e[81]=G):G=e[81];let q;e[82]!==t.vehicle.company||e[83]!==t.vehicle.name||e[84]!==t.vehicle.plate?(q=s.jsxs("p",{className:"text-muted-foreground",children:[t.vehicle.name," -"," ",t.vehicle.plate," (",t.vehicle.company,")"]}),e[82]=t.vehicle.company,e[83]=t.vehicle.name,e[84]=t.vehicle.plate,e[85]=q):q=e[85];let J;e[86]!==G||e[87]!==q?(J=s.jsxs("div",{children:[G,q]}),e[86]=G,e[87]=q,e[88]=J):J=e[88];let K;e[89]!==t.id||e[90]!==t.status?(K=(t.status==="Finalizado"||t.status==="Entregado")&&s.jsx(me,{variant:"outline",asChild:!0,className:"border-green-600 text-green-600 hover:bg-green-50",children:s.jsxs("a",{href:`/vehicles/workshop/${t.id}/print-exit`,target:"_blank",rel:"noopener noreferrer",children:[s.jsx(gs,{className:"mr-2 h-4 w-4"}),"Imprimir Salida"]})}),e[89]=t.id,e[90]=t.status,e[91]=K):K=e[91];const Ye=`/vehicles/workshop/${t.id}/print`;let Ie;e[92]===Symbol.for("react.memo_cache_sentinel")?(Ie=s.jsx(Ns,{className:"mr-2 h-4 w-4"}),e[92]=Ie):Ie=e[92];let Q;e[93]!==Ye?(Q=s.jsx(me,{variant:"outline",asChild:!0,children:s.jsxs("a",{href:Ye,target:"_blank",rel:"noopener noreferrer",children:[Ie,"Imprimir Orden"]})}),e[93]=Ye,e[94]=Q):Q=e[94];let Re;e[95]===Symbol.for("react.memo_cache_sentinel")?(Re=s.jsx(Ss,{className:"mr-2 h-4 w-4"}),e[95]=Re):Re=e[95];let U;e[96]!==fe||e[97]!==m?(U=s.jsxs(me,{onClick:fe,disabled:m,children:[Re,"Guardar Cambios"]}),e[96]=fe,e[97]=m,e[98]=U):U=e[98];let X;e[99]!==l||e[100]!==t.id||e[101]!==t.status||e[102]!==m||e[103]!==d?(X=t.status!=="Finalizado"&&t.status!=="Entregado"&&s.jsxs(me,{variant:"destructive",onClick:()=>{confirm("¿Está seguro de finalizar el trabajo? Esto resolverá las incidencias marcadas y generará el documento de salida.")&&d(`/vehicles/workshop/${t.id}`,{data:{...l,status:"Finalizado"}})},disabled:m,children:[s.jsx(ys,{className:"mr-2 h-4 w-4"}),"Finalizar Trabajo"]}),e[99]=l,e[100]=t.id,e[101]=t.status,e[102]=m,e[103]=d,e[104]=X):X=e[104];let Y;e[105]!==K||e[106]!==Q||e[107]!==U||e[108]!==X?(Y=s.jsxs("div",{className:"flex gap-2",children:[K,Q,U,X]}),e[105]=K,e[106]=Q,e[107]=U,e[108]=X,e[109]=Y):Y=e[109],e[110]!==J||e[111]!==Y?(v=s.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[J,Y]}),e[110]=J,e[111]=Y,e[112]=v):v=e[112],P="grid grid-cols-1 gap-6 lg:grid-cols-3";let $e;e[113]===Symbol.for("react.memo_cache_sentinel")?($e=s.jsx(ss,{children:s.jsx(ts,{children:"Estado y Fechas"})}),e[113]=$e):$e=e[113];let ze;e[114]===Symbol.for("react.memo_cache_sentinel")?(ze=s.jsx(he,{children:"Estado Actual"}),e[114]=ze):ze=e[114];let Z;e[115]!==a?(Z=i=>a("status",i),e[115]=a,e[116]=Z):Z=e[116];let Pe;e[117]===Symbol.for("react.memo_cache_sentinel")?(Pe=s.jsx(_s,{children:s.jsx(js,{})}),e[117]=Pe):Pe=e[117];let Le;e[118]===Symbol.for("react.memo_cache_sentinel")?(Le=s.jsx(xs,{children:ds.map(Es)}),e[118]=Le):Le=e[118];let ee;e[119]!==l.status||e[120]!==Z?(ee=s.jsxs("div",{className:"space-y-2",children:[ze,s.jsxs(us,{value:l.status,onValueChange:Z,children:[Pe,Le]})]}),e[119]=l.status,e[120]=Z,e[121]=ee):ee=e[121];let Oe;e[122]===Symbol.for("react.memo_cache_sentinel")?(Oe=s.jsx(he,{children:"Fecha de Ingreso"}),e[122]=Oe):Oe=e[122];let Ae;e[123]===Symbol.for("react.memo_cache_sentinel")?(Ae=s.jsx(ws,{className:"h-4 w-4"}),e[123]=Ae):Ae=e[123];let se;e[124]!==t.entry_date?(se=s.jsxs("div",{className:"space-y-2",children:[Oe,s.jsxs("div",{className:"flex items-center gap-2 rounded border bg-muted/50 p-2 text-sm",children:[Ae,t.entry_date]})]}),e[124]=t.entry_date,e[125]=se):se=e[125];let De;e[126]===Symbol.for("react.memo_cache_sentinel")?(De=s.jsx(he,{children:"Fecha Tentativa Salida"}),e[126]=De):De=e[126];let te;e[127]!==a?(te=i=>a("tentative_exit_date",i.target.value),e[127]=a,e[128]=te):te=e[128];let le;e[129]!==l.tentative_exit_date||e[130]!==te?(le=s.jsxs("div",{className:"space-y-2",children:[De,s.jsx(is,{type:"date",value:l.tentative_exit_date,onChange:te})]}),e[129]=l.tentative_exit_date,e[130]=te,e[131]=le):le=e[131];let Me;e[132]===Symbol.for("react.memo_cache_sentinel")?(Me=s.jsx(rs,{}),e[132]=Me):Me=e[132];let Ve;e[133]===Symbol.for("react.memo_cache_sentinel")?(Ve=s.jsx(he,{children:"Taller / Proveedor"}),e[133]=Ve):Ve=e[133];let ae;e[134]!==t.workshop_name?(ae=s.jsxs("div",{className:"space-y-2",children:[Ve,s.jsx("p",{className:"font-medium",children:t.workshop_name})]}),e[134]=t.workshop_name,e[135]=ae):ae=e[135];let ie;e[136]!==ee||e[137]!==se||e[138]!==le||e[139]!==ae?(ie=s.jsxs(ls,{children:[$e,s.jsxs(as,{className:"space-y-4",children:[ee,se,le,Me,ae]})]}),e[136]=ee,e[137]=se,e[138]=le,e[139]=ae,e[140]=ie):ie=e[140];let Be;e[141]===Symbol.for("react.memo_cache_sentinel")?(Be=s.jsx(ss,{children:s.jsx(ts,{className:"text-base",children:"Incidencias Vinculadas"})}),e[141]=Be):Be=e[141];let re;e[142]!==l.resolved_issue_ids||e[143]!==t.issues||e[144]!==xe?(re=t.issues.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay incidencias vinculadas."}):t.issues.map(i=>s.jsxs("div",{className:"flex items-start gap-2 rounded border p-2",children:[s.jsx(ns,{checked:i.status==="Resolved"||l.resolved_issue_ids.includes(i.id),disabled:i.status==="Resolved",onCheckedChange:()=>xe(i.id)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium",children:i.description}),s.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-muted-foreground",children:i.date}),s.jsx(cs,{variant:i.status==="Resolved"||l.resolved_issue_ids.includes(i.id)?"default":"secondary",children:i.status==="Resolved"?"Resuelto":l.resolved_issue_ids.includes(i.id)?"Marcado para Resolver":"Pendiente"})]})]})]},i.id)),e[142]=l.resolved_issue_ids,e[143]=t.issues,e[144]=xe,e[145]=re):re=e[145];let ce;e[146]!==re?(ce=s.jsxs(ls,{children:[Be,s.jsx(as,{className:"space-y-3",children:re})]}),e[146]=re,e[147]=ce):ce=e[147],e[148]!==ie||e[149]!==ce?(j=s.jsxs("div",{className:"space-y-6 lg:col-span-1",children:[ie,ce]}),e[148]=ie,e[149]=ce,e[150]=j):j=e[150],z="space-y-6 lg:col-span-2",C=ls;let He;e[151]===Symbol.for("react.memo_cache_sentinel")?(He=s.jsx(ts,{children:"Lista de Trabajos y Costos"}),e[151]=He):He=e[151],e[152]!==o||e[153]!==l.tasks.length?(_=s.jsxs(ss,{className:"flex flex-row items-center justify-between",children:[He,s.jsxs(cs,{variant:"outline",className:"text-base",children:["Progreso: ",o," /"," ",l.tasks.length]})]}),e[152]=o,e[153]=l.tasks.length,e[154]=_):_=e[154],w=as,$="space-y-4";let We;e[155]===Symbol.for("react.memo_cache_sentinel")?(We=s.jsx(he,{children:"Descripción General / Observaciones"}),e[155]=We):We=e[155];const Ze=t.description||"Sin observaciones generales.";e[156]!==Ze?(f=s.jsxs("div",{className:"space-y-2",children:[We,s.jsx("p",{className:"min-h-[60px] rounded border bg-muted p-3 text-sm text-muted-foreground",children:Ze})]}),e[156]=Ze,e[157]=f):f=e[157],e[158]===Symbol.for("react.memo_cache_sentinel")?(p=s.jsx(rs,{}),e[158]=p):p=e[158];let Ge;e[159]===Symbol.for("react.memo_cache_sentinel")?(Ge=s.jsx(he,{className:"text-base font-semibold",children:"Tareas Específicas"}),e[159]=Ge):Ge=e[159];let ne;e[160]!==pe?(ne=s.jsxs("div",{className:"flex items-center justify-between",children:[Ge,s.jsx(me,{size:"sm",variant:"secondary",onClick:pe,type:"button",children:"+ Agregar Tarea"})]}),e[160]=pe,e[161]=ne):ne=e[161];let oe;e[162]!==l.tasks.length?(oe=l.tasks.length===0&&s.jsx("p",{className:"rounded border-2 border-dashed py-8 text-center text-muted-foreground",children:"No hay tareas registradas. Agrega una para comenzar el seguimiento."}),e[162]=l.tasks.length,e[163]=oe):oe=e[163];let de;if(e[164]!==l.tasks||e[165]!==S||e[166]!==k||e[167]!==y||e[168]!==N){let i;e[170]!==S||e[171]!==k||e[172]!==y||e[173]!==N?(i=(qe,ue)=>s.jsxs("div",{className:"flex flex-col items-start gap-3 rounded border bg-card p-3 transition-colors hover:bg-accent/5 md:flex-row md:items-center",children:[s.jsx(ns,{checked:qe.is_completed,onCheckedChange:()=>k(ue),className:"mt-1 md:mt-0"}),s.jsxs("div",{className:"w-full flex-1 space-y-2 md:flex md:gap-4 md:space-y-0",children:[s.jsx(is,{value:qe.description,onChange:es=>N(ue,es.target.value),placeholder:"Descripción de la tarea",className:qe.is_completed?"text-muted-foreground line-through":""}),s.jsxs("div",{className:"flex w-full items-center gap-2 md:w-32",children:[s.jsx("span",{className:"text-sm font-semibold text-muted-foreground",children:"$"}),s.jsx(is,{type:"number",value:qe.cost??"",onChange:es=>y(ue,es.target.value),placeholder:"Costo"})]})]}),s.jsx(me,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>S(ue),type:"button",children:s.jsx(Ts,{className:"h-4 w-4"})})]},ue),e[170]=S,e[171]=k,e[172]=y,e[173]=N,e[174]=i):i=e[174],de=l.tasks.map(i),e[164]=l.tasks,e[165]=S,e[166]=k,e[167]=y,e[168]=N,e[169]=de}else de=e[169];e[175]!==ne||e[176]!==oe||e[177]!==de?(x=s.jsxs("div",{className:"space-y-4",children:[ne,oe,de]}),e[175]=ne,e[176]=oe,e[177]=de,e[178]=x):x=e[178],e[179]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsx(rs,{}),e[179]=u):u=e[179],R="flex items-center justify-end gap-4 pt-2",e[180]===Symbol.for("react.memo_cache_sentinel")?(h=s.jsx("span",{className:"text-lg font-bold",children:"Costo Total Estimado:"}),e[180]=h):h=e[180],E="text-2xl font-bold text-primary",F="$",I=c.toLocaleString("es-CL"),e[29]=pe,e[30]=l,e[31]=fe,e[32]=t.description,e[33]=t.entry_date,e[34]=t.id,e[35]=t.issues,e[36]=t.status,e[37]=t.vehicle.company,e[38]=t.vehicle.name,e[39]=t.vehicle.plate,e[40]=t.workshop_name,e[41]=m,e[42]=d,e[43]=S,e[44]=a,e[45]=xe,e[46]=k,e[47]=y,e[48]=N,e[49]=w,e[50]=C,e[51]=T,e[52]=E,e[53]=F,e[54]=I,e[55]=R,e[56]=h,e[57]=$,e[58]=f,e[59]=p,e[60]=x,e[61]=u,e[62]=_,e[63]=z,e[64]=P,e[65]=j,e[66]=L,e[67]=v,e[68]=g,e[69]=b}else w=e[49],C=e[50],T=e[51],E=e[52],F=e[53],I=e[54],R=e[55],h=e[56],$=e[57],f=e[58],p=e[59],x=e[60],u=e[61],_=e[62],z=e[63],P=e[64],j=e[65],L=e[66],v=e[67],g=e[68],b=e[69];let O;e[181]!==E||e[182]!==F||e[183]!==I?(O=s.jsxs("span",{className:E,children:[F,I]}),e[181]=E,e[182]=F,e[183]=I,e[184]=O):O=e[184];let A;e[185]!==R||e[186]!==h||e[187]!==O?(A=s.jsxs("div",{className:R,children:[h,O]}),e[185]=R,e[186]=h,e[187]=O,e[188]=A):A=e[188];let D;e[189]!==w||e[190]!==$||e[191]!==f||e[192]!==p||e[193]!==x||e[194]!==u||e[195]!==A?(D=s.jsxs(w,{className:$,children:[f,p,x,u,A]}),e[189]=w,e[190]=$,e[191]=f,e[192]=p,e[193]=x,e[194]=u,e[195]=A,e[196]=D):D=e[196];let M;e[197]!==C||e[198]!==_||e[199]!==D?(M=s.jsxs(C,{children:[_,D]}),e[197]=C,e[198]=_,e[199]=D,e[200]=M):M=e[200];let V;e[201]!==z||e[202]!==M?(V=s.jsx("div",{className:z,children:M}),e[201]=z,e[202]=M,e[203]=V):V=e[203];let B;e[204]!==P||e[205]!==j||e[206]!==V?(B=s.jsxs("div",{className:P,children:[j,V]}),e[204]=P,e[205]=j,e[206]=V,e[207]=B):B=e[207];let H;e[208]!==L||e[209]!==v||e[210]!==B?(H=s.jsxs("div",{className:L,children:[v,B]}),e[208]=L,e[209]=v,e[210]=B,e[211]=H):H=e[211];let Te;return e[212]!==T||e[213]!==g||e[214]!==b||e[215]!==H?(Te=s.jsxs(T,{breadcrumbs:g,children:[b,H]}),e[212]=T,e[213]=g,e[214]=b,e[215]=H,e[216]=Te):Te=e[216],Te}function Es(n){return s.jsx(vs,{value:n,children:n},n)}function Fs(n){return n.is_completed}function Is(n,e){return n+(e.cost||0)}function Rs(n){return{...n,cost:n.cost?Number(n.cost):null}}export{st as default};
