import{c as Ee,b as Pe,u as Ve,j as s,H as Ae}from"./app-lrD-X_g2.js";import{C as Ue}from"./checkbox-QaA0FavS.js";import{S as De}from"./scroll-area-DWMidcHT.js";import{S as Ce,a as _e,b as Se,c as ke,d as $e}from"./select-CyJ-A37M.js";import{T as Fe,A as Be}from"./app-layout-B-w059ge.js";import{S as ze}from"./shield-DP_TgMF-.js";/* empty css            */import"./button-C30YfVAU.js";import"./index-D28iW8MQ.js";import"./index-BxHzOl0z.js";import"./index-zozu2mmz.js";import"./check-KNjNtnR0.js";import"./chevron-down-DC4OJ025.js";import"./index-C4J_hXM0.js";const Ge=["Primera Compañía","Segunda Compañía","Tercera Compañía","Cuarta Compañía","Quinta Compañía","Sexta Compañía","Séptima Compañía","Octava Compañía","Novena Compañía","Décima Compañía","Brigada Juvenil","Comandancia"],qe=[{id:"inventory",label:"Inventario",category:"Material Menor"},{id:"tickets",label:"Ticketera",category:"Material Menor"},{id:"batteries",label:"Baterías",category:"Material Menor"},{id:"equipment",label:"Material Menor (General)",category:"Material Menor"},{id:"deliveries",label:"Actas de Entrega",category:"Material Menor"},{id:"reception",label:"Actas de Recepción",category:"Material Menor"},{id:"vehicles",label:"Material Mayor (General)",category:"Material Mayor"},{id:"vehicles.incidents",label:"M. Mayor - Incidencias",category:"Material Mayor"},{id:"vehicles.checklist",label:"M. Mayor - Checklist",category:"Material Mayor"},{id:"vehicles.logs",label:"M. Mayor - Bitácora",category:"Material Mayor"},{id:"vehicles.workshop",label:"M. Mayor - Taller",category:"Material Mayor"},{id:"vehicles.inventory",label:"M. Mayor - Inventario",category:"Material Mayor"},{id:"firefighters",label:"Bomberos",category:"Administración"}],He=["Material Menor","Material Mayor","Administración"],We=n=>{const e=[{value:"user",label:"Usuario Estándar"},{value:"admin",label:"Administrador del Sistema"},{value:"capitan",label:"Capitán"},{value:"teniente",label:"Teniente"},{value:"maquinista",label:"Maquinista"},{value:"ayudante",label:"Ayudante"},{value:"comandancia",label:"Comandancia"},{value:"cuartelero",label:"Cuartelero"},{value:"mechanic",label:"Taller Mecánico"}];if(n==="capitan"){const c=["user","teniente","maquinista","ayudante"];return e.filter(I=>c.includes(I.value))}return e},Je=n=>{if(n==="capitan"){const e=["vehicles.inventory","vehicles.workshop","firefighters","vehicles","equipment"];return qe.filter(c=>!e.includes(c.id))}return qe};function ms(n){const e=Ee.c(142),{availableVehicles:c}=n,I=Pe().props.auth.user,b=I?.role||"user",ge=b==="capitan"&&I.company||"";let ee;e[0]===Symbol.for("react.memo_cache_sentinel")?(ee=[],e[0]=ee):ee=e[0];let se;e[1]===Symbol.for("react.memo_cache_sentinel")?(se=[],e[1]=se):se=e[1];let te;e[2]!==ge?(te={name:"",email:"",password:"",company:ge,role:"user",permissions:ee,driver_vehicles:se},e[2]=ge,e[3]=te):te=e[3];const{data:t,setData:a,post:Z,processing:ve,errors:r}=Ve(te);let g,v,y,d,j,u,N,p,f,M,x,h,w,C;if(e[4]!==b||e[5]!==t.company||e[6]!==t.driver_vehicles||e[7]!==t.email||e[8]!==t.name||e[9]!==t.password||e[10]!==t.permissions||e[11]!==t.role||e[12]!==r.company||e[13]!==r.email||e[14]!==r.name||e[15]!==r.password||e[16]!==Z||e[17]!==a){const m=We(b),Ne=Je(b);let le;e[32]!==t.driver_vehicles||e[33]!==a?(le=i=>{const l=t.driver_vehicles;l.includes(i)?a("driver_vehicles",l.filter(o=>o!==i)):a("driver_vehicles",[...l,i])},e[32]=t.driver_vehicles,e[33]=a,e[34]=le):le=e[34],v=le;let ae;e[35]!==Z?(ae=i=>{i.preventDefault(),Z("/admin/users")},e[35]=Z,e[36]=ae):ae=e[36];const Re=ae;let re;e[37]!==t.permissions||e[38]!==a?(re=(i,l)=>{const o=t.permissions.filter(we=>!we.startsWith(`${i}.`));l==="view"?o.push(`${i}.view`):l==="edit"?o.push(`${i}.view`,`${i}.edit`):l==="full"&&o.push(`${i}.view`,`${i}.edit`,`${i}.full`),["inventory","deliveries","reception"].includes(i)&&l!=="none"&&!o.some(Ke)&&(o.some(Qe)||o.push("equipment.view")),a("permissions",o)},e[37]=t.permissions,e[38]=a,e[39]=re):re=e[39];const ne=re;let oe;e[40]!==t.permissions?(oe=i=>{const l=t.permissions.includes(`${i}.full`),o=t.permissions.includes(`${i}.edit`),Me=t.permissions.includes(`${i}.view`);return l?"full":o?"edit":Me?"view":"none"},e[40]=t.permissions,e[41]=oe):oe=e[41];const ce=oe;g=Be,e[42]===Symbol.for("react.memo_cache_sentinel")?(p=[{title:"Panel Principal",href:"/dashboard"},{title:"Usuarios",href:"/admin/users"},{title:"Nuevo Usuario",href:"/admin/users/create"}],f=s.jsx(Ae,{title:"Crear Usuario"}),e[42]=p,e[43]=f):(p=e[42],f=e[43]),N="flex flex-col gap-6 p-4",j="max-w-4xl rounded-xl border bg-card p-6 shadow-sm",e[44]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Crear Nuevo Usuario"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete los detalles para registrar un nuevo usuario en el sistema."})]}),e[44]=u):u=e[44],C=Re,y="space-y-6";let me;e[45]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Nombre Completo"}),e[45]=me):me=e[45];let T;e[46]!==a?(T=i=>a("name",i.target.value),e[46]=a,e[47]=T):T=e[47];let E;e[48]!==t.name||e[49]!==T?(E=s.jsx("input",{type:"text",value:t.name,onChange:T,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[48]=t.name,e[49]=T,e[50]=E):E=e[50];let P;e[51]!==r.name?(P=r.name&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.name}),e[51]=r.name,e[52]=P):P=e[52];let V;e[53]!==E||e[54]!==P?(V=s.jsxs("div",{children:[me,E,P]}),e[53]=E,e[54]=P,e[55]=V):V=e[55];let de;e[56]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Correo Electrónico"}),e[56]=de):de=e[56];let A;e[57]!==a?(A=i=>a("email",i.target.value),e[57]=a,e[58]=A):A=e[58];let U;e[59]!==t.email||e[60]!==A?(U=s.jsx("input",{type:"email",value:t.email,onChange:A,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[59]=t.email,e[60]=A,e[61]=U):U=e[61];let D;e[62]!==r.email?(D=r.email&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.email}),e[62]=r.email,e[63]=D):D=e[63];let F;e[64]!==U||e[65]!==D?(F=s.jsxs("div",{children:[de,U,D]}),e[64]=U,e[65]=D,e[66]=F):F=e[66];let B;e[67]!==V||e[68]!==F?(B=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[V,F]}),e[67]=V,e[68]=F,e[69]=B):B=e[69];let ue;e[70]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Contraseña"}),e[70]=ue):ue=e[70];let z;e[71]!==a?(z=i=>a("password",i.target.value),e[71]=a,e[72]=z):z=e[72];let G;e[73]!==t.password||e[74]!==z?(G=s.jsx("input",{type:"password",value:t.password,onChange:z,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[73]=t.password,e[74]=z,e[75]=G):G=e[75];let H;e[76]!==r.password?(H=r.password&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.password}),e[76]=r.password,e[77]=H):H=e[77];let W;e[78]!==G||e[79]!==H?(W=s.jsxs("div",{children:[ue,G,H]}),e[78]=G,e[79]=H,e[80]=W):W=e[80];let pe;e[81]===Symbol.for("react.memo_cache_sentinel")?(pe=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Compañía"}),e[81]=pe):pe=e[81];let J;e[82]!==a?(J=i=>a("company",i),e[82]=a,e[83]=J):J=e[83];const ye=b==="capitan";let fe;e[84]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsx(_e,{className:"w-full",children:s.jsx(Se,{placeholder:"Seleccione una Compañía"})}),e[84]=fe):fe=e[84];let xe;e[85]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx(ke,{children:Ge.map(Oe)}),e[85]=xe):xe=e[85];let L;e[86]!==t.company||e[87]!==J||e[88]!==ye?(L=s.jsxs(Ce,{value:t.company,onValueChange:J,disabled:ye,children:[fe,xe]}),e[86]=t.company,e[87]=J,e[88]=ye,e[89]=L):L=e[89];let O;e[90]!==r.company?(O=r.company&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.company}),e[90]=r.company,e[91]=O):O=e[91];let Q;e[92]!==L||e[93]!==O?(Q=s.jsxs("div",{children:[pe,L,O]}),e[92]=L,e[93]=O,e[94]=Q):Q=e[94];let K;e[95]!==W||e[96]!==Q?(K=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[W,Q]}),e[95]=W,e[96]=Q,e[97]=K):K=e[97],e[98]!==B||e[99]!==K?(d=s.jsxs("div",{className:"space-y-4",children:[B,K]}),e[98]=B,e[99]=K,e[100]=d):d=e[100],M="rounded-lg border p-4",e[101]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(ze,{className:"size-4"})," Roles y Permisos"]}),e[101]=x):x=e[101];let he;e[102]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Rol del Sistema"}),e[102]=he):he=e[102];const Te=t.role;let X;e[103]!==a?(X=i=>a("role",i),e[103]=a,e[104]=X):X=e[104];let be;e[105]===Symbol.for("react.memo_cache_sentinel")?(be=s.jsx(_e,{className:"w-full",children:s.jsx(Se,{placeholder:"Seleccione un Rol"})}),e[105]=be):be=e[105];const je=m.map(Le);let Y;e[106]!==je?(Y=s.jsx(ke,{children:je}),e[106]=je,e[107]=Y):Y=e[107],e[108]!==t.role||e[109]!==X||e[110]!==Y?(h=s.jsxs("div",{className:"mb-6",children:[he,s.jsxs(Ce,{value:Te,onValueChange:X,children:[be,Y]})]}),e[108]=t.role,e[109]=X,e[110]=Y,e[111]=h):h=e[111],w=t.role!=="admin"&&t.role!=="capitan"&&t.role!=="maquinista"&&s.jsxs("div",{children:[s.jsx("label",{className:"mb-3 block text-sm font-medium",children:"Permisos por Módulo"}),s.jsx("div",{className:"space-y-6",children:He.map(i=>Ne.some(l=>l.category===i)&&s.jsxs("div",{className:"rounded-md border p-3",children:[s.jsx("h4",{className:"mb-2 text-sm font-semibold text-foreground",children:i}),s.jsx("table",{className:"w-full text-sm",children:s.jsx("tbody",{className:"divide-y",children:Ne.filter(l=>l.category===i).map(l=>s.jsxs("tr",{children:[s.jsx("td",{className:"w-1/3 py-2.5 font-medium",children:l.label}),s.jsx("td",{className:"py-2",children:s.jsxs("div",{className:"flex gap-1 rounded-md bg-muted/50 p-1",children:[s.jsx("button",{type:"button",onClick:()=>ne(l.id,"none"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(l.id)==="none"?"bg-background shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ninguno"}),s.jsx("button",{type:"button",onClick:()=>ne(l.id,"view"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(l.id)==="view"?"bg-blue-100 text-blue-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ver"}),s.jsx("button",{type:"button",onClick:()=>ne(l.id,"edit"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(l.id)==="edit"?"bg-green-100 text-green-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Editar"}),(l.id==="vehicles"||l.id==="equipment")&&s.jsx("button",{type:"button",onClick:()=>ne(l.id,"full"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${ce(l.id)==="full"?"bg-purple-100 text-purple-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Total"})]})})]},l.id))})})]},i))}),s.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"'Editar' incluye permisos de 'Ver'."})]}),e[4]=b,e[5]=t.company,e[6]=t.driver_vehicles,e[7]=t.email,e[8]=t.name,e[9]=t.password,e[10]=t.permissions,e[11]=t.role,e[12]=r.company,e[13]=r.email,e[14]=r.name,e[15]=r.password,e[16]=Z,e[17]=a,e[18]=g,e[19]=v,e[20]=y,e[21]=d,e[22]=j,e[23]=u,e[24]=N,e[25]=p,e[26]=f,e[27]=M,e[28]=x,e[29]=h,e[30]=w,e[31]=C}else g=e[18],v=e[19],y=e[20],d=e[21],j=e[22],u=e[23],N=e[24],p=e[25],f=e[26],M=e[27],x=e[28],h=e[29],w=e[30],C=e[31];let _;e[112]!==M||e[113]!==x||e[114]!==h||e[115]!==w?(_=s.jsxs("div",{className:M,children:[x,h,w]}),e[112]=M,e[113]=x,e[114]=h,e[115]=w,e[116]=_):_=e[116];let S;e[117]!==c||e[118]!==t.driver_vehicles||e[119]!==v?(S=c&&c.length>0&&s.jsxs("div",{className:"rounded-lg border p-4",children:[s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(Fe,{className:"size-4"})," Vehículos Permitidos (Maquinistas)"]}),s.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Seleccione los vehículos que este usuario está autorizado a conducir y registrar en bitácora."}),s.jsx(De,{className:"h-[200px] w-full rounded-md border p-4",children:s.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:c.map(m=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ue,{id:`v-${m.id}`,checked:t.driver_vehicles.includes(m.id),onCheckedChange:()=>v(m.id)}),s.jsxs("label",{htmlFor:`v-${m.id}`,className:"text-sm leading-none font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[m.name," ",s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",m.company,")"]})]})]},m.id))})})]}),e[117]=c,e[118]=t.driver_vehicles,e[119]=v,e[120]=S):S=e[120];let k;e[121]!==ve?(k=s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{type:"submit",disabled:ve,className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-8 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90 focus-visible:ring-2 focus-visible:ring-primary focus-visible:outline-none disabled:opacity-50",children:"Registrar Usuario"})}),e[121]=ve,e[122]=k):k=e[122];let q;e[123]!==y||e[124]!==d||e[125]!==_||e[126]!==S||e[127]!==k||e[128]!==C?(q=s.jsxs("form",{onSubmit:C,className:y,children:[d,_,S,k]}),e[123]=y,e[124]=d,e[125]=_,e[126]=S,e[127]=k,e[128]=C,e[129]=q):q=e[129];let $;e[130]!==j||e[131]!==u||e[132]!==q?($=s.jsxs("div",{className:j,children:[u,q]}),e[130]=j,e[131]=u,e[132]=q,e[133]=$):$=e[133];let R;e[134]!==N||e[135]!==$?(R=s.jsx("div",{className:N,children:$}),e[134]=N,e[135]=$,e[136]=R):R=e[136];let ie;return e[137]!==g||e[138]!==p||e[139]!==f||e[140]!==R?(ie=s.jsxs(g,{breadcrumbs:p,children:[f,R]}),e[137]=g,e[138]=p,e[139]=f,e[140]=R,e[141]=ie):ie=e[141],ie}function Le(n){return s.jsx($e,{value:n.value,children:n.label},n.value)}function Oe(n){return s.jsx($e,{value:n,children:n},n)}function Qe(n){return n.startsWith("equipment.")}function Ke(n){return n==="equipment.view"||n==="equipment.edit"||n==="equipment.full"}export{ms as default};
