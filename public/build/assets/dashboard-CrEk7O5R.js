import{c as be,r as me,b as Ne,j as s,L as a,H as ve}from"./app-BHG2hm5T.js";import{R as ye,B as we,M as he,A as ke}from"./app-layout-hnxNyFOA.js";import{f as E}from"./button-Z6kmdew5.js";import{C as Se}from"./clock-Dno-sm53.js";/* empty css            */import"./index-KJ8nIQ1N.js";import"./index-DM6PgUW3.js";import"./index-q7GIQJN5.js";import"./shield-Nszra4Fu.js";const Me=[{title:"Panel Principal",href:"/dashboard"}],_e="recent_modules";function Ge(t){const e=be.c(68),{upcomingBatteries:k,pendingTickets:n,respondedTickets:C,vehiclesStopped:T,pendingIncidents:z,vehiclesInWorkshop:$,expiringDocuments:xe,pendingPettyCash:I,criticalStockItems:P}=t;let R;e[0]!==k?(R=k===void 0?[]:k,e[0]=k,e[1]=R):R=e[1];const D=R;let q;e[2]!==n?(q=n===void 0?[]:n,e[2]=n,e[3]=q):q=e[3];const L=q;let V;e[4]!==C?(V=C===void 0?[]:C,e[4]=C,e[5]=V):V=e[5];const B=V;let A;e[6]!==T?(A=T===void 0?[]:T,e[6]=T,e[7]=A):A=e[7];const O=A;let W;e[8]!==z?(W=z===void 0?[]:z,e[8]=z,e[9]=W):W=e[9];const F=W;let K;e[10]!==$?(K=$===void 0?[]:$,e[10]=$,e[11]=K):K=e[11];const U=K,H=xe===void 0?[]:xe;let J;e[12]!==I?(J=I===void 0?[]:I,e[12]=I,e[13]=J):J=e[13];const Y=J;let G;e[14]!==P?(G=P===void 0?[]:P,e[14]=P,e[15]=G):G=e[15];const S=G;let Q;e[16]===Symbol.for("react.memo_cache_sentinel")?(Q=[],e[16]=Q):Q=e[16];const[X,pe]=me.useState(Q),[ae,fe]=me.useState(!1),{auth:d}=Ne().props;let Z;e[17]!==d.user?(Z=r=>{const l=d.user;if(!l)return!1;if(l.role==="admin"||l.role==="capitan"||l.role==="comandante"||r.permission==="vehicles"&&["cuartelero","mechanic"].includes(l.role||""))return!0;if(l.role==="inspector"){const ue=(l.department||"").trim(),de=r.permission;if(ue==="Material Mayor"){if(["vehicles.status","vehicles.incidents","vehicles.inventory","vehicles.logs","vehicles.workshop","vehicles.checklist","vehicles"].some(_=>_===de||_.startsWith(de+".")))return!0}else if(ue==="Material Menor"&&["inventory","tickets","batteries","deliveries","reception","equipment"].some(_=>_===de||_.startsWith(de+".")))return!0}const M=l.permissions||[],w=r.permission;return M.includes(w)||M.includes(`${w}.view`)||M.includes(`${w}.edit`)},e[17]=d.user,e[18]=Z):Z=e[18];const i=Z;let ee;e[19]!==i?(ee=()=>{try{const r=localStorage.getItem(_e);if(r){const M=JSON.parse(r).map(Be).filter(w=>!!w&&i(w));pe(M)}}catch(r){console.error("Error loading recent modules",r)}},e[19]=i,e[20]=ee):ee=e[20];let se;e[21]!==d.user?(se=[d.user],e[21]=d.user,e[22]=se):se=e[22],me.useEffect(ee,se);const ne=Ve,ie=ke,ce=Me;let c;e[23]===Symbol.for("react.memo_cache_sentinel")?(c=s.jsx(ve,{title:"Material Menor - CBPA"}),e[23]=c):c=e[23];const je="flex flex-1 flex-col gap-8 p-4";let o;e[24]!==S?(o=S&&S.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-red-600 bg-red-50 p-6 shadow-sm dark:bg-red-950/10",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold text-red-700 dark:text-red-500",children:[s.jsx("span",{className:"flex size-3 animate-pulse rounded-full bg-red-600 dark:bg-red-500"}),"Stock Crítico en Taller"]}),s.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:"Los siguientes ítems tienen stock bajo o nulo."})]}),s.jsx("div",{className:"space-y-2",children:S.map(Le)})]}),e[24]=S,e[25]=o):o=e[25];let m;e[26]!==Y?(m=Y.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-blue-600 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx(ye,{className:"size-5 text-blue-600"}),"Rendiciones de Caja Chica"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Solicitudes pendientes de visación o aprobación."})]}),s.jsx("div",{className:"space-y-3",children:Y.map(qe)})]}),e[26]=Y,e[27]=m):m=e[27];let x;e[28]!==L?(x=L.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-yellow-500 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 rounded-full bg-yellow-500"}),"Tickets Pendientes"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Solicitudes que requieren atención."})]}),s.jsx("div",{className:"space-y-3",children:L.map(De)})]}),e[28]=L,e[29]=x):x=e[29];let u;e[30]!==B?(u=B.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-blue-500 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 rounded-full bg-blue-500"}),"Tickets en Proceso"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Solicitudes con respuesta de Comandancia."})]}),s.jsx("div",{className:"space-y-3",children:B.map(Re)})]}),e[30]=B,e[31]=u):u=e[31];let h;e[32]!==O?(h=O.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-red-500 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 rounded-full bg-red-500"}),"Material Fuera de Servicio"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehículos detenidos o en taller."})]}),s.jsx("div",{className:"space-y-3",children:O.map(Pe)})]}),e[32]=O,e[33]=h):h=e[33];let p;e[34]!==F?(p=F.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-orange-500 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 rounded-full bg-orange-500"}),"Incidencias Pendientes"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Novedades reportadas sin resolver."})]}),s.jsx("div",{className:"space-y-3",children:F.map(Ie)})]}),e[34]=F,e[35]=p):p=e[35];let f;e[36]!==h||e[37]!==p?(f=s.jsxs("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2",children:[h,p]}),e[36]=h,e[37]=p,e[38]=f):f=e[38];let j;e[39]!==U?(j=U.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-yellow-600 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 rounded-full bg-yellow-600"}),"Unidades en Taller"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehículos con orden de trabajo activa."})]}),s.jsx("div",{className:"space-y-3",children:U.map($e)})]}),e[39]=U,e[40]=j):j=e[40];const oe=H.length>0&&(d.user.role==="capitan"||d.user.role==="maquinista"||d.user.role==="comandante"||d.user.role==="inspector"&&d.user.department==="Material Mayor")&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-red-600 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 animate-pulse rounded-full bg-red-600"}),"Vencimiento de Documentación"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehículos con documentación próxima a vencer o vencida."})]}),s.jsx("div",{className:"space-y-3",children:H.slice(0,ae?void 0:5).map(Te)}),H.length>5&&s.jsx("div",{className:"mt-4 text-center",children:s.jsx("button",{onClick:()=>fe(!ae),className:"text-sm font-medium text-primary hover:underline",children:ae?"Ver menos":`Ver más (${H.length-5} restantes)`})})]});let g;e[41]!==ne||e[42]!==D?(g=D.length>0&&s.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[s.jsx("div",{className:"rounded-lg bg-primary/10 p-3 text-primary",children:s.jsx(we,{className:"size-6"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:"Próximos Cambios de Baterías"}),s.jsx("p",{className:"text-muted-foreground",children:"Equipos que requieren atención pronto"})]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b text-left font-medium text-muted-foreground",children:[s.jsx("th",{className:"pb-2",children:"Fecha"}),s.jsx("th",{className:"pb-2",children:"Días"}),s.jsx("th",{className:"pb-2",children:"Equipo"}),s.jsx("th",{className:"pb-2",children:"Responsable"}),s.jsx("th",{className:"pb-2",children:"Compañía"})]})}),s.jsx("tbody",{className:"divide-y",children:D.map(r=>{const l=ne(r.next_change_date);return s.jsxs("tr",{children:[s.jsx("td",{className:"py-3",children:E(r.next_change_date)}),s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:`rounded px-2 py-1 font-bold ${l<=3?"bg-destructive/20 text-destructive":"bg-muted text-muted-foreground"}`,children:[l," días"]})}),s.jsx("td",{className:"py-3",children:r.equipment_type}),s.jsx("td",{className:"py-3",children:r.responsible_name}),s.jsx("td",{className:"py-3",children:r.company})]},r.id)})})]})})]}),e[41]=ne,e[42]=D,e[43]=g):g=e[43];let b;e[44]!==X?(b=X.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(Se,{className:"size-4"}),s.jsx("h2",{className:"text-sm font-medium tracking-wider uppercase",children:"Visitados Recientemente"})]}),s.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:X.map(Ce)})]}),e[44]=X,e[45]=b):b=e[45];let te;e[46]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx("h2",{className:"text-sm font-medium tracking-wider text-muted-foreground uppercase",children:"Todos los Módulos"}),e[46]=te):te=e[46];let N;e[47]!==i?(N=he.filter(Ee).map(r=>{if(!i(r))return null;const l=r.icon;return s.jsx(a,{href:r.href,className:"group relative overflow-hidden rounded-xl border bg-card p-6 shadow-sm transition-all hover:border-primary hover:shadow-md",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"rounded-lg bg-primary/10 p-3 text-primary transition-colors group-hover:bg-primary group-hover:text-primary-foreground",children:s.jsx(l,{className:"size-6"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold",children:r.title}),s.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]})]})},r.key)}),e[47]=i,e[48]=N):N=e[48];let v;e[49]!==N?(v=s.jsxs("div",{className:"space-y-4",children:[te,s.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3",children:N})]}),e[49]=N,e[50]=v):v=e[50];let re;e[51]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsxs("div",{className:"rounded-xl border bg-muted/40 p-6",children:[s.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Bienvenido al Sistema de Material Menor"}),s.jsx("p",{className:"text-muted-foreground",children:"Seleccione una opción de arriba para comenzar sus operaciones."})]}),e[51]=re):re=e[51];let y;e[52]!==o||e[53]!==m||e[54]!==x||e[55]!==u||e[56]!==f||e[57]!==j||e[58]!==oe||e[59]!==g||e[60]!==b||e[61]!==v?(y=s.jsxs("div",{className:je,children:[o,m,x,u,f,j,oe,g,b,v,re]}),e[52]=o,e[53]=m,e[54]=x,e[55]=u,e[56]=f,e[57]=j,e[58]=oe,e[59]=g,e[60]=b,e[61]=v,e[62]=y):y=e[62];let le;return e[63]!==ie||e[64]!==ce||e[65]!==c||e[66]!==y?(le=s.jsxs(ie,{breadcrumbs:ce,children:[c,y]}),e[63]=ie,e[64]=ce,e[65]=c,e[66]=y,e[67]=le):le=e[67],le}function Ee(t){return!t.key.startsWith("admin-")}function Ce(t){const e=t.icon;return s.jsxs(a,{href:t.href,className:"group relative flex items-center gap-3 overflow-hidden rounded-lg border bg-card p-4 shadow-sm transition-all hover:border-primary hover:shadow-md",children:[s.jsx("div",{className:"rounded-md bg-primary/10 p-2 text-primary transition-colors group-hover:bg-primary group-hover:text-primary-foreground",children:s.jsx(e,{className:"size-5"})}),s.jsx("div",{children:s.jsx("h3",{className:"leading-none font-medium",children:t.title})})]},t.key)}function Te(t){return s.jsx(a,{href:`/vehicles/status/${t.id}`,className:"block",children:s.jsxs("div",{className:"flex flex-col gap-2 rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"font-bold",children:t.name}),s.jsx("span",{className:"text-xs text-muted-foreground",children:t.company})]}),s.jsx("div",{className:"flex flex-col gap-1",children:t.alerts.map(ze)})]})},t.id)}function ze(t,e){return s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{children:t.label}),s.jsxs("span",{className:`font-medium ${t.status==="danger"?"text-red-600":"text-orange-600"}`,children:[t.date," ","(",t.days," ","días)"]})]},e)}function $e(t){const e=t.maintenances?.[0];return s.jsx(a,{href:`/vehicles/status/${t.id}`,className:"block",children:s.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"font-bold",children:t.name}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.company,")"]})]}),e?s.jsxs("p",{className:"text-xs font-medium text-yellow-700",children:[e.workshop_name," ","-"," ",e.description]}):s.jsx("p",{className:"text-xs text-muted-foreground",children:"Sin detalles de orden."})]}),e?.entry_date&&s.jsxs("div",{className:"flex items-center gap-1 font-mono text-xs text-muted-foreground",children:["Ingreso:"," ",E(e.entry_date)]})]})},t.id)}function Ie(t){return s.jsx(a,{href:"/vehicles/incidents",className:"block",children:s.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"line-clamp-1 font-medium",children:[t.vehicle.name," -"," ",t.description]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Reportado:"," ",E(t.created_at)]})]}),s.jsx("div",{className:"rounded bg-orange-100 px-2 py-1 text-xs text-orange-700",children:t.severity})]})},t.id)}function Pe(t){return s.jsx(a,{href:`/vehicles/status/${t.id}`,className:"block",children:s.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:t.name}),s.jsx("p",{className:"text-xs text-muted-foreground",children:t.company})]}),s.jsx("div",{className:`rounded px-2 py-1 text-xs font-medium ${t.status==="Out of Service"?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"}`,children:t.status==="Out of Service"?"Fuera de Servicio":"En Taller"})]})},t.id)}function Re(t){return s.jsx(a,{href:`/tickets/${t.id}`,className:"block",children:s.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:t.subject}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Estado: ",t.status]})]}),s.jsx("div",{className:"rounded bg-blue-100 px-2 py-1 text-xs text-blue-700",children:"Ver Respuesta"})]})},t.id)}function De(t){return s.jsx(a,{href:`/tickets/${t.id}`,className:"block",children:s.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:t.subject}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.user.company," -"," ",t.user.name]})]}),s.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:E(t.created_at)})]})},t.id)}function qe(t){return s.jsx(a,{href:`/vehicles/petty-cash/${t.id}`,className:"block",children:s.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:t.user.name}),s.jsx("p",{className:"text-xs text-muted-foreground",children:t.description||"Sin descripción"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"font-bold text-blue-700",children:new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(t.amount)}),s.jsx("div",{className:"text-xs text-muted-foreground",children:E(t.created_at)})]})]})},t.id)}function Le(t){return s.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-red-200 bg-white p-3 dark:border-red-900/50 dark:bg-red-950/20",children:[s.jsx("span",{className:"font-medium",children:t.name}),s.jsxs("span",{className:"rounded bg-red-100 px-2 py-1 text-xs font-bold text-red-700 dark:bg-red-900/40 dark:text-red-300",children:["Stock: ",t.stock," / Min:"," ",t.min_stock]})]},t.id)}function Ve(t){const e=new Date,n=new Date(t).getTime()-e.getTime();return Math.ceil(n/864e5)}function Be(t){return he.find(e=>e.key===t)}export{Ge as default};
