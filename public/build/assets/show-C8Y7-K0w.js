import{c as Ct,u as Tt,r as at,b as It,j as s,a as it,H as Et,L as Rt}from"./app-B61HxmhB.js";import{B as rt}from"./badge-vEvJTU3_.js";import{B as h,f as dt}from"./button-DEfvv7zK.js";import{C as he,c as fe,b as xe,a as pe}from"./card-BSIOn_Bx.js";import{C as mt}from"./checkbox-2mot1yDm.js";import{b as Ft,D as Dt,a as Lt,f as Pt,c as $t,d as zt}from"./dialog-DI1taw1X.js";import{I as ue}from"./input-BEDlWVnt.js";import{L as c}from"./label-CID0YnKh.js";import{c as ht,S as ft,a as xt,b as pt,d as jt}from"./select-C57hq6k-.js";import{S as nt}from"./separator-B21chosu.js";import{u as At}from"./use-permissions-CjVjEqdZ.js";import{F as Ot,A as qt,W as Bt}from"./app-layout-B6JJyxYC.js";import{C as _t}from"./circle-check-BxRBnB_T.js";import{P as Vt}from"./plus-DEtsulu_.js";import{T as ut}from"./trash-2-CL32XC1e.js";import{A as Wt}from"./arrow-left-Cw0gj5yu.js";import{P as Ht}from"./printer-BCRLKViT.js";import{S as Mt}from"./save-BILNXaPm.js";import{C as Ut}from"./calendar-DU6Z3J6d.js";/* empty css            */import"./index-DnuNE2iH.js";import"./index-BDoUajTH.js";import"./index-0lwPlNm7.js";import"./check-CNavjS5x.js";import"./index-q7GIQJN5.js";import"./shield-BxyVENHa.js";function Cl(n){const e=Ct.c(254),{maintenance:t,inventoryItems:Cs}=n,vt=t.status;let x;e[0]!==t.tentative_exit_date?(x=t.tentative_exit_date?t.tentative_exit_date.split("T")[0]:"",e[0]=t.tentative_exit_date,e[1]=x):x=e[1];let je;e[2]!==t.tasks?(je=t.tasks.map(el),e[2]=t.tasks,e[3]=je):je=e[3];const Ts=je;let _e;e[4]===Symbol.for("react.memo_cache_sentinel")?(_e=[],e[4]=_e):_e=e[4];const Is=t.withdrawal_responsible_name||"",Es=t.withdrawal_responsible_rut||"";let ve;e[5]!==t.status||e[6]!==x||e[7]!==Ts||e[8]!==Is||e[9]!==Es?(ve={status:vt,tentative_exit_date:x,tasks:Ts,resolved_issue_ids:_e,withdrawal_responsible_name:Is,withdrawal_responsible_rut:Es},e[5]=t.status,e[6]=x,e[7]=Ts,e[8]=Is,e[9]=Es,e[10]=ve):ve=e[10];const{data:a,setData:r,put:Rs,processing:p}=Tt(ve),[Fs,ge]=at.useState(!1);let be;e[11]===Symbol.for("react.memo_cache_sentinel")?(be={inventory_item_id:"",quantity:1},e[11]=be):be=e[11];const[d,Ds]=at.useState(be),[Ls,Ps]=at.useState(!1);let Ne;e[12]===Symbol.for("react.memo_cache_sentinel")?(Ne=["En Taller","Ingresado","Trabajando","En Espera de Repuestos","Pruebas Finales","Finalizado","Entregado"],e[12]=Ne):Ne=e[12];const gt=Ne;let ye;e[13]!==t.id||e[14]!==Rs?(ye=l=>{l.preventDefault(),Rs(`/vehicles/workshop/${t.id}`)},e[13]=t.id,e[14]=Rs,e[15]=ye):ye=e[15];const $s=ye;let ke;e[16]!==a.tasks||e[17]!==r?(ke=l=>{const o=[...a.tasks];o[l].is_completed=!o[l].is_completed,r("tasks",o)},e[16]=a.tasks,e[17]=r,e[18]=ke):ke=e[18];const oe=ke;let we;e[19]!==a.tasks||e[20]!==r?(we=(l,o)=>{const f=[...a.tasks];f[l].description=o,r("tasks",f)},e[19]=a.tasks,e[20]=r,e[21]=we):we=e[21];const de=we;let Se;e[22]!==a.tasks||e[23]!==r?(Se=()=>{r("tasks",[...a.tasks,{description:"",is_completed:!1,cost:null}])},e[22]=a.tasks,e[23]=r,e[24]=Se):Se=e[24];const zs=Se;let Ce;e[25]!==a.tasks||e[26]!==r?(Ce=l=>{const o=a.tasks.filter((f,lt)=>lt!==l);r("tasks",o)},e[25]=a.tasks,e[26]=r,e[27]=Ce):Ce=e[27];const me=Ce;let Te;e[28]!==a.resolved_issue_ids||e[29]!==r?(Te=l=>{const o=a.resolved_issue_ids;o.includes(l)?r("resolved_issue_ids",o.filter(f=>f!==l)):r("resolved_issue_ids",[...o,l])},e[28]=a.resolved_issue_ids,e[29]=r,e[30]=Te):Te=e[30];const As=Te;let Ie;e[31]!==d||e[32]!==t.id?(Ie=l=>{l.preventDefault(),!(!d.inventory_item_id||d.quantity<1)&&(Ps(!0),it.post(`/vehicles/workshop/${t.id}/items`,d,{onSuccess:()=>{Ds({inventory_item_id:"",quantity:1}),Ps(!1)},onError:()=>Ps(!1),preserveScroll:!0}))},e[31]=d,e[32]=t.id,e[33]=Ie):Ie=e[33];const Os=Ie;let Ee;e[34]!==t.id?(Ee=l=>{confirm("¿Eliminar este ítem de la orden?")&&it.delete(`/vehicles/workshop/${t.id}/items/${l}`,{preserveScroll:!0})},e[34]=t.id,e[35]=Ee):Ee=e[35];const qs=Ee,ct=t.items?.reduce(Zt,0)||0;let Re;e[36]!==a.tasks?(Re=a.tasks.filter(Yt),e[36]=a.tasks,e[37]=Re):Re=e[37];const Bs=Re.length;It();const{canEdit:Vs}=At();let Fe;e[38]!==Vs?(Fe=Vs("vehicles.workshop"),e[38]=Vs,e[39]=Fe):Fe=e[39];const ot=Fe,bt=t.status==="Finalizado"||t.status==="Entregado",m=!ot,i=!ot||bt;let De,Le;e[40]===Symbol.for("react.memo_cache_sentinel")?(De={title:"Panel Principal",href:"/dashboard"},Le={title:"Taller Mecánico",href:"/vehicles/workshop"},e[40]=De,e[41]=Le):(De=e[40],Le=e[41]);const Ws=`Orden #${t.id}`,Hs=`/vehicles/workshop/${t.id}`;let Pe;e[42]!==Ws||e[43]!==Hs?(Pe=[De,Le,{title:Ws,href:Hs}],e[42]=Ws,e[43]=Hs,e[44]=Pe):Pe=e[44];const Ms=`Orden de Trabajo #${t.id}`;let $e;e[45]!==Ms?($e=s.jsx(Et,{title:Ms}),e[45]=Ms,e[46]=$e):$e=e[46];let ze;e[47]===Symbol.for("react.memo_cache_sentinel")?(ze=s.jsx(h,{variant:"ghost",className:"w-fit gap-2 pl-0 hover:bg-transparent hover:text-primary",asChild:!0,children:s.jsxs(Rt,{href:"/vehicles/workshop",children:[s.jsx(Wt,{className:"h-4 w-4"}),"Volver al Taller"]})}),e[47]=ze):ze=e[47];let Ae;e[48]===Symbol.for("react.memo_cache_sentinel")?(Ae=s.jsx(Bt,{className:"h-6 w-6"}),e[48]=Ae):Ae=e[48];let u;e[49]!==t.id?(u=s.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-bold",children:[Ae,"Orden de Trabajo #",t.id]}),e[49]=t.id,e[50]=u):u=e[50];let j;e[51]!==t.vehicle.company||e[52]!==t.vehicle.name||e[53]!==t.vehicle.plate?(j=s.jsxs("p",{className:"text-muted-foreground",children:[t.vehicle.name," -"," ",t.vehicle.plate," (",t.vehicle.company,")"]}),e[51]=t.vehicle.company,e[52]=t.vehicle.name,e[53]=t.vehicle.plate,e[54]=j):j=e[54];let _;e[55]!==u||e[56]!==j?(_=s.jsxs("div",{children:[u,j]}),e[55]=u,e[56]=j,e[57]=_):_=e[57];let v;e[58]!==t.id||e[59]!==t.status?(v=(t.status==="Finalizado"||t.status==="Entregado")&&s.jsx(h,{variant:"outline",asChild:!0,className:"border-green-600 text-green-600 hover:bg-green-50",children:s.jsxs("a",{href:`/vehicles/workshop/${t.id}/print-exit`,target:"_blank",rel:"noopener noreferrer",children:[s.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Imprimir Salida"]})}),e[58]=t.id,e[59]=t.status,e[60]=v):v=e[60];const Us=`/vehicles/workshop/${t.id}/print`;let Oe,qe,Be;e[61]===Symbol.for("react.memo_cache_sentinel")?(Oe=s.jsx(Ht,{className:"mr-2 h-4 w-4"}),qe=s.jsx("span",{className:"hidden sm:inline",children:"Imprimir Orden"}),Be=s.jsx("span",{className:"sm:hidden",children:"Imprimir"}),e[61]=Oe,e[62]=qe,e[63]=Be):(Oe=e[61],qe=e[62],Be=e[63]);let g;e[64]!==Us?(g=s.jsx(h,{variant:"outline",asChild:!0,children:s.jsxs("a",{href:Us,target:"_blank",rel:"noopener noreferrer",children:[Oe,qe,Be]})}),e[64]=Us,e[65]=g):g=e[65];let b;e[66]!==$s||e[67]!==m||e[68]!==p?(b=!m&&s.jsxs(h,{onClick:$s,disabled:p,children:[s.jsx(Mt,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Guardar Cambios"})]}),e[66]=$s,e[67]=m,e[68]=p,e[69]=b):b=e[69];let N;e[70]!==a||e[71]!==i||e[72]!==m||e[73]!==t.id||e[74]!==t.status||e[75]!==p?(N=!m&&t.status!=="Finalizado"&&t.status!=="Entregado"&&s.jsxs(h,{variant:"destructive",onClick:()=>{confirm("¿Está seguro de finalizar el trabajo? Esto resolverá las incidencias marcadas y generará el documento de salida.")&&it.put(`/vehicles/workshop/${t.id}`,{...a,status:"Finalizado"})},disabled:p||i,children:[s.jsx(_t,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Finalizar"})]}),e[70]=a,e[71]=i,e[72]=m,e[73]=t.id,e[74]=t.status,e[75]=p,e[76]=N):N=e[76];let y;e[77]!==v||e[78]!==g||e[79]!==b||e[80]!==N?(y=s.jsxs("div",{className:"flex gap-2",children:[v,g,b,N]}),e[77]=v,e[78]=g,e[79]=b,e[80]=N,e[81]=y):y=e[81];let Ve;e[82]!==_||e[83]!==y?(Ve=s.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[_,y]}),e[82]=_,e[83]=y,e[84]=Ve):Ve=e[84];let We;e[85]===Symbol.for("react.memo_cache_sentinel")?(We=s.jsx(he,{children:s.jsx(pe,{children:"Estado y Fechas"})}),e[85]=We):We=e[85];let He;e[86]===Symbol.for("react.memo_cache_sentinel")?(He=s.jsx(c,{children:"Estado Actual"}),e[86]=He):He=e[86];let k;e[87]!==r?(k=l=>{l==="Entregado"&&ge(!0),r("status",l)},e[87]=r,e[88]=k):k=e[88];let Me;e[89]===Symbol.for("react.memo_cache_sentinel")?(Me=s.jsx(xt,{children:s.jsx(pt,{})}),e[89]=Me):Me=e[89];let Ue;e[90]===Symbol.for("react.memo_cache_sentinel")?(Ue=s.jsx(ht,{children:gt.map(Xt)}),e[90]=Ue):Ue=e[90];let w;e[91]!==a.status||e[92]!==m||e[93]!==k?(w=s.jsxs("div",{className:"space-y-2",children:[He,s.jsxs(ft,{value:a.status,onValueChange:k,disabled:m,children:[Me,Ue]})]}),e[91]=a.status,e[92]=m,e[93]=k,e[94]=w):w=e[94];let Ge;e[95]===Symbol.for("react.memo_cache_sentinel")?(Ge=s.jsx(c,{children:"Fecha de Ingreso"}),e[95]=Ge):Ge=e[95];let Je;e[96]===Symbol.for("react.memo_cache_sentinel")?(Je=s.jsx(Ut,{className:"h-4 w-4"}),e[96]=Je):Je=e[96];let S;e[97]!==t.entry_date?(S=dt(t.entry_date),e[97]=t.entry_date,e[98]=S):S=e[98];let C;e[99]!==S?(C=s.jsxs("div",{className:"space-y-2",children:[Ge,s.jsxs("div",{className:"flex items-center gap-2 rounded border bg-muted/50 p-2 text-sm",children:[Je,S]})]}),e[99]=S,e[100]=C):C=e[100];let Ke;e[101]===Symbol.for("react.memo_cache_sentinel")?(Ke=s.jsx(c,{children:"Fecha Tentativa Salida"}),e[101]=Ke):Ke=e[101];let T;e[102]!==r?(T=l=>r("tentative_exit_date",l.target.value),e[102]=r,e[103]=T):T=e[103];let I;e[104]!==a.tentative_exit_date||e[105]!==m||e[106]!==T?(I=s.jsxs("div",{className:"space-y-2",children:[Ke,s.jsx(ue,{type:"date",value:a.tentative_exit_date,onChange:T,onClick:Qt,disabled:m})]}),e[104]=a.tentative_exit_date,e[105]=m,e[106]=T,e[107]=I):I=e[107];let Qe;e[108]===Symbol.for("react.memo_cache_sentinel")?(Qe=s.jsx(nt,{}),e[108]=Qe):Qe=e[108];let Xe;e[109]===Symbol.for("react.memo_cache_sentinel")?(Xe=s.jsx(c,{children:"Taller / Proveedor"}),e[109]=Xe):Xe=e[109];let E;e[110]!==t.workshop_name?(E=s.jsxs("div",{className:"space-y-2",children:[Xe,s.jsx("p",{className:"font-medium",children:t.workshop_name})]}),e[110]=t.workshop_name,e[111]=E):E=e[111];let R;e[112]!==w||e[113]!==C||e[114]!==I||e[115]!==E?(R=s.jsxs(xe,{children:[We,s.jsxs(fe,{className:"space-y-4",children:[w,C,I,Qe,E]})]}),e[112]=w,e[113]=C,e[114]=I,e[115]=E,e[116]=R):R=e[116];let Ye;e[117]===Symbol.for("react.memo_cache_sentinel")?(Ye=s.jsx(he,{children:s.jsx(pe,{className:"text-base",children:"Detalles del Ingreso"})}),e[117]=Ye):Ye=e[117];let Ze;e[118]===Symbol.for("react.memo_cache_sentinel")?(Ze=s.jsx(c,{className:"text-xs text-muted-foreground",children:"Responsable"}),e[118]=Ze):Ze=e[118];const Gs=t.responsible_person||"-";let F;e[119]!==Gs?(F=s.jsxs("div",{children:[Ze,s.jsx("p",{className:"font-medium",children:Gs})]}),e[119]=Gs,e[120]=F):F=e[120];let es;e[121]===Symbol.for("react.memo_cache_sentinel")?(es=s.jsx(c,{className:"text-xs text-muted-foreground",children:"Kilometraje"}),e[121]=es):es=e[121];const Js=t.mileage_in?`${t.mileage_in} km`:"-";let D;e[122]!==Js?(D=s.jsxs("div",{children:[es,s.jsx("p",{className:"font-medium",children:Js})]}),e[122]=Js,e[123]=D):D=e[123];let ss;e[124]===Symbol.for("react.memo_cache_sentinel")?(ss=s.jsx(c,{className:"text-xs text-muted-foreground",children:"Tracción"}),e[124]=ss):ss=e[124];const Ks=t.traction||"-";let L;e[125]!==Ks?(L=s.jsxs("div",{children:[ss,s.jsx("p",{className:"font-medium",children:Ks})]}),e[125]=Ks,e[126]=L):L=e[126];let ts;e[127]===Symbol.for("react.memo_cache_sentinel")?(ts=s.jsx(c,{className:"text-xs text-muted-foreground",children:"Transmisión"}),e[127]=ts):ts=e[127];const Qs=t.transmission||"-";let P;e[128]!==Qs?(P=s.jsxs("div",{children:[ts,s.jsx("p",{className:"font-medium",children:Qs})]}),e[128]=Qs,e[129]=P):P=e[129];let ls;e[130]===Symbol.for("react.memo_cache_sentinel")?(ls=s.jsx(c,{className:"text-xs text-muted-foreground",children:"Combustible"}),e[130]=ls):ls=e[130];const Xs=t.fuel_type||"-";let $;e[131]!==Xs?($=s.jsxs("div",{className:"col-span-2",children:[ls,s.jsx("p",{className:"font-medium",children:Xs})]}),e[131]=Xs,e[132]=$):$=e[132];let z;e[133]!==F||e[134]!==D||e[135]!==L||e[136]!==P||e[137]!==$?(z=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[F,D,L,P,$]}),e[133]=F,e[134]=D,e[135]=L,e[136]=P,e[137]=$,e[138]=z):z=e[138];let A;e[139]!==t.entry_checklist?(A=t.entry_checklist&&s.jsxs("div",{className:"mt-4",children:[s.jsx(c,{className:"mb-2 block text-xs text-muted-foreground",children:"Checklist de Recepción (Fallas)"}),s.jsx("div",{className:"space-y-1 rounded border p-2",children:(()=>{const l=Object.entries(t.entry_checklist).filter(Kt);return l.length===0?s.jsx("p",{className:"text-xs text-muted-foreground",children:"No se reportaron fallas en el ingreso."}):l.map(Jt)})()})]}),e[139]=t.entry_checklist,e[140]=A):A=e[140];let O;e[141]!==z||e[142]!==A?(O=s.jsxs(xe,{children:[Ye,s.jsxs(fe,{className:"space-y-4 text-sm",children:[z,A]})]}),e[141]=z,e[142]=A,e[143]=O):O=e[143];let as;e[144]===Symbol.for("react.memo_cache_sentinel")?(as=s.jsx(he,{children:s.jsx(pe,{className:"text-base",children:"Incidencias Vinculadas"})}),e[144]=as):as=e[144];let q;e[145]!==a.resolved_issue_ids||e[146]!==i||e[147]!==t.issues||e[148]!==As?(q=t.issues.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay incidencias vinculadas."}):t.issues.map(l=>s.jsxs("div",{className:"flex items-start gap-2 rounded border p-2",children:[s.jsx(mt,{checked:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id),disabled:i||l.status==="Resolved",onCheckedChange:()=>As(l.id)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium",children:l.description}),s.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-muted-foreground",children:dt(l.date)}),s.jsx(rt,{variant:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id)?"default":"secondary",children:l.status==="Resolved"?"Resuelto":a.resolved_issue_ids.includes(l.id)?"Marcado para Resolver":"Pendiente"})]})]})]},l.id)),e[145]=a.resolved_issue_ids,e[146]=i,e[147]=t.issues,e[148]=As,e[149]=q):q=e[149];let B;e[150]!==q?(B=s.jsxs(xe,{children:[as,s.jsx(fe,{className:"space-y-3",children:q})]}),e[150]=q,e[151]=B):B=e[151];let is;e[152]!==R||e[153]!==O||e[154]!==B?(is=s.jsxs("div",{className:"space-y-6 lg:col-span-1",children:[R,O,B]}),e[152]=R,e[153]=O,e[154]=B,e[155]=is):is=e[155];let rs;e[156]===Symbol.for("react.memo_cache_sentinel")?(rs=s.jsx(pe,{children:"Repuestos e Insumos Utilizados"}),e[156]=rs):rs=e[156];const Ys=t.items?.length||0;let ns;e[157]!==Ys?(ns=s.jsxs(he,{className:"flex flex-row items-center justify-between",children:[rs,s.jsxs(rt,{variant:"secondary",className:"text-base",children:[Ys," Ítems"]})]}),e[157]=Ys,e[158]=ns):ns=e[158];let cs;e[159]!==Os||e[160]!==d||e[161]!==Cs||e[162]!==Ls||e[163]!==i?(cs=!i&&s.jsxs("div",{className:"flex items-end gap-2 rounded bg-muted/30 p-4",children:[s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx(c,{children:"Item de Bodega"}),s.jsxs(ft,{value:d.inventory_item_id.toString(),onValueChange:l=>Ds({...d,inventory_item_id:l}),children:[s.jsx(xt,{children:s.jsx(pt,{placeholder:"Seleccionar ítem..."})}),s.jsx(ht,{children:Cs.map(Gt)})]})]}),s.jsxs("div",{className:"w-24 space-y-2",children:[s.jsx(c,{children:"Cantidad"}),s.jsx(ue,{type:"number",min:"1",value:d.quantity,onChange:l=>Ds({...d,quantity:parseInt(l.target.value)||1})})]}),s.jsxs(h,{onClick:Os,disabled:Ls||!d.inventory_item_id,children:[s.jsx(Vt,{className:"mr-2 h-4 w-4"}),"Agregar"]})]}),e[159]=Os,e[160]=d,e[161]=Cs,e[162]=Ls,e[163]=i,e[164]=cs):cs=e[164];let os,ds,ms,hs;e[165]===Symbol.for("react.memo_cache_sentinel")?(os=s.jsx("th",{className:"p-3 font-medium",children:"Ítem"}),ds=s.jsx("th",{className:"p-3 text-right font-medium",children:"Cant."}),ms=s.jsx("th",{className:"p-3 text-right font-medium",children:"Costo Unit."}),hs=s.jsx("th",{className:"p-3 text-right font-medium",children:"Total"}),e[165]=os,e[166]=ds,e[167]=ms,e[168]=hs):(os=e[165],ds=e[166],ms=e[167],hs=e[168]);let V;e[169]!==i?(V=!i&&s.jsx("th",{className:"w-[50px] p-3 text-right font-medium text-muted-foreground"}),e[169]=i,e[170]=V):V=e[170];let fs;e[171]!==V?(fs=s.jsx("thead",{children:s.jsxs("tr",{className:"border-b bg-muted/50 text-left",children:[os,ds,ms,hs,V]})}),e[171]=V,e[172]=fs):fs=e[172];let W;e[173]!==qs||e[174]!==i||e[175]!==t.items?(W=!t.items||t.items.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"p-4 text-center text-muted-foreground",children:"No se han utilizado repuestos."})}):t.items.map(l=>s.jsxs("tr",{className:"border-b last:border-0",children:[s.jsxs("td",{className:"p-3",children:[s.jsx("div",{className:"font-medium",children:l.name}),s.jsx("div",{className:"text-xs text-muted-foreground",children:l.sku})]}),s.jsx("td",{className:"p-3 text-right",children:l.pivot.quantity}),s.jsxs("td",{className:"p-3 text-right",children:["$",l.pivot.unit_cost.toLocaleString("es-CL")]}),s.jsxs("td",{className:"p-3 text-right font-medium",children:["$",l.pivot.total_cost.toLocaleString("es-CL")]}),!i&&s.jsx("td",{className:"p-3 text-right",children:s.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:bg-destructive/10",onClick:()=>qs(l.id),disabled:i,children:s.jsx(ut,{className:"h-4 w-4"})})})]},l.id)),e[173]=qs,e[174]=i,e[175]=t.items,e[176]=W):W=e[176];let xs;e[177]!==W?(xs=s.jsx("tbody",{children:W}),e[177]=W,e[178]=xs):xs=e[178];let ps;e[179]===Symbol.for("react.memo_cache_sentinel")?(ps=s.jsx("td",{colSpan:3,className:"p-3 text-right font-semibold",children:"Total Repuestos:"}),e[179]=ps):ps=e[179];let us;e[180]!==i?(us=!i&&s.jsx("td",{}),e[180]=i,e[181]=us):us=e[181];const Zs=xe;let js;e[182]===Symbol.for("react.memo_cache_sentinel")?(js=s.jsx(pe,{children:"Lista de Trabajos"}),e[182]=js):js=e[182];let H;e[183]!==Bs||e[184]!==a.tasks.length?(H=s.jsxs(he,{className:"flex flex-row items-center justify-between",children:[js,s.jsxs(rt,{variant:"outline",className:"text-base",children:["Progreso: ",Bs," /"," ",a.tasks.length]})]}),e[183]=Bs,e[184]=a.tasks.length,e[185]=H):H=e[185];const et=fe,Nt="space-y-4";let _s;e[186]===Symbol.for("react.memo_cache_sentinel")?(_s=s.jsx(c,{children:"Descripción General / Observaciones"}),e[186]=_s):_s=e[186];const st=t.description||"Sin observaciones generales.";let M;e[187]!==st?(M=s.jsxs("div",{className:"space-y-2",children:[_s,s.jsx("p",{className:"min-h-[60px] rounded border bg-muted p-3 text-sm text-muted-foreground",children:st})]}),e[187]=st,e[188]=M):M=e[188];let U;e[189]===Symbol.for("react.memo_cache_sentinel")?(U=s.jsx(nt,{}),e[189]=U):U=e[189];let vs;e[190]===Symbol.for("react.memo_cache_sentinel")?(vs=s.jsx(c,{className:"text-base font-semibold",children:"Tareas Específicas"}),e[190]=vs):vs=e[190];let G;e[191]!==zs||e[192]!==i?(G=!i&&s.jsx(h,{size:"sm",variant:"secondary",onClick:zs,type:"button",disabled:i,children:"+ Agregar Tarea"}),e[191]=zs,e[192]=i,e[193]=G):G=e[193];let J;e[194]!==G?(J=s.jsxs("div",{className:"flex items-center justify-between",children:[vs,G]}),e[194]=G,e[195]=J):J=e[195];let K;e[196]!==a.tasks.length?(K=a.tasks.length===0&&s.jsx("p",{className:"rounded border-2 border-dashed py-8 text-center text-muted-foreground",children:"No hay tareas registradas. Agrega una para comenzar el seguimiento."}),e[196]=a.tasks.length,e[197]=K):K=e[197];let Q;if(e[198]!==a.tasks||e[199]!==i||e[200]!==me||e[201]!==oe||e[202]!==de){let l;e[204]!==i||e[205]!==me||e[206]!==oe||e[207]!==de?(l=(o,f)=>s.jsxs("div",{className:"flex flex-col items-start gap-3 rounded border bg-card p-3 transition-colors hover:bg-accent/5 md:flex-row md:items-center",children:[s.jsx(mt,{checked:o.is_completed,onCheckedChange:()=>oe(f),disabled:i,className:"mt-1 md:mt-0"}),s.jsx("div",{className:"w-full flex-1 space-y-2 md:flex md:gap-4 md:space-y-0",children:s.jsx(ue,{value:o.description,onChange:lt=>de(f,lt.target.value),placeholder:"Descripción de la tarea",disabled:i,className:o.is_completed?"text-muted-foreground line-through":""})}),!i&&s.jsx(h,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>me(f),type:"button",children:s.jsx(ut,{className:"h-4 w-4"})})]},f),e[204]=i,e[205]=me,e[206]=oe,e[207]=de,e[208]=l):l=e[208],Q=a.tasks.map(l),e[198]=a.tasks,e[199]=i,e[200]=me,e[201]=oe,e[202]=de,e[203]=Q}else Q=e[203];let X;e[209]!==J||e[210]!==K||e[211]!==Q?(X=s.jsxs("div",{className:"space-y-4",children:[J,K,Q]}),e[209]=J,e[210]=K,e[211]=Q,e[212]=X):X=e[212];let Y;e[213]===Symbol.for("react.memo_cache_sentinel")?(Y=s.jsx(nt,{}),e[213]=Y):Y=e[213];const yt="space-y-2",kt="flex items-center justify-end gap-4 text-muted-foreground";let Z;e[214]===Symbol.for("react.memo_cache_sentinel")?(Z=s.jsx("span",{className:"text-sm",children:"Total Repuestos:"}),e[214]=Z):Z=e[214];const wt="font-semibold",St="$",tt=ct.toLocaleString("es-CL");let ee;e[215]!==tt?(ee=s.jsxs("span",{className:wt,children:[St,tt]}),e[215]=tt,e[216]=ee):ee=e[216];let se;e[217]!==Z||e[218]!==ee?(se=s.jsx("div",{className:yt,children:s.jsxs("div",{className:kt,children:[Z,ee]})}),e[217]=Z,e[218]=ee,e[219]=se):se=e[219];let te;e[220]!==et||e[221]!==M||e[222]!==U||e[223]!==X||e[224]!==Y||e[225]!==se?(te=s.jsxs(et,{className:Nt,children:[M,U,X,Y,se]}),e[220]=et,e[221]=M,e[222]=U,e[223]=X,e[224]=Y,e[225]=se,e[226]=te):te=e[226];let gs;e[227]!==Zs||e[228]!==te||e[229]!==H?(gs=s.jsxs(Zs,{children:[H,te]}),e[227]=Zs,e[228]=te,e[229]=H,e[230]=gs):gs=e[230];let bs;e[231]===Symbol.for("react.memo_cache_sentinel")?(bs=s.jsxs(Ft,{children:[s.jsx(Dt,{children:"Confirmar Entrega de Unidad"}),s.jsx(Lt,{children:"Para registrar la salida, por favor ingrese los datos de quien retira el vehículo."})]}),e[231]=bs):bs=e[231];let Ns;e[232]===Symbol.for("react.memo_cache_sentinel")?(Ns=s.jsx(c,{children:"Nombre Responsable Retiro"}),e[232]=Ns):Ns=e[232];let le;e[233]!==r?(le=l=>r("withdrawal_responsible_name",l.target.value),e[233]=r,e[234]=le):le=e[234];let ae;e[235]!==a.withdrawal_responsible_name||e[236]!==le?(ae=s.jsxs("div",{className:"space-y-2",children:[Ns,s.jsx(ue,{value:a.withdrawal_responsible_name,onChange:le,placeholder:"Ej: Tte. Juan Perez"})]}),e[235]=a.withdrawal_responsible_name,e[236]=le,e[237]=ae):ae=e[237];let ys;e[238]===Symbol.for("react.memo_cache_sentinel")?(ys=s.jsx(c,{children:"RUT Responsable"}),e[238]=ys):ys=e[238];let ie;e[239]!==r?(ie=l=>r("withdrawal_responsible_rut",l.target.value),e[239]=r,e[240]=ie):ie=e[240];let re;e[241]!==a.withdrawal_responsible_rut||e[242]!==ie?(re=s.jsxs("div",{className:"space-y-2",children:[ys,s.jsx(ue,{value:a.withdrawal_responsible_rut,onChange:ie,placeholder:"12.345.678-9"})]}),e[241]=a.withdrawal_responsible_rut,e[242]=ie,e[243]=re):re=e[243];let ne;e[244]!==ae||e[245]!==re?(ne=s.jsxs("div",{className:"space-y-4 py-4",children:[ae,re]}),e[244]=ae,e[245]=re,e[246]=ne):ne=e[246];let ks;e[247]===Symbol.for("react.memo_cache_sentinel")?(ks=s.jsx(h,{variant:"outline",onClick:()=>ge(!1),children:"Cancelar"}),e[247]=ks):ks=e[247];let ws;e[248]===Symbol.for("react.memo_cache_sentinel")?(ws=s.jsxs(Pt,{children:[ks,s.jsx(h,{onClick:()=>{ge(!1)},children:"Confirmar Datos"})]}),e[248]=ws):ws=e[248];let ce;e[249]!==ne?(ce=s.jsxs($t,{children:[bs,ne,ws]}),e[249]=ne,e[250]=ce):ce=e[250];let Ss;return e[251]!==Fs||e[252]!==ce?(Ss=s.jsx(zt,{open:Fs,onOpenChange:ge,children:ce}),e[251]=Fs,e[252]=ce,e[253]=Ss):Ss=e[253],s.jsxs(qt,{breadcrumbs:Pe,children:[$e,s.jsxs("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-6 p-4",children:[ze,Ve,s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[is,s.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[s.jsxs(xe,{children:[ns,s.jsxs(fe,{className:"space-y-6",children:[cs,s.jsx("div",{className:"rounded-md border",children:s.jsxs("table",{className:"w-full text-sm",children:[fs,xs,s.jsx("tfoot",{className:"bg-muted/20",children:s.jsxs("tr",{children:[ps,s.jsxs("td",{className:"p-3 text-right font-bold",children:["$",ct.toLocaleString("es-CL")]}),us]})})]})})]})]}),gs]})]}),Ss]})]})}function Gt(n){return s.jsxs(jt,{value:n.id.toString(),children:[n.name," (",n.sku,") - Stock:"," ",n.stock]},n.id)}function Jt(n){const[e]=n;return s.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-600",children:[s.jsx(_t,{className:"h-3 w-3"}),s.jsx("span",{children:e})]},e)}function Kt(n){const[,e]=n;return e==="Fallas"}function Qt(n){return n.currentTarget.showPicker()}function Xt(n){return s.jsx(jt,{value:n,children:n},n)}function Yt(n){return n.is_completed}function Zt(n,e){return n+(e.pivot.total_cost||0)}function el(n){return{...n,cost:n.cost?Number(n.cost):null}}export{Cl as default};
