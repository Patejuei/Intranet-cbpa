import{c as me,r as re,b as xe,j as s,L as n,H as ue}from"./app-C47ajvwZ.js";import{B as he,M as ae,A as pe}from"./app-layout-B6KaDQVR.js";import{f as Q}from"./button-DVWjdZ4N.js";import{C as fe}from"./clock-Bx2BHmrQ.js";/* empty css            */import"./index-BtrKZ9Fe.js";import"./index-uxvNNlD4.js";import"./index-C4J_hXM0.js";import"./shield-ip1xpS6g.js";const je=[{title:"Panel Principal",href:"/dashboard"}],ge="recent_modules";function Be(t){const e=me.c(58),{upcomingBatteries:y,pendingTickets:a,respondedTickets:S,vehiclesStopped:_,pendingIncidents:E,vehiclesInWorkshop:M,expiringDocuments:le}=t;let T;e[0]!==y?(T=y===void 0?[]:y,e[0]=y,e[1]=T):T=e[1];const $=T;let z;e[2]!==a?(z=a===void 0?[]:a,e[2]=a,e[3]=z):z=e[3];const D=z;let I;e[4]!==S?(I=S===void 0?[]:S,e[4]=S,e[5]=I):I=e[5];const P=I;let R;e[6]!==_?(R=_===void 0?[]:_,e[6]=_,e[7]=R):R=e[7];const q=R;let C;e[8]!==E?(C=E===void 0?[]:E,e[8]=E,e[9]=C):C=e[9];const V=C;let B;e[10]!==M?(B=M===void 0?[]:M,e[10]=M,e[11]=B):B=e[11];const A=B,L=le===void 0?[]:le;let O;e[12]===Symbol.for("react.memo_cache_sentinel")?(O=[],e[12]=O):O=e[12];const[W,de]=re.useState(O),[X,ie]=re.useState(!1),{auth:d}=xe().props;let F;e[13]!==d.user?(F=r=>{const l=d.user;if(!l)return!1;if(l.role==="admin"||l.role==="capitan"||r.permission==="vehicles"&&["cuartelero","mechanic"].includes(l.role||""))return!0;if(l.role==="inspector"){const ne=(l.department||"").trim(),G=r.permission;if(ne==="Material Mayor"){if(["vehicles.status","vehicles.incidents","vehicles.inventory","vehicles.logs","vehicles.workshop","vehicles.checklist","vehicles"].some(k=>k===G||k.startsWith(G+".")))return!0}else if(ne==="Material Menor"&&["inventory","tickets","batteries","deliveries","reception","equipment"].some(k=>k===G||k.startsWith(G+".")))return!0}const w=l.permissions||[],v=r.permission;return w.includes(v)||w.includes(`${v}.view`)||w.includes(`${v}.edit`)},e[13]=d.user,e[14]=F):F=e[14];const i=F;let K;e[15]!==i?(K=()=>{try{const r=localStorage.getItem(ge);if(r){const w=JSON.parse(r).map(Te).filter(v=>!!v&&i(v));de(w)}}catch(r){console.error("Error loading recent modules",r)}},e[15]=i,e[16]=K):K=e[16];let U;e[17]!==d.user?(U=[d.user],e[17]=d.user,e[18]=U):U=e[18],re.useEffect(K,U);const Z=Me,ee=pe,se=je;let c;e[19]===Symbol.for("react.memo_cache_sentinel")?(c=s.jsx(ue,{title:"Material Menor - CBPA"}),e[19]=c):c=e[19];const ce="flex flex-1 flex-col gap-8 p-4";let o;e[20]!==D?(o=D.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-yellow-500 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 rounded-full bg-yellow-500"}),"Tickets Pendientes"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Solicitudes que requieren atención."})]}),s.jsx("div",{className:"space-y-3",children:D.map(Ee)})]}),e[20]=D,e[21]=o):o=e[21];let m;e[22]!==P?(m=P.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-blue-500 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 rounded-full bg-blue-500"}),"Tickets en Proceso"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Solicitudes con respuesta de Comandancia."})]}),s.jsx("div",{className:"space-y-3",children:P.map(_e)})]}),e[22]=P,e[23]=m):m=e[23];let x;e[24]!==q?(x=q.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-red-500 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 rounded-full bg-red-500"}),"Material Fuera de Servicio"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehículos detenidos o en taller."})]}),s.jsx("div",{className:"space-y-3",children:q.map(Se)})]}),e[24]=q,e[25]=x):x=e[25];let u;e[26]!==V?(u=V.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-orange-500 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 rounded-full bg-orange-500"}),"Incidencias Pendientes"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Novedades reportadas sin resolver."})]}),s.jsx("div",{className:"space-y-3",children:V.map(ke)})]}),e[26]=V,e[27]=u):u=e[27];let h;e[28]!==x||e[29]!==u?(h=s.jsxs("div",{className:"grid gap-8 md:grid-cols-2",children:[x,u]}),e[28]=x,e[29]=u,e[30]=h):h=e[30];let p;e[31]!==A?(p=A.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-yellow-600 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 rounded-full bg-yellow-600"}),"Unidades en Taller"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehículos con orden de trabajo activa."})]}),s.jsx("div",{className:"space-y-3",children:A.map(we)})]}),e[31]=A,e[32]=p):p=e[32];const te=L.length>0&&s.jsxs("div",{className:"rounded-xl border border-l-4 border-l-red-600 bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:[s.jsx("span",{className:"flex size-3 animate-pulse rounded-full bg-red-600"}),"Vencimiento de Documentación"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehículos con documentación próxima a vencer o vencida."})]}),s.jsx("div",{className:"space-y-3",children:L.slice(0,X?void 0:5).map(ve)}),L.length>5&&s.jsx("div",{className:"mt-4 text-center",children:s.jsx("button",{onClick:()=>ie(!X),className:"text-sm font-medium text-primary hover:underline",children:X?"Ver menos":`Ver más (${L.length-5} restantes)`})})]});let f;e[33]!==Z||e[34]!==$?(f=$.length>0&&s.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[s.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[s.jsx("div",{className:"rounded-lg bg-primary/10 p-3 text-primary",children:s.jsx(he,{className:"size-6"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:"Próximos Cambios de Baterías"}),s.jsx("p",{className:"text-muted-foreground",children:"Equipos que requieren atención pronto"})]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b text-left font-medium text-muted-foreground",children:[s.jsx("th",{className:"pb-2",children:"Fecha"}),s.jsx("th",{className:"pb-2",children:"Días"}),s.jsx("th",{className:"pb-2",children:"Equipo"}),s.jsx("th",{className:"pb-2",children:"Responsable"}),s.jsx("th",{className:"pb-2",children:"Compañía"})]})}),s.jsx("tbody",{className:"divide-y",children:$.map(r=>{const l=Z(r.next_change_date);return s.jsxs("tr",{children:[s.jsx("td",{className:"py-3",children:Q(r.next_change_date)}),s.jsx("td",{className:"py-3",children:s.jsxs("span",{className:`rounded px-2 py-1 font-bold ${l<=3?"bg-destructive/20 text-destructive":"bg-muted text-muted-foreground"}`,children:[l," días"]})}),s.jsx("td",{className:"py-3",children:r.equipment_type}),s.jsx("td",{className:"py-3",children:r.responsible_name}),s.jsx("td",{className:"py-3",children:r.company})]},r.id)})})]})})]}),e[33]=Z,e[34]=$,e[35]=f):f=e[35];let j;e[36]!==W?(j=W.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(fe,{className:"size-4"}),s.jsx("h2",{className:"text-sm font-medium tracking-wider uppercase",children:"Visitados Recientemente"})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:W.map(Ne)})]}),e[36]=W,e[37]=j):j=e[37];let H;e[38]===Symbol.for("react.memo_cache_sentinel")?(H=s.jsx("h2",{className:"text-sm font-medium tracking-wider text-muted-foreground uppercase",children:"Todos los Módulos"}),e[38]=H):H=e[38];let g;e[39]!==i?(g=ae.filter(be).map(r=>{if(!i(r))return null;const l=r.icon;return s.jsx(n,{href:r.href,className:"group relative overflow-hidden rounded-xl border bg-card p-6 shadow-sm transition-all hover:border-primary hover:shadow-md",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"rounded-lg bg-primary/10 p-3 text-primary transition-colors group-hover:bg-primary group-hover:text-primary-foreground",children:s.jsx(l,{className:"size-6"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold",children:r.title}),s.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]})]})},r.key)}),e[39]=i,e[40]=g):g=e[40];let b;e[41]!==g?(b=s.jsxs("div",{className:"space-y-4",children:[H,s.jsx("div",{className:"grid gap-6 md:grid-cols-3",children:g})]}),e[41]=g,e[42]=b):b=e[42];let J;e[43]===Symbol.for("react.memo_cache_sentinel")?(J=s.jsxs("div",{className:"rounded-xl border bg-muted/40 p-6",children:[s.jsx("h2",{className:"mb-2 text-xl font-semibold",children:"Bienvenido al Sistema de Material Menor"}),s.jsx("p",{className:"text-muted-foreground",children:"Seleccione una opción de arriba para comenzar sus operaciones."})]}),e[43]=J):J=e[43];let N;e[44]!==o||e[45]!==m||e[46]!==h||e[47]!==p||e[48]!==te||e[49]!==f||e[50]!==j||e[51]!==b?(N=s.jsxs("div",{className:ce,children:[o,m,h,p,te,f,j,b,J]}),e[44]=o,e[45]=m,e[46]=h,e[47]=p,e[48]=te,e[49]=f,e[50]=j,e[51]=b,e[52]=N):N=e[52];let Y;return e[53]!==ee||e[54]!==se||e[55]!==c||e[56]!==N?(Y=s.jsxs(ee,{breadcrumbs:se,children:[c,N]}),e[53]=ee,e[54]=se,e[55]=c,e[56]=N,e[57]=Y):Y=e[57],Y}function be(t){return!t.key.startsWith("admin-")}function Ne(t){const e=t.icon;return s.jsxs(n,{href:t.href,className:"group relative flex items-center gap-3 overflow-hidden rounded-lg border bg-card p-4 shadow-sm transition-all hover:border-primary hover:shadow-md",children:[s.jsx("div",{className:"rounded-md bg-primary/10 p-2 text-primary transition-colors group-hover:bg-primary group-hover:text-primary-foreground",children:s.jsx(e,{className:"size-5"})}),s.jsx("div",{children:s.jsx("h3",{className:"leading-none font-medium",children:t.title})})]},t.key)}function ve(t){return s.jsx(n,{href:`/vehicles/status/${t.id}`,className:"block",children:s.jsxs("div",{className:"flex flex-col gap-2 rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"font-bold",children:t.name}),s.jsx("span",{className:"text-xs text-muted-foreground",children:t.company})]}),s.jsx("div",{className:"flex flex-col gap-1",children:t.alerts.map(ye)})]})},t.id)}function ye(t,e){return s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{children:t.label}),s.jsxs("span",{className:`font-medium ${t.status==="danger"?"text-red-600":"text-orange-600"}`,children:[t.date," (",t.days," ","días)"]})]},e)}function we(t){const e=t.maintenances?.[0];return s.jsx(n,{href:`/vehicles/status/${t.id}`,className:"block",children:s.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"font-bold",children:t.name}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.company,")"]})]}),e?s.jsxs("p",{className:"text-xs font-medium text-yellow-700",children:[e.workshop_name," ","-"," ",e.description]}):s.jsx("p",{className:"text-xs text-muted-foreground",children:"Sin detalles de orden."})]}),e?.entry_date&&s.jsxs("div",{className:"flex items-center gap-1 font-mono text-xs text-muted-foreground",children:["Ingreso:"," ",Q(e.entry_date)]})]})},t.id)}function ke(t){return s.jsx(n,{href:"/vehicles/incidents",className:"block",children:s.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"line-clamp-1 font-medium",children:[t.vehicle.name," -"," ",t.description]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Reportado:"," ",Q(t.created_at)]})]}),s.jsx("div",{className:"rounded bg-orange-100 px-2 py-1 text-xs text-orange-700",children:t.severity})]})},t.id)}function Se(t){return s.jsx(n,{href:`/vehicles/status/${t.id}`,className:"block",children:s.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:t.name}),s.jsx("p",{className:"text-xs text-muted-foreground",children:t.company})]}),s.jsx("div",{className:`rounded px-2 py-1 text-xs font-medium ${t.status==="Out of Service"?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"}`,children:t.status==="Out of Service"?"Fuera de Servicio":"En Taller"})]})},t.id)}function _e(t){return s.jsx(n,{href:`/tickets/${t.id}`,className:"block",children:s.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:t.subject}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Estado: ",t.status]})]}),s.jsx("div",{className:"rounded bg-blue-100 px-2 py-1 text-xs text-blue-700",children:"Ver Respuesta"})]})},t.id)}function Ee(t){return s.jsx(n,{href:`/tickets/${t.id}`,className:"block",children:s.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 transition-colors hover:bg-muted/50",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:t.subject}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.user.company," -"," ",t.user.name]})]}),s.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:Q(t.created_at)})]})},t.id)}function Me(t){const e=new Date,a=new Date(t).getTime()-e.getTime();return Math.ceil(a/864e5)}function Te(t){return ae.find(e=>e.key===t)}export{Be as default};
