import{c as ye,b as we,u as Ie,r as Ce,j as t,d as qe,H as Pe,L as Ae}from"./app-HCn7GW-H.js";import{P as Re,C as ke,a as Fe,b as Me,c as Te,d as De,e as Ee,f as Le,g as Oe,M as ze}from"./MaterialSelector-Dh6U1Aw_.js";import{B as Y,c as Be}from"./button-Fsm2Ckjd.js";import{I as Se}from"./input-CAfP4kHB.js";import{L as K}from"./label-BKqtdB9a.js";import{a as $e,b as Ge,c as He,d as v,S as Qe}from"./select-jpYO0Y-k.js";import{b as Ve,A as Ue}from"./app-layout-CScgN7Wl.js";import{C as Je}from"./check-C4ReZzXj.js";import{P as Ke}from"./plus-DsHY0b8t.js";import{S as We}from"./save-DhJzPZR5.js";import{T as Xe}from"./trash-DhGyOlgc.js";/* empty css            */import"./index-DpPexbFW.js";import"./search-zripIQD7.js";import"./index-DSd-9y70.js";import"./index-y7gJODmz.js";import"./chevron-down-B4ql7f5e.js";import"./index-q7GIQJN5.js";import"./shield-Dya8Sb46.js";function _t(g){const e=ye.c(111),{firefighters:l}=g,{auth:o}=we().props,p=o.user;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=new Date().toISOString().split("T"),e[0]=n):n=e[0];const y=p.company==="Comandancia"||p.role==="admin"||p.role==="capitan"?"Segunda Compañía":p.company;let m;e[1]===Symbol.for("react.memo_cache_sentinel")?(m=[{material_id:"",quantity:1}],e[1]=m):m=e[1];let d;e[2]!==y?(d={firefighter_id:"",date:n[0],observations:"",company:y,items:m},e[2]=y,e[3]=d):d=e[3];const{data:a,setData:s,post:b,processing:j,errors:r}=Ie(d),[h,_]=Ce.useState(!1);let u;e[4]===Symbol.for("react.memo_cache_sentinel")?(u=[],e[4]=u):u=e[4];const[f,S]=Ce.useState(u);let x,C;e[5]!==a.firefighter_id?(x=()=>{a.firefighter_id?qe.get(`/api/assigned-materials/${a.firefighter_id}`).then(i=>{const c=i.data.map(Ze);S(c)}).catch(i=>{console.error("Error fetching assigned materials",i),S([])}):S([])},C=[a.firefighter_id],e[5]=a.firefighter_id,e[6]=x,e[7]=C):(x=e[6],C=e[7]),Ce.useEffect(x,C);let N;e[8]!==a.items||e[9]!==s?(N=()=>{s("items",[...a.items,{material_id:"",quantity:1}])},e[8]=a.items,e[9]=s,e[10]=N):N=e[10];const be=N;let Z;e[11]!==a.items||e[12]!==s?(Z=i=>{const c=[...a.items];c.splice(i,1),s("items",c)},e[11]=a.items,e[12]=s,e[13]=Z):Z=e[13];const W=Z;let ee;e[14]!==a.items||e[15]!==s?(ee=(i,c,ge)=>{const Ne=[...a.items];Ne[i][c]=ge,s("items",Ne)},e[14]=a.items,e[15]=s,e[16]=ee):ee=e[16];const X=ee;let te;e[17]!==b?(te=i=>{i.preventDefault(),b("/receptions")},e[17]=b,e[18]=te):te=e[18];const je=te;let ae,se;e[19]===Symbol.for("react.memo_cache_sentinel")?(ae=[{title:"Actas de Recepción",href:"/receptions"},{title:"Nueva Acta",href:"/receptions/create"}],se=t.jsx(Pe,{title:"Nueva Acta de Recepción"}),e[19]=ae,e[20]=se):(ae=e[19],se=e[20]);let ie;e[21]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Nueva Acta de Recepción"}),t.jsx("p",{className:"text-muted-foreground",children:"Registre la recepción de material devuelto por un voluntario."})]}),e[21]=ie):ie=e[21];let le;e[22]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx(K,{children:"Bombero (Entrega Material)"}),e[22]=le):le=e[22];let w;e[23]!==a.firefighter_id||e[24]!==l?(w=a.firefighter_id?l.find(i=>i.id.toString()===a.firefighter_id)?.full_name:"Seleccione bombero...",e[23]=a.firefighter_id,e[24]=l,e[25]=w):w=e[25];let re;e[26]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx(Ve,{className:"opacity-50"}),e[26]=re):re=e[26];let I;e[27]!==h||e[28]!==w?(I=t.jsx(Re,{asChild:!0,children:t.jsxs(Y,{variant:"outline",role:"combobox","aria-expanded":h,className:"w-full justify-between",children:[w,re]})}),e[27]=h,e[28]=w,e[29]=I):I=e[29];let oe;e[30]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx(ke,{placeholder:"Buscar bombero..."}),e[30]=oe):oe=e[30];let ne;e[31]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsx(Fe,{children:"No se encontró bombero."}),e[31]=ne):ne=e[31];let q;if(e[32]!==a.firefighter_id||e[33]!==l||e[34]!==s){let i;e[36]!==a.firefighter_id||e[37]!==s?(i=c=>t.jsxs(Me,{value:c.full_name,onSelect:()=>{s("firefighter_id",c.id.toString()),_(!1)},children:[c.full_name,t.jsx(Je,{className:Be("ml-auto",a.firefighter_id===c.id.toString()?"opacity-100":"opacity-0")})]},c.id),e[36]=a.firefighter_id,e[37]=s,e[38]=i):i=e[38],q=l.map(i),e[32]=a.firefighter_id,e[33]=l,e[34]=s,e[35]=q}else q=e[35];let P;e[39]!==q?(P=t.jsx(Te,{className:"w-[--radix-popover-trigger-width] p-0",children:t.jsxs(De,{children:[oe,t.jsxs(Ee,{children:[ne,t.jsx(Le,{children:q})]})]})}),e[39]=q,e[40]=P):P=e[40];let A;e[41]!==h||e[42]!==I||e[43]!==P?(A=t.jsxs(Oe,{open:h,onOpenChange:_,children:[I,P]}),e[41]=h,e[42]=I,e[43]=P,e[44]=A):A=e[44];let R;e[45]!==r.firefighter_id?(R=r.firefighter_id&&t.jsx("p",{className:"text-sm text-red-500",children:r.firefighter_id}),e[45]=r.firefighter_id,e[46]=R):R=e[46];let k;e[47]!==A||e[48]!==R?(k=t.jsxs("div",{className:"flex flex-col gap-2",children:[le,A,R]}),e[47]=A,e[48]=R,e[49]=k):k=e[49];let ce;e[50]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(K,{htmlFor:"date",children:"Fecha"}),e[50]=ce):ce=e[50];const ve=a.date??"";let F;e[51]!==s?(F=i=>s("date",i.target.value),e[51]=s,e[52]=F):F=e[52];let M;e[53]!==ve||e[54]!==F?(M=t.jsx(Se,{type:"date",value:ve,onChange:F,onClick:Ye}),e[53]=ve,e[54]=F,e[55]=M):M=e[55];let T;e[56]!==r.date?(T=r.date&&t.jsx("p",{className:"text-sm text-red-500",children:r.date}),e[56]=r.date,e[57]=T):T=e[57];let D;e[58]!==M||e[59]!==T?(D=t.jsxs("div",{className:"grid gap-2",children:[ce,M,T]}),e[58]=M,e[59]=T,e[60]=D):D=e[60];let E;e[61]!==k||e[62]!==D?(E=t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[k,D]}),e[61]=k,e[62]=D,e[63]=E):E=e[63];let me;e[64]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx(K,{htmlFor:"company",children:"Compañía"}),e[64]=me):me=e[64];const _e=a.company||"";let L;e[65]!==s?(L=i=>s("company",i),e[65]=s,e[66]=L):L=e[66];let O;e[67]!==_e||e[68]!==L?(O=t.jsxs("div",{className:"grid gap-2",children:[me,t.jsx(tt,{value:_e,onChange:L})]}),e[67]=_e,e[68]=L,e[69]=O):O=e[69];let z;e[70]!==E||e[71]!==O?(z=t.jsxs("div",{className:"grid gap-4 rounded-xl border bg-card p-6 shadow-sm",children:[E,O]}),e[70]=E,e[71]=O,e[72]=z):z=e[72];let de;e[73]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx("h3",{className:"text-lg font-semibold",children:"Materiales Recibidos"}),e[73]=de):de=e[73];let fe;e[74]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx(Ke,{className:"mr-2 size-4"}),e[74]=fe):fe=e[74];let B;e[75]!==be?(B=t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[de,t.jsxs(Y,{type:"button",variant:"outline",size:"sm",onClick:be,children:[fe," Agregar Item"]})]}),e[75]=be,e[76]=B):B=e[76];let $;if(e[77]!==f||e[78]!==a.items||e[79]!==W||e[80]!==X){let i;e[82]!==f||e[83]!==a.items.length||e[84]!==W||e[85]!==X?(i=(c,ge)=>t.jsx(et,{item:c,index:ge,materials:f.length>0?f:[],updateItem:X,removeItem:W,isSingle:a.items.length===1},ge),e[82]=f,e[83]=a.items.length,e[84]=W,e[85]=X,e[86]=i):i=e[86],$=a.items.map(i),e[77]=f,e[78]=a.items,e[79]=W,e[80]=X,e[81]=$}else $=e[81];let G;e[87]!==$?(G=t.jsx("div",{className:"space-y-4",children:$}),e[87]=$,e[88]=G):G=e[88];let H;e[89]!==r.items?(H=r.items&&t.jsx("p",{className:"mt-2 text-sm text-red-500",children:r.items}),e[89]=r.items,e[90]=H):H=e[90];let Q;e[91]!==B||e[92]!==G||e[93]!==H?(Q=t.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[B,G,H]}),e[91]=B,e[92]=G,e[93]=H,e[94]=Q):Q=e[94];let pe;e[95]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx(K,{htmlFor:"observations",children:"Observaciones"}),e[95]=pe):pe=e[95];let V;e[96]!==s?(V=i=>s("observations",i.target.value),e[96]=s,e[97]=V):V=e[97];let U;e[98]!==a.observations||e[99]!==V?(U=t.jsxs("div",{className:"grid gap-2 rounded-xl border bg-card p-6 shadow-sm",children:[pe,t.jsx("textarea",{id:"observations",value:a.observations,onChange:V,className:"flex min-h-[80px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50"})]}),e[98]=a.observations,e[99]=V,e[100]=U):U=e[100];let he;e[101]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx(Ae,{href:"/receptions",children:t.jsx(Y,{type:"button",variant:"outline",children:"Cancelar"})}),e[101]=he):he=e[101];let ue;e[102]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx(We,{className:"size-4"}),e[102]=ue):ue=e[102];let J;e[103]!==j?(J=t.jsxs("div",{className:"flex justify-end gap-4",children:[he,t.jsxs(Y,{type:"submit",disabled:j,className:"gap-2",children:[ue," Guardar Acta"]})]}),e[103]=j,e[104]=J):J=e[104];let xe;return e[105]!==je||e[106]!==z||e[107]!==Q||e[108]!==U||e[109]!==J?(xe=t.jsxs(Ue,{breadcrumbs:ae,children:[se,t.jsxs("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-6 p-4",children:[ie,t.jsxs("form",{onSubmit:je,className:"flex flex-col gap-6",children:[z,Q,U,J]})]})]}),e[105]=je,e[106]=z,e[107]=Q,e[108]=U,e[109]=J,e[110]=xe):xe=e[110],xe}function Ye(g){return g.currentTarget.showPicker()}function Ze(g){return{...g.material,assigned_quantity:g.quantity}}function et(g){const e=ye.c(30),{item:l,index:o,materials:p,updateItem:n,removeItem:y,isSingle:m}=g,d=p[0]?.assigned_quantity!==void 0?"(Disponibles en el bombero)":"";let a;e[0]!==d?(a=t.jsxs(K,{children:["Material"," ",d]}),e[0]=d,e[1]=a):a=e[1];const s=l.material_id?parseInt(l.material_id):void 0;let b;e[2]!==o||e[3]!==n?(b=N=>n(o,"material_id",N.toString()),e[2]=o,e[3]=n,e[4]=b):b=e[4];let j;e[5]!==p||e[6]!==s||e[7]!==b?(j=t.jsx(ze,{materials:p,value:s,onChange:b,placeholder:"Seleccione material (Nombre, Cód, o S/N)..."}),e[5]=p,e[6]=s,e[7]=b,e[8]=j):j=e[8];let r;e[9]!==a||e[10]!==j?(r=t.jsxs("div",{className:"flex flex-1 flex-col gap-2",children:[a,j]}),e[9]=a,e[10]=j,e[11]=r):r=e[11];let h;e[12]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsx(K,{children:"Cantidad"}),e[12]=h):h=e[12];let _;e[13]!==o||e[14]!==n?(_=N=>n(o,"quantity",parseInt(N.target.value)),e[13]=o,e[14]=n,e[15]=_):_=e[15];let u;e[16]!==l.quantity||e[17]!==_?(u=t.jsxs("div",{className:"grid w-32 gap-2",children:[h,t.jsx(Se,{type:"number",min:"1",value:l.quantity,onChange:_,required:!0})]}),e[16]=l.quantity,e[17]=_,e[18]=u):u=e[18];let f;e[19]!==o||e[20]!==y?(f=()=>y(o),e[19]=o,e[20]=y,e[21]=f):f=e[21];let S;e[22]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsx(Xe,{className:"size-4"}),e[22]=S):S=e[22];let x;e[23]!==m||e[24]!==f?(x=t.jsx(Y,{type:"button",variant:"ghost",size:"icon",className:"text-red-500 hover:bg-red-50 hover:text-red-600",onClick:f,disabled:m,children:S}),e[23]=m,e[24]=f,e[25]=x):x=e[25];let C;return e[26]!==x||e[27]!==r||e[28]!==u?(C=t.jsxs("div",{className:"flex items-end gap-4 border-b pb-4 last:border-0 last:pb-0",children:[r,u,x]}),e[26]=x,e[27]=r,e[28]=u,e[29]=C):C=e[29],C}function tt(g){const e=ye.c(7),{value:l,onChange:o}=g,{auth:p}=we().props,n=p.user;if(!(n.role==="admin"||n.role==="capitan"||n.company==="Comandancia")){let s;return e[0]!==l?(s=t.jsx(Se,{value:l,disabled:!0,className:"bg-muted text-muted-foreground opacity-100"}),e[0]=l,e[1]=s):s=e[1],s}let m;e[2]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx($e,{className:"w-full",children:t.jsx(Ge,{placeholder:"Seleccione Compañía"})}),e[2]=m):m=e[2];let d;e[3]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsxs(He,{children:[t.jsx(v,{value:"Primera Compañía",children:"Primera Compañía"}),t.jsx(v,{value:"Segunda Compañía",children:"Segunda Compañía"}),t.jsx(v,{value:"Tercera Compañía",children:"Tercera Compañía"}),t.jsx(v,{value:"Cuarta Compañía",children:"Cuarta Compañía"}),t.jsx(v,{value:"Quinta Compañía",children:"Quinta Compañía"}),t.jsx(v,{value:"Séptima Compañía",children:"Séptima Compañía"}),t.jsx(v,{value:"Octava Compañía",children:"Octava Compañía"}),t.jsx(v,{value:"Novena Compañía",children:"Novena Compañía"}),t.jsx(v,{value:"Décima Compañía",children:"Décima Compañía"}),t.jsx(v,{value:"Comandancia",children:"Comandancia"})]}),e[3]=d):d=e[3];let a;return e[4]!==o||e[5]!==l?(a=t.jsxs(Qe,{value:l,onValueChange:o,children:[m,d]}),e[4]=o,e[5]=l,e[6]=a):a=e[6],a}export{_t as default};
