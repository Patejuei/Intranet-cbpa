import{c as Ee,b as Me,u as Te,r as De,j as t,d as Be,H as Le,L as Oe,a as ze}from"./app-CGuCfgbg.js";import{P as $e,C as Ve,a as Ge,b as He,c as Je,d as Qe,e as Ue,f as Ke,g as We,M as Xe}from"./MaterialSelector-D8B8yVev.js";import{B as ie,c as Ye}from"./button-D65nKyRz.js";import{I as Re}from"./input-Cres2N1d.js";import{L as w}from"./label-DIhg13Fn.js";import{a as Ze,b as et,c as tt,d as u,S as st}from"./select-eF6aVqKn.js";import{b as at,A as it}from"./app-layout-u9Q5DKjD.js";import{S as lt}from"./switch-DzP6S3R9.js";import{C as rt}from"./check-_Go1bDRb.js";import{P as nt}from"./plus-34okoe-c.js";import{S as ot}from"./save-BRgJbQeW.js";import{T as ct}from"./trash-J1lzQFjk.js";/* empty css            */import"./index-CUc2K9e4.js";import"./search-DkT1WhgV.js";import"./index-Cq7Q3MAY.js";import"./index-j9aIAwFT.js";import"./index-q7GIQJN5.js";import"./shield-7FbujOzr.js";function Et(j){const e=Ee.c(131),{firefighters:l,materials:n}=j,{auth:S}=Me().props,m=S.user;let v;e[0]===Symbol.for("react.memo_cache_sentinel")?(v=new Date().toISOString().split("T"),e[0]=v):v=e[0];const p=m.company==="Comandancia"||m.role==="admin"||m.role==="capitan"?"Segunda Compañía":m.company;let h;e[1]===Symbol.for("react.memo_cache_sentinel")?(h=[{material_id:"",quantity:1}],e[1]=h):h=e[1];let c;e[2]!==p?(c={firefighter_id:"",date:v[0],observations:"",company:p,items:h,assignment_type:"firefighter"},e[2]=p,e[3]=c):c=e[3];const{data:s,setData:a,post:r,processing:_,errors:o}=Te(c),[f,y]=De.useState(!1);let g;e[4]===Symbol.for("react.memo_cache_sentinel")?(g=[],e[4]=g):g=e[4];const[x,b]=De.useState(g);let C;e[5]!==s.assignment_type||e[6]!==s.firefighter_id||e[7]!==n?(C=()=>{s.firefighter_id&&s.assignment_type==="firefighter"?Be.get(`/api/assigned-materials/${s.firefighter_id}`).then(i=>{const d=i.data.map(dt);b(d)}).catch(i=>{console.error("Error fetching assigned materials",i),b([])}):s.assignment_type==="company"?b(n):b([])},e[5]=s.assignment_type,e[6]=s.firefighter_id,e[7]=n,e[8]=C):C=e[8];let N;e[9]!==s.assignment_type||e[10]!==s.firefighter_id?(N=[s.firefighter_id,s.assignment_type],e[9]=s.assignment_type,e[10]=s.firefighter_id,e[11]=N):N=e[11],De.useEffect(C,N);let le;e[12]!==s.items||e[13]!==a?(le=()=>{a("items",[...s.items,{material_id:"",quantity:1}])},e[12]=s.items,e[13]=a,e[14]=le):le=e[14];const Ne=le;let re;e[15]!==s.items||e[16]!==a?(re=i=>{const d=[...s.items];d.splice(i,1),a("items",d)},e[15]=s.items,e[16]=a,e[17]=re):re=e[17];const se=re;let ne;e[18]!==s.items||e[19]!==a?(ne=(i,d,Se)=>{const Fe=[...s.items];Fe[i][d]=Se,a("items",Fe)},e[18]=s.items,e[19]=a,e[20]=ne):ne=e[20];const ae=ne;let oe;e[21]!==r?(oe=i=>{i.preventDefault(),r("/receptions")},e[21]=r,e[22]=oe):oe=e[22];const we=oe;let ce,me;e[23]===Symbol.for("react.memo_cache_sentinel")?(ce=[{title:"Actas de Recepción",href:"/receptions"},{title:"Nueva Acta",href:"/receptions/create"}],me=t.jsx(Le,{title:"Nueva Acta de Recepción"}),e[23]=ce,e[24]=me):(ce=e[23],me=e[24]);let de;e[25]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Nueva Acta de Recepción"}),t.jsx("p",{className:"text-muted-foreground",children:"Registre la recepción de material devuelto."})]})}),e[25]=de):de=e[25];const Ie=s.assignment_type==="firefighter"?"Desde Cargo Personal":"Desde Inventario Compañía";let I;e[26]!==Ie?(I=t.jsx(w,{className:"text-base",children:Ie}),e[26]=Ie,e[27]=I):I=e[27];const Pe=s.assignment_type==="firefighter"?"El material se descontará del cargo personal del bombero.":"El material proviene del inventario general de la compañía (traspaso).";let P;e[28]!==Pe?(P=t.jsx("p",{className:"text-sm text-muted-foreground",children:Pe}),e[28]=Pe,e[29]=P):P=e[29];let k;e[30]!==I||e[31]!==P?(k=t.jsxs("div",{className:"space-y-0.5",children:[I,P]}),e[30]=I,e[31]=P,e[32]=k):k=e[32];const ke=s.assignment_type==="company";let q;e[33]!==a?(q=i=>a("assignment_type",i?"company":"firefighter"),e[33]=a,e[34]=q):q=e[34];let A;e[35]!==ke||e[36]!==q?(A=t.jsx(lt,{checked:ke,onCheckedChange:q}),e[35]=ke,e[36]=q,e[37]=A):A=e[37];let D;e[38]!==k||e[39]!==A?(D=t.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4 shadow-sm",children:[k,A]}),e[38]=k,e[39]=A,e[40]=D):D=e[40];let fe;e[41]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx(w,{children:"Bombero (Entrega Material)"}),e[41]=fe):fe=e[41];let E;e[42]!==s.firefighter_id||e[43]!==l?(E=s.firefighter_id?l.find(i=>i.id.toString()===s.firefighter_id)?.full_name:"Seleccione bombero...",e[42]=s.firefighter_id,e[43]=l,e[44]=E):E=e[44];let pe;e[45]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx(at,{className:"opacity-50"}),e[45]=pe):pe=e[45];let R;e[46]!==f||e[47]!==E?(R=t.jsx($e,{asChild:!0,children:t.jsxs(ie,{variant:"outline",role:"combobox","aria-expanded":f,className:"w-full justify-between",children:[E,pe]})}),e[46]=f,e[47]=E,e[48]=R):R=e[48];let he;e[49]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx(Ve,{placeholder:"Buscar bombero..."}),e[49]=he):he=e[49];let ue;e[50]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx(Ge,{children:"No se encontró bombero."}),e[50]=ue):ue=e[50];let F;if(e[51]!==s.firefighter_id||e[52]!==l||e[53]!==a){let i;e[55]!==s.firefighter_id||e[56]!==a?(i=d=>t.jsxs(He,{value:d.full_name,onSelect:()=>{a("firefighter_id",d.id.toString()),y(!1)},children:[d.full_name,t.jsx(rt,{className:Ye("ml-auto",s.firefighter_id===d.id.toString()?"opacity-100":"opacity-0")})]},d.id),e[55]=s.firefighter_id,e[56]=a,e[57]=i):i=e[57],F=l.map(i),e[51]=s.firefighter_id,e[52]=l,e[53]=a,e[54]=F}else F=e[54];let M;e[58]!==F?(M=t.jsx(Je,{className:"w-[--radix-popover-trigger-width] p-0",children:t.jsxs(Qe,{children:[he,t.jsxs(Ue,{children:[ue,t.jsx(Ke,{children:F})]})]})}),e[58]=F,e[59]=M):M=e[59];let T;e[60]!==f||e[61]!==R||e[62]!==M?(T=t.jsxs(We,{open:f,onOpenChange:y,children:[R,M]}),e[60]=f,e[61]=R,e[62]=M,e[63]=T):T=e[63];let B;e[64]!==o.firefighter_id?(B=o.firefighter_id&&t.jsx("p",{className:"text-sm text-red-500",children:o.firefighter_id}),e[64]=o.firefighter_id,e[65]=B):B=e[65];let L;e[66]!==T||e[67]!==B?(L=t.jsxs("div",{className:"flex flex-col gap-2",children:[fe,T,B]}),e[66]=T,e[67]=B,e[68]=L):L=e[68];let ge;e[69]===Symbol.for("react.memo_cache_sentinel")?(ge=t.jsx(w,{htmlFor:"date",children:"Fecha"}),e[69]=ge):ge=e[69];const qe=s.date??"";let O;e[70]!==a?(O=i=>a("date",i.target.value),e[70]=a,e[71]=O):O=e[71];let z;e[72]!==qe||e[73]!==O?(z=t.jsx(Re,{type:"date",value:qe,onChange:O,onClick:mt}),e[72]=qe,e[73]=O,e[74]=z):z=e[74];let $;e[75]!==o.date?($=o.date&&t.jsx("p",{className:"text-sm text-red-500",children:o.date}),e[75]=o.date,e[76]=$):$=e[76];let V;e[77]!==z||e[78]!==$?(V=t.jsxs("div",{className:"grid gap-2",children:[ge,z,$]}),e[77]=z,e[78]=$,e[79]=V):V=e[79];let G;e[80]!==L||e[81]!==V?(G=t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[L,V]}),e[80]=L,e[81]=V,e[82]=G):G=e[82];let xe;e[83]===Symbol.for("react.memo_cache_sentinel")?(xe=t.jsx(w,{htmlFor:"company",children:"Compañía"}),e[83]=xe):xe=e[83];const Ae=s.company||"";let H;e[84]!==a?(H=i=>a("company",i),e[84]=a,e[85]=H):H=e[85];let J;e[86]!==Ae||e[87]!==H?(J=t.jsxs("div",{className:"grid gap-2",children:[xe,t.jsx(pt,{value:Ae,onChange:H})]}),e[86]=Ae,e[87]=H,e[88]=J):J=e[88];let Q;e[89]!==D||e[90]!==G||e[91]!==J?(Q=t.jsxs("div",{className:"grid gap-4 rounded-xl border bg-card p-6 shadow-sm",children:[D,G,J]}),e[89]=D,e[90]=G,e[91]=J,e[92]=Q):Q=e[92];let be;e[93]===Symbol.for("react.memo_cache_sentinel")?(be=t.jsx("h3",{className:"text-lg font-semibold",children:"Materiales Recibidos"}),e[93]=be):be=e[93];let je;e[94]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsx(nt,{className:"mr-2 size-4"}),e[94]=je):je=e[94];let U;e[95]!==Ne?(U=t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[be,t.jsxs(ie,{type:"button",variant:"outline",size:"sm",onClick:Ne,children:[je," Agregar Item"]})]}),e[95]=Ne,e[96]=U):U=e[96];let K;if(e[97]!==x||e[98]!==s.items||e[99]!==se||e[100]!==ae){let i;e[102]!==x||e[103]!==s.items.length||e[104]!==se||e[105]!==ae?(i=(d,Se)=>t.jsx(ft,{item:d,index:Se,materials:x.length>0?x:[],updateItem:ae,removeItem:se,isSingle:s.items.length===1},Se),e[102]=x,e[103]=s.items.length,e[104]=se,e[105]=ae,e[106]=i):i=e[106],K=s.items.map(i),e[97]=x,e[98]=s.items,e[99]=se,e[100]=ae,e[101]=K}else K=e[101];let W;e[107]!==K?(W=t.jsx("div",{className:"space-y-4",children:K}),e[107]=K,e[108]=W):W=e[108];let X;e[109]!==o.items?(X=o.items&&t.jsx("p",{className:"mt-2 text-sm text-red-500",children:o.items}),e[109]=o.items,e[110]=X):X=e[110];let Y;e[111]!==U||e[112]!==W||e[113]!==X?(Y=t.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[U,W,X]}),e[111]=U,e[112]=W,e[113]=X,e[114]=Y):Y=e[114];let _e;e[115]===Symbol.for("react.memo_cache_sentinel")?(_e=t.jsx(w,{htmlFor:"observations",children:"Observaciones"}),e[115]=_e):_e=e[115];let Z;e[116]!==a?(Z=i=>a("observations",i.target.value),e[116]=a,e[117]=Z):Z=e[117];let ee;e[118]!==s.observations||e[119]!==Z?(ee=t.jsxs("div",{className:"grid gap-2 rounded-xl border bg-card p-6 shadow-sm",children:[_e,t.jsx("textarea",{id:"observations",value:s.observations,onChange:Z,className:"flex min-h-[80px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50"})]}),e[118]=s.observations,e[119]=Z,e[120]=ee):ee=e[120];let ve;e[121]===Symbol.for("react.memo_cache_sentinel")?(ve=t.jsx(Oe,{href:"/receptions",children:t.jsx(ie,{type:"button",variant:"outline",children:"Cancelar"})}),e[121]=ve):ve=e[121];let ye;e[122]===Symbol.for("react.memo_cache_sentinel")?(ye=t.jsx(ot,{className:"size-4"}),e[122]=ye):ye=e[122];let te;e[123]!==_?(te=t.jsxs("div",{className:"flex justify-end gap-4",children:[ve,t.jsxs(ie,{type:"submit",disabled:_,className:"gap-2",children:[ye," Guardar Acta"]})]}),e[123]=_,e[124]=te):te=e[124];let Ce;return e[125]!==we||e[126]!==Q||e[127]!==Y||e[128]!==ee||e[129]!==te?(Ce=t.jsxs(it,{breadcrumbs:ce,children:[me,t.jsxs("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-6 p-4",children:[de,t.jsxs("form",{onSubmit:we,className:"flex flex-col gap-6",children:[Q,Y,ee,te]})]})]}),e[125]=we,e[126]=Q,e[127]=Y,e[128]=ee,e[129]=te,e[130]=Ce):Ce=e[130],Ce}function mt(j){return j.currentTarget.showPicker()}function dt(j){return{...j.material,assigned_quantity:j.quantity}}function ft(j){const e=Ee.c(30),{item:l,index:n,materials:S,updateItem:m,removeItem:v,isSingle:p}=j,h=S[0]?.assigned_quantity!==void 0?"(Disponibles en el bombero)":"";let c;e[0]!==h?(c=t.jsxs(w,{children:["Material"," ",h]}),e[0]=h,e[1]=c):c=e[1];const s=l.material_id?parseInt(l.material_id):void 0;let a;e[2]!==n||e[3]!==m?(a=N=>m(n,"material_id",N.toString()),e[2]=n,e[3]=m,e[4]=a):a=e[4];let r;e[5]!==S||e[6]!==s||e[7]!==a?(r=t.jsx(Xe,{materials:S,value:s,onChange:a,placeholder:"Seleccione material (Nombre, Cód, o S/N)..."}),e[5]=S,e[6]=s,e[7]=a,e[8]=r):r=e[8];let _;e[9]!==c||e[10]!==r?(_=t.jsxs("div",{className:"flex flex-1 flex-col gap-2",children:[c,r]}),e[9]=c,e[10]=r,e[11]=_):_=e[11];let o;e[12]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx(w,{children:"Cantidad"}),e[12]=o):o=e[12];let f;e[13]!==n||e[14]!==m?(f=N=>m(n,"quantity",parseInt(N.target.value)),e[13]=n,e[14]=m,e[15]=f):f=e[15];let y;e[16]!==l.quantity||e[17]!==f?(y=t.jsxs("div",{className:"grid w-32 gap-2",children:[o,t.jsx(Re,{type:"number",min:"1",value:l.quantity,onChange:f,required:!0})]}),e[16]=l.quantity,e[17]=f,e[18]=y):y=e[18];let g;e[19]!==n||e[20]!==v?(g=()=>v(n),e[19]=n,e[20]=v,e[21]=g):g=e[21];let x;e[22]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx(ct,{className:"size-4"}),e[22]=x):x=e[22];let b;e[23]!==p||e[24]!==g?(b=t.jsx(ie,{type:"button",variant:"ghost",size:"icon",className:"text-red-500 hover:bg-red-50 hover:text-red-600",onClick:g,disabled:p,children:x}),e[23]=p,e[24]=g,e[25]=b):b=e[25];let C;return e[26]!==b||e[27]!==_||e[28]!==y?(C=t.jsxs("div",{className:"flex items-end gap-4 border-b pb-4 last:border-0 last:pb-0",children:[_,y,b]}),e[26]=b,e[27]=_,e[28]=y,e[29]=C):C=e[29],C}function pt(j){const e=Ee.c(9),{value:l,onChange:n}=j,{auth:S}=Me().props,m=S.user;if(!(m.role==="admin"||m.role==="capitan"||m.company==="Comandancia")){let r;return e[0]!==l?(r=t.jsx(Re,{value:l,disabled:!0,className:"bg-muted text-muted-foreground opacity-100"}),e[0]=l,e[1]=r):r=e[1],r}let p;e[2]!==n?(p=r=>{n(r),ze.get("/receptions/create",{company:r},{preserveState:!0,preserveScroll:!0,only:["materials"],replace:!0})},e[2]=n,e[3]=p):p=e[3];const h=p;let c;e[4]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(Ze,{className:"w-full",children:t.jsx(et,{placeholder:"Seleccione Compañía"})}),e[4]=c):c=e[4];let s;e[5]===Symbol.for("react.memo_cache_sentinel")?(s=t.jsxs(tt,{children:[t.jsx(u,{value:"Primera Compañía",children:"Primera Compañía"}),t.jsx(u,{value:"Segunda Compañía",children:"Segunda Compañía"}),t.jsx(u,{value:"Tercera Compañía",children:"Tercera Compañía"}),t.jsx(u,{value:"Cuarta Compañía",children:"Cuarta Compañía"}),t.jsx(u,{value:"Quinta Compañía",children:"Quinta Compañía"}),t.jsx(u,{value:"Sexta Compañía",children:"Sexta Compañía"}),t.jsx(u,{value:"Séptima Compañía",children:"Séptima Compañía"}),t.jsx(u,{value:"Octava Compañía",children:"Octava Compañía"}),t.jsx(u,{value:"Novena Compañía",children:"Novena Compañía"}),t.jsx(u,{value:"Décima Compañía",children:"Décima Compañía"}),t.jsx(u,{value:"Brigada Juvenil",children:"Brigada Juvenil"}),t.jsx(u,{value:"Comandancia",children:"Comandancia"})]}),e[5]=s):s=e[5];let a;return e[6]!==h||e[7]!==l?(a=t.jsxs(st,{value:l,onValueChange:h,children:[c,s]}),e[6]=h,e[7]=l,e[8]=a):a=e[8],a}export{Et as default};
