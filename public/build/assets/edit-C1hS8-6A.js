import{c as Me,u as _e,j as s,H as Ce}from"./app-CT7bnRJf.js";import{C as we}from"./checkbox-C_OpsKPT.js";import{S as Se}from"./scroll-area-BgrCCw8y.js";import{S as ve,a as ye,b as je,c as Ne,d as c}from"./select-DgTG_h2e.js";import{T as ke,A as $e}from"./app-layout-DZuOocv5.js";import{S as qe}from"./shield-DRzuHyK1.js";/* empty css            */import"./button-C2tZZxJa.js";import"./index-psSA1t21.js";import"./index-B0-WvP2k.js";import"./index-B_ugykvu.js";import"./check-Co7GbpUv.js";import"./chevron-down-D2Vqo2OX.js";import"./index-C4J_hXM0.js";const Ee=[{id:"inventory",label:"Inventario",category:"Material Menor"},{id:"tickets",label:"Ticketera",category:"Material Menor"},{id:"batteries",label:"Baterías",category:"Material Menor"},{id:"equipment",label:"Material Menor (General)",category:"Material Menor"},{id:"deliveries",label:"Actas de Entrega",category:"Material Menor"},{id:"reception",label:"Actas de Recepción",category:"Material Menor"},{id:"vehicles",label:"Material Mayor (General)",category:"Material Mayor"},{id:"vehicles.incidents",label:"M. Mayor - Incidencias",category:"Material Mayor"},{id:"vehicles.checklist",label:"M. Mayor - Checklist",category:"Material Mayor"},{id:"vehicles.logs",label:"M. Mayor - Bitácora",category:"Material Mayor"},{id:"vehicles.workshop",label:"M. Mayor - Taller",category:"Material Mayor"},{id:"vehicles.inventory",label:"M. Mayor - Inventario",category:"Material Mayor"},{id:"firefighters",label:"Bomberos",category:"Administración"}],Pe=["Material Menor","Material Mayor","Administración"],Te=["Primera Compañía","Segunda Compañía","Tercera Compañía","Cuarta Compañía","Quinta Compañía","Sexta Compañía","Séptima Compañía","Octava Compañía","Novena Compañía","Décima Compañía","Brigada Juvenil","Comandancia"];function Ye(d){const e=Me.c(121),{user:l,availableVehicles:W}=d;let m;e[0]!==l.permissions?(m=l.permissions??[],e[0]=l.permissions,e[1]=m):m=e[1];let u;e[2]!==l.driver_vehicles?(u=l.driver_vehicles?.map(De)??[],e[2]=l.driver_vehicles,e[3]=u):u=e[3];let J;e[4]!==m||e[5]!==u||e[6]!==l.company||e[7]!==l.email||e[8]!==l.name||e[9]!==l.role?(J={name:l.name,email:l.email,password:"",company:l.company,role:l.role,permissions:m,driver_vehicles:u},e[4]=m,e[5]=u,e[6]=l.company,e[7]=l.email,e[8]=l.name,e[9]=l.role,e[10]=J):J=e[10];const{data:t,setData:r,put:ue,processing:pe,errors:n}=_e(J);let L;e[11]!==t.driver_vehicles||e[12]!==r?(L=i=>{const a=t.driver_vehicles;a.includes(i)?r("driver_vehicles",a.filter(o=>o!==i)):r("driver_vehicles",[...a,i])},e[11]=t.driver_vehicles,e[12]=r,e[13]=L):L=e[13];const fe=L;let Q;e[14]!==ue||e[15]!==l.id?(Q=i=>{i.preventDefault(),ue(`/admin/users/${l.id}`)},e[14]=ue,e[15]=l.id,e[16]=Q):Q=e[16];const xe=Q;let K;e[17]!==t.permissions||e[18]!==r?(K=(i,a)=>{const o=t.permissions.filter(ge=>!ge.startsWith(`${i}.`));a==="view"?o.push(`${i}.view`):a==="edit"?o.push(`${i}.view`,`${i}.edit`):a==="full"&&o.push(`${i}.view`,`${i}.edit`,`${i}.full`),["inventory","deliveries","reception"].includes(i)&&a!=="none"&&(o.some(Ae)||o.push("equipment.view")),r("permissions",o)},e[17]=t.permissions,e[18]=r,e[19]=K):K=e[19];const p=K;let X;e[20]!==t.permissions?(X=i=>{const a=t.permissions.includes(`${i}.full`),o=t.permissions.includes(`${i}.edit`),be=t.permissions.includes(`${i}.view`);return a?"full":o?"edit":be?"view":"none"},e[20]=t.permissions,e[21]=X):X=e[21];const f=X;let Y,Z;e[22]===Symbol.for("react.memo_cache_sentinel")?(Y={title:"Panel Principal",href:"/dashboard"},Z={title:"Usuarios",href:"/admin/users"},e[22]=Y,e[23]=Z):(Y=e[22],Z=e[23]);const he=`/admin/users/${l.id}/edit`;let x;e[24]!==he?(x=[Y,Z,{title:"Editar Usuario",href:he}],e[24]=he,e[25]=x):x=e[25];let I;e[26]===Symbol.for("react.memo_cache_sentinel")?(I=s.jsx(Ce,{title:"Editar Usuario"}),e[26]=I):I=e[26];let h;e[27]!==l.name?(h=s.jsxs("h2",{className:"text-lg font-semibold text-foreground",children:["Editar Usuario: ",l.name]}),e[27]=l.name,e[28]=h):h=e[28];let ee;e[29]===Symbol.for("react.memo_cache_sentinel")?(ee=s.jsx("p",{className:"text-sm text-muted-foreground",children:"Modifique los detalles del usuario."}),e[29]=ee):ee=e[29];let b;e[30]!==h?(b=s.jsxs("div",{className:"mb-6",children:[h,ee]}),e[30]=h,e[31]=b):b=e[31];let se;e[32]===Symbol.for("react.memo_cache_sentinel")?(se=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Nombre Completo"}),e[32]=se):se=e[32];let g;e[33]!==r?(g=i=>r("name",i.target.value),e[33]=r,e[34]=g):g=e[34];let v;e[35]!==t.name||e[36]!==g?(v=s.jsx("input",{type:"text",value:t.name,onChange:g,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[35]=t.name,e[36]=g,e[37]=v):v=e[37];let y;e[38]!==n.name?(y=n.name&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.name}),e[38]=n.name,e[39]=y):y=e[39];let j;e[40]!==v||e[41]!==y?(j=s.jsxs("div",{children:[se,v,y]}),e[40]=v,e[41]=y,e[42]=j):j=e[42];let ie;e[43]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Correo Electrónico"}),e[43]=ie):ie=e[43];let N;e[44]!==r?(N=i=>r("email",i.target.value),e[44]=r,e[45]=N):N=e[45];let M;e[46]!==t.email||e[47]!==N?(M=s.jsx("input",{type:"email",value:t.email,onChange:N,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[46]=t.email,e[47]=N,e[48]=M):M=e[48];let _;e[49]!==n.email?(_=n.email&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.email}),e[49]=n.email,e[50]=_):_=e[50];let C;e[51]!==M||e[52]!==_?(C=s.jsxs("div",{children:[ie,M,_]}),e[51]=M,e[52]=_,e[53]=C):C=e[53];let w;e[54]!==j||e[55]!==C?(w=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[j,C]}),e[54]=j,e[55]=C,e[56]=w):w=e[56];let te;e[57]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Contraseña (Opcional)"}),e[57]=te):te=e[57];let S;e[58]!==r?(S=i=>r("password",i.target.value),e[58]=r,e[59]=S):S=e[59];let k;e[60]!==t.password||e[61]!==S?(k=s.jsx("input",{type:"password",value:t.password,onChange:S,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",placeholder:"••••••••"}),e[60]=t.password,e[61]=S,e[62]=k):k=e[62];let $;e[63]!==n.password?($=n.password&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.password}),e[63]=n.password,e[64]=$):$=e[64];let q;e[65]!==k||e[66]!==$?(q=s.jsxs("div",{children:[te,k,$]}),e[65]=k,e[66]=$,e[67]=q):q=e[67];let le;e[68]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Compañía"}),e[68]=le):le=e[68];let E;e[69]!==r?(E=i=>r("company",i),e[69]=r,e[70]=E):E=e[70];let ae;e[71]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsx(ye,{className:"w-full",children:s.jsx(je,{placeholder:"Seleccione una Compañía"})}),e[71]=ae):ae=e[71];let re;e[72]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsx(Ne,{children:Te.map(Ve)}),e[72]=re):re=e[72];let P;e[73]!==t.company||e[74]!==E?(P=s.jsxs(ve,{value:t.company,onValueChange:E,children:[ae,re]}),e[73]=t.company,e[74]=E,e[75]=P):P=e[75];let T;e[76]!==n.company?(T=n.company&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.company}),e[76]=n.company,e[77]=T):T=e[77];let V;e[78]!==P||e[79]!==T?(V=s.jsxs("div",{children:[le,P,T]}),e[78]=P,e[79]=T,e[80]=V):V=e[80];let A;e[81]!==q||e[82]!==V?(A=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[q,V]}),e[81]=q,e[82]=V,e[83]=A):A=e[83];let D;e[84]!==w||e[85]!==A?(D=s.jsxs("div",{className:"space-y-4",children:[w,A]}),e[84]=w,e[85]=A,e[86]=D):D=e[86];let ne;e[87]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(qe,{className:"size-4"})," Roles y Permisos"]}),e[87]=ne):ne=e[87];let oe;e[88]===Symbol.for("react.memo_cache_sentinel")?(oe=s.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Rol del Sistema"}),e[88]=oe):oe=e[88];let R;e[89]!==r?(R=i=>r("role",i),e[89]=r,e[90]=R):R=e[90];let ce;e[91]===Symbol.for("react.memo_cache_sentinel")?(ce=s.jsx(ye,{className:"w-full",children:s.jsx(je,{placeholder:"Seleccione un Rol"})}),e[91]=ce):ce=e[91];let de;e[92]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsxs(Ne,{children:[s.jsx(c,{value:"user",children:"Usuario (Por Defecto)"}),s.jsx(c,{value:"admin",children:"Administrador"}),s.jsx(c,{value:"capitan",children:"Capitán"}),s.jsx(c,{value:"teniente",children:"Teniente"}),s.jsx(c,{value:"maquinista",children:"Maquinista"}),s.jsx(c,{value:"ayudante",children:"Ayudante"}),s.jsx(c,{value:"cuartelero",children:"Cuartelero"}),s.jsx(c,{value:"mechanic",children:"Taller Mecánico"}),s.jsx(c,{value:"comandancia",children:"Comandancia"})]}),e[92]=de):de=e[92];let U;e[93]!==t.role||e[94]!==R?(U=s.jsxs("div",{className:"mb-6",children:[oe,s.jsxs(ve,{value:t.role,onValueChange:R,children:[ce,de]})]}),e[93]=t.role,e[94]=R,e[95]=U):U=e[95];let B;e[96]!==t.role||e[97]!==f||e[98]!==p?(B=t.role!=="admin"&&t.role!=="capitan"&&t.role!=="maquinista"&&s.jsxs("div",{children:[s.jsx("label",{className:"mb-3 block text-sm font-medium",children:"Permisos por Módulo"}),s.jsx("div",{className:"space-y-6",children:Pe.map(i=>s.jsxs("div",{className:"rounded-md border p-3",children:[s.jsx("h4",{className:"mb-2 text-sm font-semibold text-foreground",children:i}),s.jsx("table",{className:"w-full text-sm",children:s.jsx("tbody",{className:"divide-y",children:Ee.filter(a=>a.category===i).map(a=>s.jsxs("tr",{children:[s.jsx("td",{className:"w-1/3 py-2.5 font-medium",children:a.label}),s.jsx("td",{className:"py-2",children:s.jsxs("div",{className:"flex gap-1 rounded-md bg-muted/50 p-1",children:[s.jsx("button",{type:"button",onClick:()=>p(a.id,"none"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${f(a.id)==="none"?"bg-background shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ninguno"}),s.jsx("button",{type:"button",onClick:()=>p(a.id,"view"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${f(a.id)==="view"?"bg-blue-100 text-blue-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ver"}),s.jsx("button",{type:"button",onClick:()=>p(a.id,"edit"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${f(a.id)==="edit"?"bg-green-100 text-green-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Editar"}),(a.id==="vehicles"||a.id==="equipment")&&s.jsx("button",{type:"button",onClick:()=>p(a.id,"full"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${f(a.id)==="full"?"bg-purple-100 text-purple-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Total"})]})})]},a.id))})})]},i))}),s.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"'Editar' incluye permisos de 'Ver'."})]}),e[96]=t.role,e[97]=f,e[98]=p,e[99]=B):B=e[99];let z;e[100]!==U||e[101]!==B?(z=s.jsxs("div",{className:"rounded-lg border p-4",children:[ne,U,B]}),e[100]=U,e[101]=B,e[102]=z):z=e[102];let F;e[103]!==W||e[104]!==t.driver_vehicles||e[105]!==fe?(F=W&&W.length>0&&s.jsxs("div",{className:"rounded-lg border p-4",children:[s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(ke,{className:"size-4"})," Vehículos Permitidos (Maquinistas)"]}),s.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Seleccione los vehículos que este usuario está autorizado a conducir y registrar en bitácora."}),s.jsx(Se,{className:"h-[200px] w-full rounded-md border p-4",children:s.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:W.map(i=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(we,{id:`v-${i.id}`,checked:t.driver_vehicles.includes(i.id),onCheckedChange:()=>fe(i.id)}),s.jsxs("label",{htmlFor:`v-${i.id}`,className:"text-sm leading-none font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[i.name," ",s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",i.company,")"]})]})]},i.id))})})]}),e[103]=W,e[104]=t.driver_vehicles,e[105]=fe,e[106]=F):F=e[106];let G;e[107]!==pe?(G=s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{type:"submit",disabled:pe,className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-8 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90 focus-visible:ring-2 focus-visible:ring-primary focus-visible:outline-none disabled:opacity-50",children:"Guardar Cambios"})}),e[107]=pe,e[108]=G):G=e[108];let H;e[109]!==xe||e[110]!==D||e[111]!==z||e[112]!==F||e[113]!==G?(H=s.jsxs("form",{onSubmit:xe,className:"space-y-6",children:[D,z,F,G]}),e[109]=xe,e[110]=D,e[111]=z,e[112]=F,e[113]=G,e[114]=H):H=e[114];let O;e[115]!==b||e[116]!==H?(O=s.jsx("div",{className:"flex flex-col gap-6 p-4",children:s.jsxs("div",{className:"max-w-4xl rounded-xl border bg-card p-6 shadow-sm",children:[b,H]})}),e[115]=b,e[116]=H,e[117]=O):O=e[117];let me;return e[118]!==x||e[119]!==O?(me=s.jsxs($e,{breadcrumbs:x,children:[I,O]}),e[118]=x,e[119]=O,e[120]=me):me=e[120],me}function Ve(d){return s.jsx(c,{value:d,children:d},d)}function Ae(d){return d.startsWith("equipment.")}function De(d){return d.id}export{Ye as default};
