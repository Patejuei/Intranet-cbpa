import{c as M,r as P,u as q,j as e,H as R}from"./app-CGuCfgbg.js";import{M as B}from"./MaterialSelector-D8B8yVev.js";import{P as D}from"./Pagination-CxlVdXrZ.js";import{c as H,A as I}from"./app-layout-u9Q5DKjD.js";import{u as z}from"./use-permissions-CSY_Jv43.js";import{a as T}from"./button-D65nKyRz.js";import{S as O}from"./save-BRgJbQeW.js";import{H as X}from"./history-Cl77jfVJ.js";/* empty css            */import"./index-CUc2K9e4.js";import"./search-DkT1WhgV.js";import"./index-Cq7Q3MAY.js";import"./check-_Go1bDRb.js";import"./index-q7GIQJN5.js";import"./shield-7FbujOzr.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],F=T("CircleArrowDown",$);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],J=T("CircleArrowUp",G),V=[{value:"EPP",label:"Equipos de Protección Personal (EPP)"},{value:"EXT",label:"Material de Extinción (EXT)"},{value:"RES",label:"Herramientas de Rescate (RES)"},{value:"MED",label:"Material Médico (MED)"},{value:"TEL",label:"Telecomunicaciones (TEL)"},{value:"EFO",label:"Entrada Forzada (EFO)"},{value:"ESC",label:"Escalas (ESC)"},{value:"VEN",label:"Ventilación (VEN)"},{value:"REL",label:"Riesgos Eléctricos (REL)"},{value:"HAZ",label:"Materiales Peligrosos (HAZ)"},{value:"SEG",label:"Seguridad"},{value:"OTR",label:"Otro"}];function me(s){const t=M.c(30),{logs:d,materials:b}=s,[l,L]=P.useState("ALTA"),{canCreate:p}=z();let g;t[0]===Symbol.for("react.memo_cache_sentinel")?(g={item_name:"",brand:"",model:"",serial_number:"",inventory_number:"",category:"",type:"ALTA",quantity:1,reason:"",status:"",document:null},t[0]=g):g=t[0];const{data:i,setData:a,post:_,processing:E,reset:w,errors:n}=q(g);let f;t[1]!==_||t[2]!==w?(f=r=>{r.preventDefault(),_("/equipment",{onSuccess:()=>w()})},t[1]=_,t[2]=w,t[3]=f):f=t[3];const C=f;let h;t[4]!==a?(h=r=>{L(r),a("type",r)},t[4]=a,t[5]=h):h=t[5];const v=h;let j,y;t[6]===Symbol.for("react.memo_cache_sentinel")?(j=[{title:"Panel Principal",href:"/dashboard"},{title:"Material Menor",href:"/equipment"}],y=e.jsx(R,{title:"Gestión Material Menor"}),t[6]=j,t[7]=y):(j=t[6],y=t[7]);let c;t[8]!==l||t[9]!==p||t[10]!==i||t[11]!==n||t[12]!==b||t[13]!==E||t[14]!==a||t[15]!==C||t[16]!==v?(c=p("equipment")&&e.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-6 flex items-center gap-2",children:[e.jsx(H,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Registro de Material"})]}),e.jsxs("div",{className:"mb-6 flex gap-2 rounded-lg bg-muted p-1",children:[e.jsx("button",{onClick:()=>v("ALTA"),className:`flex-1 rounded-md px-3 py-1.5 text-sm font-medium transition-all ${l==="ALTA"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(J,{className:"size-4"})," ","Alta"]})}),e.jsx("button",{onClick:()=>v("BAJA"),className:`flex-1 rounded-md px-3 py-1.5 text-sm font-medium transition-all ${l==="BAJA"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(F,{className:"size-4"})," ","Baja"]})})]}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Nombre del Material"}),e.jsx("input",{type:"text",value:i.item_name,onChange:r=>a("item_name",r.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",placeholder:"Ej: Pitón Protek, Hacha...",required:!0}),n.item_name&&e.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.item_name})]}),(l==="ALTA"||l==="BAJA")&&e.jsxs("div",{className:"space-y-4 rounded-lg bg-muted/50 p-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:l==="ALTA"?"Buscador Inteligente (Autocompletar Alta)":"Buscador Inteligente (Seleccionar Baja)"}),e.jsx(B,{materials:b,value:void 0,onChange:r=>{const o=b.find(k=>k.id===r);o&&a(k=>({...k,item_name:o.product_name,brand:o.brand||"",model:o.model||"",category:o.category||k.category,serial_number:o.serial_number||"",inventory_number:o.code||o.serial_number||""}))},placeholder:"Buscar por Nombre, Código o S/N..."}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:l==="ALTA"?"Busque un material existente para sumar stock automáticamente.":"Busque el material que desea dar de baja."})]}),e.jsxs("div",{className:l==="BAJA"?"opacity-50":"",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:l==="ALTA"?"N° Inventario Personalizado (Opcional)":"N° Inventario Seleccionado"}),e.jsx("input",{type:"text",value:i.inventory_number,onChange:r=>a("inventory_number",r.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",placeholder:l==="ALTA"?"Dejar vacío para generación automática (ej: EPP-XXXX)":"Se rellena automáticamente...",readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Marca"}),e.jsx("input",{type:"text",value:i.brand||"",onChange:r=>a("brand",r.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",placeholder:"Ej: Protek"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Modelo"}),e.jsx("input",{type:"text",value:i.model||"",onChange:r=>a("model",r.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",placeholder:"Ej: 366"})]})]}),l==="ALTA"&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Categoría (Necesaria para Auto-Generar Código)"}),e.jsxs("select",{value:i.category,onChange:r=>a("category",r.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Seleccione Categoría"}),V.map(Z)]}),n.category&&e.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.category})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Cantidad"}),e.jsx("input",{type:"number",min:"1",value:i.quantity,onChange:r=>a("quantity",parseInt(r.target.value)||1),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",required:!0}),n.quantity&&e.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.quantity})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Número de Serie (Fabricante)"}),e.jsx("input",{type:"text",value:i.serial_number,onChange:r=>a("serial_number",r.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",placeholder:"Ingrese S/N si aplica (Limita stock a 1 en Alta)"}),n.serial_number&&e.jsx("p",{className:"mt-1 text-xs text-destructive",children:n.serial_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Motivo / Descripción"}),e.jsx("textarea",{value:i.reason,onChange:r=>a("reason",r.target.value),className:"min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none",placeholder:l==="ALTA"?"Detalles de la adquisición...":"Razón de la baja (daño, pérdida, etc)..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Documento de Respaldo (Opcional)"}),e.jsx("input",{type:"file",onChange:r=>a("document",r.target.files?r.target.files[0]:null),className:"w-full cursor-pointer rounded-md border border-input bg-background px-3 py-2 text-sm file:mr-4 file:rounded-full file:border-0 file:bg-primary/10 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-primary hover:file:bg-primary/20",accept:".pdf,.jpg,.png,.jpeg"})]}),e.jsxs("button",{type:"submit",disabled:E,className:"flex h-10 w-full items-center justify-center gap-2 rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90",children:[e.jsx(O,{className:"size-4"}),"Registrar"," ",l==="ALTA"?"Alta":"Baja"]})]})]}),t[8]=l,t[9]=p,t[10]=i,t[11]=n,t[12]=b,t[13]=E,t[14]=a,t[15]=C,t[16]=v,t[17]=c):c=t[17];const S=`flex max-h-[600px] flex-col overflow-hidden rounded-xl border bg-card p-6 shadow-sm ${p("equipment")?"":"col-span-2"}`;let N;t[18]===Symbol.for("react.memo_cache_sentinel")?(N=e.jsxs("div",{className:"mb-6 flex items-center gap-2 text-primary",children:[e.jsx(X,{className:"size-5"}),e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Historial de Movimientos"})]}),t[18]=N):N=t[18];let m;t[19]!==d.data?(m=e.jsx("div",{className:"flex-1 overflow-y-auto pr-2",children:d.data.length===0?e.jsx("p",{className:"py-8 text-center text-muted-foreground",children:"No hay registros recientes."}):e.jsx("div",{className:"space-y-4",children:d.data.map(U)})}),t[19]=d.data,t[20]=m):m=t[20];let u;t[21]!==d.links?(u=e.jsx(D,{links:d.links}),t[21]=d.links,t[22]=u):u=t[22];let x;t[23]!==u||t[24]!==S||t[25]!==m?(x=e.jsxs("div",{className:S,children:[N,m,u]}),t[23]=u,t[24]=S,t[25]=m,t[26]=x):x=t[26];let A;return t[27]!==x||t[28]!==c?(A=e.jsxs(I,{breadcrumbs:j,children:[y,e.jsx("div",{className:"flex flex-col gap-6 p-4",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[c,x]})})]}),t[27]=x,t[28]=c,t[29]=A):A=t[29],A}function U(s){return e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-3 transition-colors hover:bg-muted/50",children:[e.jsxs("div",{className:"mb-1 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block font-semibold",children:s.item_name}),s.inventory_number&&e.jsx("span",{className:"rounded border bg-background px-1.5 py-0.5 font-mono text-xs",children:s.inventory_number})]}),e.jsx("span",{className:`rounded-full px-2 py-0.5 text-xs font-medium ${s.type==="ALTA"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:s.type})]}),e.jsxs("p",{className:"mb-1 text-sm text-muted-foreground",children:[s.serial_number&&e.jsxs("span",{className:"mr-2",children:["S/N: ",s.serial_number]}),"Por: ",s.user.name]}),s.reason&&e.jsxs("p",{className:"border-l-2 border-primary/30 pl-2 text-sm italic",children:['"',s.reason,'"']}),e.jsx("div",{className:"mt-2 flex items-center justify-between",children:e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleString()})})]},s.id)}function Z(s){return e.jsx("option",{value:s.value,children:s.label},s.value)}export{me as default};
