import{c as ze,b as Be,u as Re,j as s,L as ge,H as We}from"./app-lrD-X_g2.js";import{B as Oe}from"./badge-CNMh2flQ.js";import{a as qe,B as ee,f as ae}from"./button-C30YfVAU.js";import{b as _,C as se,a as te,c as g}from"./card-CeLWOmyr.js";import{C as Le,D as $e,f as Ee}from"./date-picker-D4LxhZpU.js";import{d as Ue,e as Ge,c as Je,b as Ke,D as Qe,a as Xe,f as Ye}from"./dialog-BYWk1EVO.js";import{L as Fe}from"./label-BoHnEJCk.js";import{W as Ae,A as Ze,C as es,F as ss}from"./app-layout-B-w059ge.js";import{C as Pe}from"./circle-check-DqAuizZn.js";import{C as Ve}from"./circle-alert-38s_E9sO.js";import{A as ts}from"./arrow-left-By0QDy84.js";/* empty css            */import"./chevron-left-BvRJ8iXd.js";import"./popover-BVeNiosq.js";import"./index-D28iW8MQ.js";import"./index-zozu2mmz.js";import"./index-C4J_hXM0.js";import"./shield-DP_TgMF-.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],ls=qe("DollarSign",as);function $s(a){const e=ze.c(154),{vehicle:t,totalMaintenanceCost:le}=a,l=Be().props,r=t.issues?.[0],i=t.maintenances?.[0],He=hs,Ne=xs,be=t.technical_review_expires_at||"",ye=t.circulation_permit_expires_at||"",ve=t.insurance_expires_at||"";let ne;e[0]!==be||e[1]!==ye||e[2]!==ve?(ne={technical_review_expires_at:be,circulation_permit_expires_at:ye,insurance_expires_at:ve},e[0]=be,e[1]=ye,e[2]=ve,e[3]=ne):ne=e[3];const{data:f,setData:j,patch:we,processing:ie,errors:c}=Re(ne);let de;e[4]!==we||e[5]!==t.id?(de=ce=>{ce.preventDefault(),we(`/vehicles/${t.id}/documents`,{onSuccess:ms})},e[4]=we,e[5]=t.id,e[6]=de):de=e[6];const re=de;let N,b,y,n,d,v,o,w,k,m,C,x,h,D,S,T,p;if(e[7]!==l.auth||e[8]!==f||e[9]!==c||e[10]!==ie||e[11]!==j||e[12]!==re||e[13]!==t.circulation_permit_expires_at||e[14]!==t.company||e[15]!==t.id||e[16]!==t.insurance_expires_at||e[17]!==t.make||e[18]!==t.model||e[19]!==t.name||e[20]!==t.plate||e[21]!==t.status||e[22]!==t.technical_review_expires_at||e[23]!==t.year){const ce=[{label:"Revisión Técnica",date:t.technical_review_expires_at,check:Ne(t.technical_review_expires_at)},{label:"Permiso de Circulación",date:t.circulation_permit_expires_at,check:Ne(t.circulation_permit_expires_at)},{label:"Seguro Obligatorio",date:t.insurance_expires_at,check:Ne(t.insurance_expires_at)}];y=Ze;let me;e[41]===Symbol.for("react.memo_cache_sentinel")?(me={title:"Material Mayor",href:"/vehicles/status"},e[41]=me):me=e[41];const ke=`/vehicles/status/${t.id}`;e[42]!==ke||e[43]!==t.name?(x=[me,{title:t.name,href:ke}],e[42]=ke,e[43]=t.name,e[44]=x):x=e[44];const Ce=`Detalle ${t.name}`;e[45]!==Ce?(h=s.jsx(We,{title:Ce}),e[45]=Ce,e[46]=h):h=e[46],k="mx-auto flex w-full max-w-7xl flex-col gap-6 p-4";let xe;e[47]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx(ee,{variant:"ghost",size:"icon",asChild:!0,children:s.jsx(ge,{href:"/vehicles/status",children:s.jsx(ts,{className:"h-5 w-5"})})}),e[47]=xe):xe=e[47];const Ie=t.name,De=He(t.status),Se=t.status==="Operative"?"En Servicio":t.status==="Workshop"?"En Taller":"Fuera de Servicio";let z;e[48]!==De||e[49]!==Se?(z=s.jsx(Oe,{className:De,children:Se}),e[48]=De,e[49]=Se,e[50]=z):z=e[50];let B;e[51]!==z||e[52]!==t.name?(B=s.jsxs("h1",{className:"flex items-center gap-3 text-2xl font-bold",children:[Ie,z]}),e[51]=z,e[52]=t.name,e[53]=B):B=e[53];let R;e[54]!==t.company||e[55]!==t.make||e[56]!==t.model?(R=s.jsxs("p",{className:"text-muted-foreground",children:[t.company," - ",t.make," ",t.model]}),e[54]=t.company,e[55]=t.make,e[56]=t.model,e[57]=R):R=e[57];let W;e[58]!==B||e[59]!==R?(W=s.jsxs("div",{className:"flex items-center gap-4",children:[xe,s.jsxs("div",{children:[B,R]})]}),e[58]=B,e[59]=R,e[60]=W):W=e[60];const Te=`/vehicles/logs?vehicle_id=${t.id}`;let he;e[61]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx(es,{className:"mr-2 h-4 w-4"}),e[61]=he):he=e[61];let q;e[62]!==Te?(q=s.jsx(ee,{variant:"outline",asChild:!0,children:s.jsxs(ge,{href:Te,children:[he,"Ver Bitácora"]})}),e[62]=Te,e[63]=q):q=e[63];const Me=`/vehicles/checklists?vehicle_id=${t.id}`;let pe;e[64]===Symbol.for("react.memo_cache_sentinel")?(pe=s.jsx(ss,{className:"mr-2 h-4 w-4"}),e[64]=pe):pe=e[64];let U;e[65]!==Me?(U=s.jsx(ee,{variant:"outline",asChild:!0,children:s.jsxs(ge,{href:Me,children:[pe,"Ver Checklists"]})}),e[65]=Me,e[66]=U):U=e[66];let G;e[67]!==l.auth||e[68]!==t.id?(G=l.auth?.user&&(l.auth.user.role==="admin"||l.auth.user.role==="capitan")&&s.jsx(ee,{asChild:!0,children:s.jsxs(ge,{href:`/vehicles/${t.id}/edit`,children:[s.jsx(Ae,{className:"mr-2 h-4 w-4"}),"Editar Unidad"]})}),e[67]=l.auth,e[68]=t.id,e[69]=G):G=e[69];let J;e[70]!==l.auth||e[71]!==f||e[72]!==c||e[73]!==ie||e[74]!==j||e[75]!==re?(J=l.auth?.user&&(l.auth.user.role==="admin"||l.auth.user.role==="capitan"||l.auth.user.permissions&&l.auth.user.permissions.includes("vehicles.edit"))&&s.jsxs(Ue,{children:[s.jsx(Ge,{asChild:!0,children:s.jsxs(ee,{variant:"secondary",children:[s.jsx(Le,{className:"mr-2 h-4 w-4"}),"Actualizar Vencimientos"]})}),s.jsxs(Je,{children:[s.jsxs(Ke,{children:[s.jsx(Qe,{children:"Actualizar Documentación"}),s.jsx(Xe,{children:"Modifique las fechas de vencimiento de los documentos del vehículo."})]}),s.jsxs("form",{onSubmit:re,children:[s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Fe,{htmlFor:"technical_review",children:"Revisión Técnica"}),s.jsx($e,{date:f.technical_review_expires_at,setDate:u=>j("technical_review_expires_at",u?Ee(u,"yyyy-MM-dd"):"")}),c.technical_review_expires_at&&s.jsx("span",{className:"text-sm text-destructive",children:c.technical_review_expires_at})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Fe,{htmlFor:"circulation_permit",children:"Permiso de Circulación"}),s.jsx($e,{date:f.circulation_permit_expires_at,setDate:u=>j("circulation_permit_expires_at",u?Ee(u,"yyyy-MM-dd"):"")}),c.circulation_permit_expires_at&&s.jsx("span",{className:"text-sm text-destructive",children:c.circulation_permit_expires_at})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Fe,{htmlFor:"insurance",children:"Seguro Obligatorio"}),s.jsx($e,{date:f.insurance_expires_at,setDate:u=>j("insurance_expires_at",u?Ee(u,"yyyy-MM-dd"):"")}),c.insurance_expires_at&&s.jsx("span",{className:"text-sm text-destructive",children:c.insurance_expires_at})]})]}),s.jsx(Ye,{children:s.jsx(ee,{type:"submit",disabled:ie,children:"Guardar Cambios"})})]})]})]}),e[70]=l.auth,e[71]=f,e[72]=c,e[73]=ie,e[74]=j,e[75]=re,e[76]=J):J=e[76];let K;e[77]!==q||e[78]!==U||e[79]!==G||e[80]!==J?(K=s.jsxs("div",{className:"flex flex-wrap gap-2",children:[q,U,G,J]}),e[77]=q,e[78]=U,e[79]=G,e[80]=J,e[81]=K):K=e[81],e[82]!==W||e[83]!==K?(m=s.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[W,K]}),e[82]=W,e[83]=K,e[84]=m):m=e[84],C=ce.some(os)&&s.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:ce.map(ds)}),w="grid grid-cols-1 gap-6 md:grid-cols-3",b=_,v="md:col-span-2",e[85]===Symbol.for("react.memo_cache_sentinel")?(o=s.jsx(se,{children:s.jsx(te,{children:"Información del Vehículo"})}),e[85]=o):o=e[85],N=g,T="space-y-4";let ue;e[86]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Patente"}),e[86]=ue):ue=e[86];let Q;e[87]!==t.plate?(Q=s.jsxs("div",{children:[ue,s.jsx("p",{className:"text-lg font-semibold",children:t.plate})]}),e[87]=t.plate,e[88]=Q):Q=e[88];let fe;e[89]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Año"}),e[89]=fe):fe=e[89];let X;e[90]!==t.year?(X=s.jsxs("div",{children:[fe,s.jsx("p",{className:"text-lg font-semibold",children:t.year})]}),e[90]=t.year,e[91]=X):X=e[91];let je;e[92]===Symbol.for("react.memo_cache_sentinel")?(je=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Marca"}),e[92]=je):je=e[92];let Y;e[93]!==t.make?(Y=s.jsxs("div",{children:[je,s.jsx("p",{className:"text-lg font-semibold",children:t.make})]}),e[93]=t.make,e[94]=Y):Y=e[94];let _e;e[95]===Symbol.for("react.memo_cache_sentinel")?(_e=s.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Modelo"}),e[95]=_e):_e=e[95];let Z;e[96]!==t.model?(Z=s.jsxs("div",{children:[_e,s.jsx("p",{className:"text-lg font-semibold",children:t.model})]}),e[96]=t.model,e[97]=Z):Z=e[97],e[98]!==Q||e[99]!==X||e[100]!==Y||e[101]!==Z?(p=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Q,X,Y,Z]}),e[98]=Q,e[99]=X,e[100]=Y,e[101]=Z,e[102]=p):p=e[102],e[103]===Symbol.for("react.memo_cache_sentinel")?(n=s.jsx("hr",{className:"my-4"}),d=s.jsx("h3",{className:"mb-2 font-medium",children:"Documentación"}),e[103]=n,e[104]=d):(n=e[103],d=e[104]),D="grid grid-cols-1 gap-4 sm:grid-cols-3",S=ce.map(ns),e[7]=l.auth,e[8]=f,e[9]=c,e[10]=ie,e[11]=j,e[12]=re,e[13]=t.circulation_permit_expires_at,e[14]=t.company,e[15]=t.id,e[16]=t.insurance_expires_at,e[17]=t.make,e[18]=t.model,e[19]=t.name,e[20]=t.plate,e[21]=t.status,e[22]=t.technical_review_expires_at,e[23]=t.year,e[24]=N,e[25]=b,e[26]=y,e[27]=n,e[28]=d,e[29]=v,e[30]=o,e[31]=w,e[32]=k,e[33]=m,e[34]=C,e[35]=x,e[36]=h,e[37]=D,e[38]=S,e[39]=T,e[40]=p}else N=e[24],b=e[25],y=e[26],n=e[27],d=e[28],v=e[29],o=e[30],w=e[31],k=e[32],m=e[33],C=e[34],x=e[35],h=e[36],D=e[37],S=e[38],T=e[39],p=e[40];let M;e[105]!==D||e[106]!==S?(M=s.jsx("div",{className:D,children:S}),e[105]=D,e[106]=S,e[107]=M):M=e[107];let L;e[108]!==l.auth||e[109]!==le?(L=l.auth?.user&&(l.auth.user.company==="Comandancia"||l.auth.user.role==="admin")&&s.jsxs("div",{className:"mt-4 rounded-md bg-blue-50 p-4",children:[s.jsxs("div",{className:"mb-1 flex items-center gap-2 text-blue-800",children:[s.jsx(ls,{className:"h-5 w-5"}),s.jsx("span",{className:"font-bold",children:"Inversión Total en Mantenimiento"})]}),s.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:["$",(le||0).toLocaleString("es-CL")]}),s.jsx("p",{className:"mt-1 text-xs text-blue-700",children:"Suma histórica de todas los trabajos realizados."})]}),e[108]=l.auth,e[109]=le,e[110]=L):L=e[110];let $;e[111]!==N||e[112]!==n||e[113]!==d||e[114]!==M||e[115]!==L||e[116]!==T||e[117]!==p?($=s.jsxs(N,{className:T,children:[p,n,d,M,L]}),e[111]=N,e[112]=n,e[113]=d,e[114]=M,e[115]=L,e[116]=T,e[117]=p,e[118]=$):$=e[118];let E;e[119]!==b||e[120]!==v||e[121]!==o||e[122]!==$?(E=s.jsxs(b,{className:v,children:[o,$]}),e[119]=b,e[120]=v,e[121]=o,e[122]=$,e[123]=E):E=e[123];let F;e[124]!==t.status?(F=t.status==="Operative"&&s.jsxs(_,{className:"border-green-200 bg-green-50",children:[s.jsx(se,{className:"pb-2",children:s.jsxs(te,{className:"flex items-center gap-2 text-green-800",children:[s.jsx(Pe,{className:"h-5 w-5"}),"Unidad Operativa"]})}),s.jsx(g,{children:s.jsx("p",{className:"text-sm text-green-700",children:"La unidad se encuentra operativa y disponible para el servicio."})})]}),e[124]=t.status,e[125]=F):F=e[125];let A;e[126]!==r||e[127]!==t.status?(A=t.status==="Out of Service"&&r&&s.jsxs(_,{className:"border-red-200 bg-red-50",children:[s.jsx(se,{className:"pb-2",children:s.jsxs(te,{className:"flex items-center gap-2 text-red-800",children:[s.jsx(Ve,{className:"h-5 w-5"}),"Fuera de Servicio"]})}),s.jsxs(g,{className:"space-y-2",children:[s.jsx("p",{className:"text-sm font-medium text-red-900",children:"Motivo:"}),s.jsx("p",{className:"text-sm text-red-800",children:r.description}),s.jsxs("div",{className:"mt-2 flex gap-2 text-xs text-red-700",children:[s.jsx(Le,{className:"h-3 w-3"})," ",r.date?ae(r.date):ae(r.created_at)]})]})]}),e[126]=r,e[127]=t.status,e[128]=A):A=e[128];let O;e[129]!==r||e[130]!==i||e[131]!==t.status?(O=(t.status==="Workshop"||t.status==="Out of Service"&&!r&&i)&&(i?s.jsxs(_,{className:"border-yellow-200 bg-yellow-50",children:[s.jsx(se,{className:"pb-2",children:s.jsxs(te,{className:"flex items-center gap-2 text-yellow-800",children:[s.jsx(Ae,{className:"h-5 w-5"}),"En Taller (",i.status==="Scheduled"?"Agendado":"En Proceso",")"]})}),s.jsxs(g,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-yellow-900",children:i.workshop_name}),s.jsx("p",{className:"text-sm text-yellow-800",children:i.description}),s.jsxs("div",{className:"mt-1 flex gap-2 text-xs text-yellow-700",children:[s.jsx(Le,{className:"h-3 w-3"})," ","Ingreso:"," ",ae(i.entry_date)]})]}),i.tasks&&i.tasks.length>0&&s.jsxs("div",{className:"rounded-md bg-white/50 p-3",children:[s.jsx("h4",{className:"mb-2 text-xs font-bold tracking-wider text-yellow-900 uppercase",children:"Tareas"}),s.jsx("div",{className:"space-y-2",children:i.tasks.map(cs)})]}),i.issues&&i.issues.length>0&&s.jsxs("div",{className:"rounded-md bg-white/50 p-3",children:[s.jsx("h4",{className:"mb-2 text-xs font-bold tracking-wider text-yellow-900 uppercase",children:"Incidencias Asociadas"}),s.jsx("ul",{className:"list-disc pl-4 text-sm text-slate-700",children:i.issues.map(rs)})]})]})]}):s.jsxs(_,{className:"border-yellow-200 bg-yellow-50",children:[s.jsx(se,{className:"pb-2",children:s.jsxs(te,{className:"flex items-center gap-2 text-yellow-800",children:[s.jsx(Ae,{className:"h-5 w-5"}),"En Taller"]})}),s.jsx(g,{children:s.jsx("p",{className:"text-sm text-yellow-800",children:"No hay información detallada de la orden de trabajo."})})]})),e[129]=r,e[130]=i,e[131]=t.status,e[132]=O):O=e[132];let P;e[133]!==F||e[134]!==A||e[135]!==O?(P=s.jsxs("div",{className:"space-y-6",children:[F,A,O]}),e[133]=F,e[134]=A,e[135]=O,e[136]=P):P=e[136];let V;e[137]!==w||e[138]!==E||e[139]!==P?(V=s.jsxs("div",{className:w,children:[E,P]}),e[137]=w,e[138]=E,e[139]=P,e[140]=V):V=e[140];let H;e[141]!==t.maintenances?(H=t.maintenances&&t.maintenances.length>0&&s.jsxs(_,{children:[s.jsx(se,{children:s.jsx(te,{children:"Historial de Órdenes de Trabajo"})}),s.jsx(g,{children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left text-sm",children:[s.jsx("thead",{className:"border-b bg-muted/50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-2 py-3 font-medium",children:"Fecha Ingreso"}),s.jsx("th",{className:"p-2 py-3 font-medium",children:"Taller"}),s.jsx("th",{className:"p-2 py-3 font-medium",children:"Trabajo"}),s.jsx("th",{className:"p-2 py-3 font-medium",children:"Estado"}),s.jsx("th",{className:"p-2 py-3 text-right font-medium",children:"Costo"})]})}),s.jsx("tbody",{children:t.maintenances.map(is)})]})})})]}),e[141]=t.maintenances,e[142]=H):H=e[142];let I;e[143]!==k||e[144]!==m||e[145]!==C||e[146]!==V||e[147]!==H?(I=s.jsxs("div",{className:k,children:[m,C,V,H]}),e[143]=k,e[144]=m,e[145]=C,e[146]=V,e[147]=H,e[148]=I):I=e[148];let oe;return e[149]!==y||e[150]!==x||e[151]!==h||e[152]!==I?(oe=s.jsxs(y,{breadcrumbs:x,children:[h,I]}),e[149]=y,e[150]=x,e[151]=h,e[152]=I,e[153]=oe):oe=e[153],oe}function is(a){return s.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/20",children:[s.jsx("td",{className:"p-2 py-3",children:ae(a.entry_date)}),s.jsx("td",{className:"p-2 py-3",children:a.workshop_name}),s.jsx("td",{className:"p-2 py-3",children:a.description}),s.jsx("td",{className:"p-2 py-3",children:s.jsx(Oe,{variant:"outline",className:["Finalizado","Entregado"].includes(a.status)?"border-green-200 bg-green-50 text-green-700":"border-yellow-200 bg-yellow-50 text-yellow-700",children:a.status})}),s.jsx("td",{className:"p-2 py-3 text-right",children:a.cost>0?`$${a.cost.toLocaleString("es-CL")}`:"-"})]},a.id)}function rs(a){return s.jsxs("li",{children:[a.description,a.status==="Resolved"&&s.jsx("span",{className:"ml-2 text-xs font-bold text-green-600",children:"(Solucionado)"})]},a.id)}function cs(a){return s.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[a.is_completed?s.jsx(Pe,{className:"mt-0.5 h-4 w-4 text-green-600"}):s.jsx("div",{className:"mt-0.5 h-4 w-4 rounded-full border-2 border-slate-300"}),s.jsx("span",{className:a.is_completed?"text-slate-700 line-through opacity-70":"font-medium text-slate-800",children:a.description})]},a.id)}function ns(a,e){return s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:a.label}),s.jsx("p",{className:"text-sm font-semibold",children:a.date?ae(a.date):"No registrado"})]},e)}function ds(a,e){return!a.check||a.check.status==="ok"?null:s.jsx(_,{className:`border-l-4 ${a.check.status==="expired"?"border-l-red-500 bg-red-50":"border-l-yellow-500 bg-yellow-50"}`,children:s.jsx(g,{className:"pt-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Ve,{className:`h-5 w-5 ${a.check.status==="expired"?"text-red-600":"text-yellow-600"}`}),s.jsxs("div",{children:[s.jsxs("p",{className:`font-semibold ${a.check.status==="expired"?"text-red-700":"text-yellow-700"}`,children:[a.label," ",a.check.status==="expired"?"Vencido":"Por Vencer"]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Vence:"," ",ae(a.date)," ",s.jsxs("span",{className:"font-medium",children:["(",Math.abs(a.check.days)," ","días"," ",a.check.status==="expired"?"atrasado":"restantes",")"]})]})]})]})})},e)}function os(a){return a.check?.status==="expired"||a.check?.status==="warning"}function ms(){}function xs(a){if(!a)return null;const e=new Date(a),t=new Date,le=e.getTime()-t.getTime(),l=Math.ceil(le/864e5);return l<0?{status:"expired",days:l}:l<=30?{status:"warning",days:l}:{status:"ok",days:l}}function hs(a){switch(a){case"Operative":return"bg-green-100 text-green-800";case"Workshop":return"bg-yellow-100 text-yellow-800";case"Out of Service":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}export{$s as default};
