import{c as fs,u as ps,j as s,H as xs}from"./app-DzYONblR.js";import{B as ns}from"./badge-DtRkepVc.js";import{a as us,B as he,f as os}from"./button-D4aJ6-mY.js";import{C as ts,a as as,b as ls,c as is}from"./card-UkCYR-Eg.js";import{C as ds}from"./checkbox-CUjP7uFI.js";import{I as rs}from"./input-Cp3LTYrV.js";import{L as fe}from"./label-C4QW62ag.js";import{c as _s,S as js,a as vs,b as gs,d as bs}from"./select-DSabd5dJ.js";import{S as cs}from"./separator-BiNVGgr_.js";import{F as ks,A as ys,W as Ns}from"./app-layout-DRncw1WE.js";import{C as Ss}from"./circle-check-Dw3rRBYU.js";import{P as ws}from"./printer-B9Y46kjQ.js";import{S as Cs}from"./save-CnGVhsS0.js";import{C as Ts}from"./calendar-Dl_Id6oU.js";/* empty css            */import"./index-DxUIriey.js";import"./index-BOuFj0_c.js";import"./index-C66545D9.js";import"./check-CWzlD0u2.js";import"./chevron-down-DPTAGWLz.js";import"./index-C4J_hXM0.js";import"./shield-BbymYV2N.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Fs=us("Trash2",Es);function at(n){const e=fs.c(219),{maintenance:t}=n,ms=t.status,Ke=t.tentative_exit_date||"";let je;e[0]!==t.tasks?(je=t.tasks.map(zs),e[0]=t.tasks,e[1]=je):je=e[1];const Qe=je;let ve;e[2]===Symbol.for("react.memo_cache_sentinel")?(ve=[],e[2]=ve):ve=e[2];let ge;e[3]!==t.status||e[4]!==Ke||e[5]!==Qe?(ge={status:ms,tentative_exit_date:Ke,tasks:Qe,resolved_issue_ids:ve},e[3]=t.status,e[4]=Ke,e[5]=Qe,e[6]=ge):ge=e[6];const{data:a,setData:l,put:d,processing:m}=ps(ge);let be;e[7]===Symbol.for("react.memo_cache_sentinel")?(be=["En Taller","Ingresado","Trabajando","En Espera de Repuestos","Pruebas Finales","Finalizado","Entregado"],e[7]=be):be=e[7];const hs=be;let ke;e[8]!==t.id||e[9]!==d?(ke=c=>{c.preventDefault(),d(`/vehicles/workshop/${t.id}`)},e[8]=t.id,e[9]=d,e[10]=ke):ke=e[10];const pe=ke;let ye;e[11]!==a.tasks||e[12]!==l?(ye=c=>{const r=[...a.tasks];r[c].is_completed=!r[c].is_completed,l("tasks",r)},e[11]=a.tasks,e[12]=l,e[13]=ye):ye=e[13];const k=ye;let Ne;e[14]!==a.tasks||e[15]!==l?(Ne=(c,r)=>{const o=[...a.tasks];o[c].cost=r?parseFloat(r):null,l("tasks",o)},e[14]=a.tasks,e[15]=l,e[16]=Ne):Ne=e[16];const y=Ne;let Se;e[17]!==a.tasks||e[18]!==l?(Se=(c,r)=>{const o=[...a.tasks];o[c].description=r,l("tasks",o)},e[17]=a.tasks,e[18]=l,e[19]=Se):Se=e[19];const N=Se;let we;e[20]!==a.tasks||e[21]!==l?(we=()=>{l("tasks",[...a.tasks,{description:"",is_completed:!1,cost:null}])},e[20]=a.tasks,e[21]=l,e[22]=we):we=e[22];const xe=we;let Ce;e[23]!==a.tasks||e[24]!==l?(Ce=c=>{const r=a.tasks.filter((o,W)=>W!==c);l("tasks",r)},e[23]=a.tasks,e[24]=l,e[25]=Ce):Ce=e[25];const S=Ce;let Te;e[26]!==a.resolved_issue_ids||e[27]!==l?(Te=c=>{const r=a.resolved_issue_ids;r.includes(c)?l("resolved_issue_ids",r.filter(o=>o!==c)):l("resolved_issue_ids",[...r,c])},e[26]=a.resolved_issue_ids,e[27]=l,e[28]=Te):Te=e[28];const ue=Te;let w,C,T,E,F,I,R,h,$,f,p,x,u,_,z,P,j,L,v,g,b;if(e[29]!==xe||e[30]!==a||e[31]!==pe||e[32]!==t.description||e[33]!==t.entry_date||e[34]!==t.id||e[35]!==t.issues||e[36]!==t.status||e[37]!==t.vehicle.company||e[38]!==t.vehicle.name||e[39]!==t.vehicle.plate||e[40]!==t.workshop_name||e[41]!==m||e[42]!==d||e[43]!==S||e[44]!==l||e[45]!==ue||e[46]!==k||e[47]!==y||e[48]!==N){const c=a.tasks.reduce($s,0);let r;e[70]!==a.tasks?(r=a.tasks.filter(Rs),e[70]=a.tasks,e[71]=r):r=e[71];const o=r.length;T=ys;let W,Fe;e[72]===Symbol.for("react.memo_cache_sentinel")?(W={title:"Panel Principal",href:"/dashboard"},Fe={title:"Taller Mecánico",href:"/vehicles/workshop"},e[72]=W,e[73]=Fe):(W=e[72],Fe=e[73]);const Ue=`Orden #${t.id}`,Xe=`/vehicles/workshop/${t.id}`;e[74]!==Ue||e[75]!==Xe?(g=[W,Fe,{title:Ue,href:Xe}],e[74]=Ue,e[75]=Xe,e[76]=g):g=e[76];const Ye=`Orden de Trabajo #${t.id}`;e[77]!==Ye?(b=s.jsx(xs,{title:Ye}),e[77]=Ye,e[78]=b):b=e[78],L="mx-auto flex w-full max-w-7xl flex-col gap-6 p-4";let Ie;e[79]===Symbol.for("react.memo_cache_sentinel")?(Ie=s.jsx(Ns,{className:"h-6 w-6"}),e[79]=Ie):Ie=e[79];let G;e[80]!==t.id?(G=s.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-bold",children:[Ie,"Orden de Trabajo #",t.id]}),e[80]=t.id,e[81]=G):G=e[81];let q;e[82]!==t.vehicle.company||e[83]!==t.vehicle.name||e[84]!==t.vehicle.plate?(q=s.jsxs("p",{className:"text-muted-foreground",children:[t.vehicle.name," -"," ",t.vehicle.plate," (",t.vehicle.company,")"]}),e[82]=t.vehicle.company,e[83]=t.vehicle.name,e[84]=t.vehicle.plate,e[85]=q):q=e[85];let J;e[86]!==G||e[87]!==q?(J=s.jsxs("div",{children:[G,q]}),e[86]=G,e[87]=q,e[88]=J):J=e[88];let K;e[89]!==t.id||e[90]!==t.status?(K=(t.status==="Finalizado"||t.status==="Entregado")&&s.jsx(he,{variant:"outline",asChild:!0,className:"border-green-600 text-green-600 hover:bg-green-50",children:s.jsxs("a",{href:`/vehicles/workshop/${t.id}/print-exit`,target:"_blank",rel:"noopener noreferrer",children:[s.jsx(ks,{className:"mr-2 h-4 w-4"}),"Imprimir Salida"]})}),e[89]=t.id,e[90]=t.status,e[91]=K):K=e[91];const Ze=`/vehicles/workshop/${t.id}/print`;let Re;e[92]===Symbol.for("react.memo_cache_sentinel")?(Re=s.jsx(ws,{className:"mr-2 h-4 w-4"}),e[92]=Re):Re=e[92];let Q;e[93]!==Ze?(Q=s.jsx(he,{variant:"outline",asChild:!0,children:s.jsxs("a",{href:Ze,target:"_blank",rel:"noopener noreferrer",children:[Re,"Imprimir Orden"]})}),e[93]=Ze,e[94]=Q):Q=e[94];let $e;e[95]===Symbol.for("react.memo_cache_sentinel")?($e=s.jsx(Cs,{className:"mr-2 h-4 w-4"}),e[95]=$e):$e=e[95];let U;e[96]!==pe||e[97]!==m?(U=s.jsxs(he,{onClick:pe,disabled:m,children:[$e,"Guardar Cambios"]}),e[96]=pe,e[97]=m,e[98]=U):U=e[98];let X;e[99]!==a||e[100]!==t.id||e[101]!==t.status||e[102]!==m||e[103]!==d?(X=t.status!=="Finalizado"&&t.status!=="Entregado"&&s.jsxs(he,{variant:"destructive",onClick:()=>{confirm("¿Está seguro de finalizar el trabajo? Esto resolverá las incidencias marcadas y generará el documento de salida.")&&d(`/vehicles/workshop/${t.id}`,{data:{...a,status:"Finalizado"}})},disabled:m,children:[s.jsx(Ss,{className:"mr-2 h-4 w-4"}),"Finalizar Trabajo"]}),e[99]=a,e[100]=t.id,e[101]=t.status,e[102]=m,e[103]=d,e[104]=X):X=e[104];let Y;e[105]!==K||e[106]!==Q||e[107]!==U||e[108]!==X?(Y=s.jsxs("div",{className:"flex gap-2",children:[K,Q,U,X]}),e[105]=K,e[106]=Q,e[107]=U,e[108]=X,e[109]=Y):Y=e[109],e[110]!==J||e[111]!==Y?(v=s.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[J,Y]}),e[110]=J,e[111]=Y,e[112]=v):v=e[112],P="grid grid-cols-1 gap-6 lg:grid-cols-3";let ze;e[113]===Symbol.for("react.memo_cache_sentinel")?(ze=s.jsx(ts,{children:s.jsx(as,{children:"Estado y Fechas"})}),e[113]=ze):ze=e[113];let Pe;e[114]===Symbol.for("react.memo_cache_sentinel")?(Pe=s.jsx(fe,{children:"Estado Actual"}),e[114]=Pe):Pe=e[114];let Z;e[115]!==l?(Z=i=>l("status",i),e[115]=l,e[116]=Z):Z=e[116];let Le;e[117]===Symbol.for("react.memo_cache_sentinel")?(Le=s.jsx(vs,{children:s.jsx(gs,{})}),e[117]=Le):Le=e[117];let De;e[118]===Symbol.for("react.memo_cache_sentinel")?(De=s.jsx(_s,{children:hs.map(Is)}),e[118]=De):De=e[118];let ee;e[119]!==a.status||e[120]!==Z?(ee=s.jsxs("div",{className:"space-y-2",children:[Pe,s.jsxs(js,{value:a.status,onValueChange:Z,children:[Le,De]})]}),e[119]=a.status,e[120]=Z,e[121]=ee):ee=e[121];let Oe;e[122]===Symbol.for("react.memo_cache_sentinel")?(Oe=s.jsx(fe,{children:"Fecha de Ingreso"}),e[122]=Oe):Oe=e[122];let Ae;e[123]===Symbol.for("react.memo_cache_sentinel")?(Ae=s.jsx(Ts,{className:"h-4 w-4"}),e[123]=Ae):Ae=e[123];let se;e[124]!==t.entry_date?(se=os(t.entry_date),e[124]=t.entry_date,e[125]=se):se=e[125];let te;e[126]!==se?(te=s.jsxs("div",{className:"space-y-2",children:[Oe,s.jsxs("div",{className:"flex items-center gap-2 rounded border bg-muted/50 p-2 text-sm",children:[Ae,se]})]}),e[126]=se,e[127]=te):te=e[127];let Me;e[128]===Symbol.for("react.memo_cache_sentinel")?(Me=s.jsx(fe,{children:"Fecha Tentativa Salida"}),e[128]=Me):Me=e[128];let ae;e[129]!==l?(ae=i=>l("tentative_exit_date",i.target.value),e[129]=l,e[130]=ae):ae=e[130];let le;e[131]!==a.tentative_exit_date||e[132]!==ae?(le=s.jsxs("div",{className:"space-y-2",children:[Me,s.jsx(rs,{type:"date",value:a.tentative_exit_date,onChange:ae})]}),e[131]=a.tentative_exit_date,e[132]=ae,e[133]=le):le=e[133];let Ve;e[134]===Symbol.for("react.memo_cache_sentinel")?(Ve=s.jsx(cs,{}),e[134]=Ve):Ve=e[134];let Be;e[135]===Symbol.for("react.memo_cache_sentinel")?(Be=s.jsx(fe,{children:"Taller / Proveedor"}),e[135]=Be):Be=e[135];let ie;e[136]!==t.workshop_name?(ie=s.jsxs("div",{className:"space-y-2",children:[Be,s.jsx("p",{className:"font-medium",children:t.workshop_name})]}),e[136]=t.workshop_name,e[137]=ie):ie=e[137];let re;e[138]!==ee||e[139]!==te||e[140]!==le||e[141]!==ie?(re=s.jsxs(ls,{children:[ze,s.jsxs(is,{className:"space-y-4",children:[ee,te,le,Ve,ie]})]}),e[138]=ee,e[139]=te,e[140]=le,e[141]=ie,e[142]=re):re=e[142];let He;e[143]===Symbol.for("react.memo_cache_sentinel")?(He=s.jsx(ts,{children:s.jsx(as,{className:"text-base",children:"Incidencias Vinculadas"})}),e[143]=He):He=e[143];let ce;e[144]!==a.resolved_issue_ids||e[145]!==t.issues||e[146]!==ue?(ce=t.issues.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay incidencias vinculadas."}):t.issues.map(i=>s.jsxs("div",{className:"flex items-start gap-2 rounded border p-2",children:[s.jsx(ds,{checked:i.status==="Resolved"||a.resolved_issue_ids.includes(i.id),disabled:i.status==="Resolved",onCheckedChange:()=>ue(i.id)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium",children:i.description}),s.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-muted-foreground",children:os(i.date)}),s.jsx(ns,{variant:i.status==="Resolved"||a.resolved_issue_ids.includes(i.id)?"default":"secondary",children:i.status==="Resolved"?"Resuelto":a.resolved_issue_ids.includes(i.id)?"Marcado para Resolver":"Pendiente"})]})]})]},i.id)),e[144]=a.resolved_issue_ids,e[145]=t.issues,e[146]=ue,e[147]=ce):ce=e[147];let ne;e[148]!==ce?(ne=s.jsxs(ls,{children:[He,s.jsx(is,{className:"space-y-3",children:ce})]}),e[148]=ce,e[149]=ne):ne=e[149],e[150]!==re||e[151]!==ne?(j=s.jsxs("div",{className:"space-y-6 lg:col-span-1",children:[re,ne]}),e[150]=re,e[151]=ne,e[152]=j):j=e[152],z="space-y-6 lg:col-span-2",C=ls;let We;e[153]===Symbol.for("react.memo_cache_sentinel")?(We=s.jsx(as,{children:"Lista de Trabajos y Costos"}),e[153]=We):We=e[153],e[154]!==o||e[155]!==a.tasks.length?(_=s.jsxs(ts,{className:"flex flex-row items-center justify-between",children:[We,s.jsxs(ns,{variant:"outline",className:"text-base",children:["Progreso: ",o," /"," ",a.tasks.length]})]}),e[154]=o,e[155]=a.tasks.length,e[156]=_):_=e[156],w=is,$="space-y-4";let Ge;e[157]===Symbol.for("react.memo_cache_sentinel")?(Ge=s.jsx(fe,{children:"Descripción General / Observaciones"}),e[157]=Ge):Ge=e[157];const es=t.description||"Sin observaciones generales.";e[158]!==es?(f=s.jsxs("div",{className:"space-y-2",children:[Ge,s.jsx("p",{className:"min-h-[60px] rounded border bg-muted p-3 text-sm text-muted-foreground",children:es})]}),e[158]=es,e[159]=f):f=e[159],e[160]===Symbol.for("react.memo_cache_sentinel")?(p=s.jsx(cs,{}),e[160]=p):p=e[160];let qe;e[161]===Symbol.for("react.memo_cache_sentinel")?(qe=s.jsx(fe,{className:"text-base font-semibold",children:"Tareas Específicas"}),e[161]=qe):qe=e[161];let oe;e[162]!==xe?(oe=s.jsxs("div",{className:"flex items-center justify-between",children:[qe,s.jsx(he,{size:"sm",variant:"secondary",onClick:xe,type:"button",children:"+ Agregar Tarea"})]}),e[162]=xe,e[163]=oe):oe=e[163];let de;e[164]!==a.tasks.length?(de=a.tasks.length===0&&s.jsx("p",{className:"rounded border-2 border-dashed py-8 text-center text-muted-foreground",children:"No hay tareas registradas. Agrega una para comenzar el seguimiento."}),e[164]=a.tasks.length,e[165]=de):de=e[165];let me;if(e[166]!==a.tasks||e[167]!==S||e[168]!==k||e[169]!==y||e[170]!==N){let i;e[172]!==S||e[173]!==k||e[174]!==y||e[175]!==N?(i=(Je,_e)=>s.jsxs("div",{className:"flex flex-col items-start gap-3 rounded border bg-card p-3 transition-colors hover:bg-accent/5 md:flex-row md:items-center",children:[s.jsx(ds,{checked:Je.is_completed,onCheckedChange:()=>k(_e),className:"mt-1 md:mt-0"}),s.jsxs("div",{className:"w-full flex-1 space-y-2 md:flex md:gap-4 md:space-y-0",children:[s.jsx(rs,{value:Je.description,onChange:ss=>N(_e,ss.target.value),placeholder:"Descripción de la tarea",className:Je.is_completed?"text-muted-foreground line-through":""}),s.jsxs("div",{className:"flex w-full items-center gap-2 md:w-32",children:[s.jsx("span",{className:"text-sm font-semibold text-muted-foreground",children:"$"}),s.jsx(rs,{type:"number",value:Je.cost??"",onChange:ss=>y(_e,ss.target.value),placeholder:"Costo"})]})]}),s.jsx(he,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>S(_e),type:"button",children:s.jsx(Fs,{className:"h-4 w-4"})})]},_e),e[172]=S,e[173]=k,e[174]=y,e[175]=N,e[176]=i):i=e[176],me=a.tasks.map(i),e[166]=a.tasks,e[167]=S,e[168]=k,e[169]=y,e[170]=N,e[171]=me}else me=e[171];e[177]!==oe||e[178]!==de||e[179]!==me?(x=s.jsxs("div",{className:"space-y-4",children:[oe,de,me]}),e[177]=oe,e[178]=de,e[179]=me,e[180]=x):x=e[180],e[181]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsx(cs,{}),e[181]=u):u=e[181],R="flex items-center justify-end gap-4 pt-2",e[182]===Symbol.for("react.memo_cache_sentinel")?(h=s.jsx("span",{className:"text-lg font-bold",children:"Costo Total Estimado:"}),e[182]=h):h=e[182],E="text-2xl font-bold text-primary",F="$",I=c.toLocaleString("es-CL"),e[29]=xe,e[30]=a,e[31]=pe,e[32]=t.description,e[33]=t.entry_date,e[34]=t.id,e[35]=t.issues,e[36]=t.status,e[37]=t.vehicle.company,e[38]=t.vehicle.name,e[39]=t.vehicle.plate,e[40]=t.workshop_name,e[41]=m,e[42]=d,e[43]=S,e[44]=l,e[45]=ue,e[46]=k,e[47]=y,e[48]=N,e[49]=w,e[50]=C,e[51]=T,e[52]=E,e[53]=F,e[54]=I,e[55]=R,e[56]=h,e[57]=$,e[58]=f,e[59]=p,e[60]=x,e[61]=u,e[62]=_,e[63]=z,e[64]=P,e[65]=j,e[66]=L,e[67]=v,e[68]=g,e[69]=b}else w=e[49],C=e[50],T=e[51],E=e[52],F=e[53],I=e[54],R=e[55],h=e[56],$=e[57],f=e[58],p=e[59],x=e[60],u=e[61],_=e[62],z=e[63],P=e[64],j=e[65],L=e[66],v=e[67],g=e[68],b=e[69];let D;e[183]!==E||e[184]!==F||e[185]!==I?(D=s.jsxs("span",{className:E,children:[F,I]}),e[183]=E,e[184]=F,e[185]=I,e[186]=D):D=e[186];let O;e[187]!==R||e[188]!==h||e[189]!==D?(O=s.jsxs("div",{className:R,children:[h,D]}),e[187]=R,e[188]=h,e[189]=D,e[190]=O):O=e[190];let A;e[191]!==w||e[192]!==$||e[193]!==f||e[194]!==p||e[195]!==x||e[196]!==u||e[197]!==O?(A=s.jsxs(w,{className:$,children:[f,p,x,u,O]}),e[191]=w,e[192]=$,e[193]=f,e[194]=p,e[195]=x,e[196]=u,e[197]=O,e[198]=A):A=e[198];let M;e[199]!==C||e[200]!==_||e[201]!==A?(M=s.jsxs(C,{children:[_,A]}),e[199]=C,e[200]=_,e[201]=A,e[202]=M):M=e[202];let V;e[203]!==z||e[204]!==M?(V=s.jsx("div",{className:z,children:M}),e[203]=z,e[204]=M,e[205]=V):V=e[205];let B;e[206]!==P||e[207]!==j||e[208]!==V?(B=s.jsxs("div",{className:P,children:[j,V]}),e[206]=P,e[207]=j,e[208]=V,e[209]=B):B=e[209];let H;e[210]!==L||e[211]!==v||e[212]!==B?(H=s.jsxs("div",{className:L,children:[v,B]}),e[210]=L,e[211]=v,e[212]=B,e[213]=H):H=e[213];let Ee;return e[214]!==T||e[215]!==g||e[216]!==b||e[217]!==H?(Ee=s.jsxs(T,{breadcrumbs:g,children:[b,H]}),e[214]=T,e[215]=g,e[216]=b,e[217]=H,e[218]=Ee):Ee=e[218],Ee}function Is(n){return s.jsx(bs,{value:n,children:n},n)}function Rs(n){return n.is_completed}function $s(n,e){return n+(e.cost||0)}function zs(n){return{...n,cost:n.cost?Number(n.cost):null}}export{at as default};
