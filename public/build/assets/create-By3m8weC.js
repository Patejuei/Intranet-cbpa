import{c as xe,u as he,j as s,H as be}from"./app-7T3l1Qi3.js";import{C as ge}from"./checkbox-CgK03wsL.js";import{S as ve}from"./scroll-area-BpV5EdE_.js";import{S as de,a as ue,b as pe,c as fe,d as c}from"./select-B_iHn1kO.js";import{T as ye,A as je}from"./app-layout-BHffE17Q.js";import{S as Ne}from"./shield-C01C4vrL.js";/* empty css            */import"./button-BkJ9ctea.js";import"./index-4gzLtCu3.js";import"./index-de_OD_BN.js";import"./index-Cb5BQB3p.js";import"./check-BiDMPmor.js";import"./chevron-down-CUXFwhnx.js";import"./index-C4J_hXM0.js";const Me=[{id:"inventory",label:"Inventario",category:"Material Menor"},{id:"tickets",label:"Ticketera",category:"Material Menor"},{id:"batteries",label:"Baterías",category:"Material Menor"},{id:"equipment",label:"Material Menor (General)",category:"Material Menor"},{id:"deliveries",label:"Actas de Entrega",category:"Material Menor"},{id:"reception",label:"Actas de Recepción",category:"Material Menor"},{id:"vehicles",label:"Material Mayor (General)",category:"Material Mayor"},{id:"vehicles.incidents",label:"M. Mayor - Incidencias",category:"Material Mayor"},{id:"vehicles.checklist",label:"M. Mayor - Checklist",category:"Material Mayor"},{id:"vehicles.logs",label:"M. Mayor - Bitácora",category:"Material Mayor"},{id:"vehicles.workshop",label:"M. Mayor - Taller",category:"Material Mayor"},{id:"vehicles.inventory",label:"M. Mayor - Inventario",category:"Material Mayor"},{id:"firefighters",label:"Bomberos",category:"Administración"}],Ce=["Material Menor","Material Mayor","Administración"],_e=["Primera Compañía","Segunda Compañía","Tercera Compañía","Cuarta Compañía","Quinta Compañía","Sexta Compañía","Séptima Compañía","Octava Compañía","Novena Compañía","Décima Compañía","Brigada Juvenil","Comandancia"];function He(n){const e=xe.c(99),{availableVehicles:U}=n;let D;e[0]===Symbol.for("react.memo_cache_sentinel")?(D=[],e[0]=D):D=e[0];let B;e[1]===Symbol.for("react.memo_cache_sentinel")?(B=[],e[1]=B):B=e[1];let z;e[2]===Symbol.for("react.memo_cache_sentinel")?(z={name:"",email:"",password:"",company:"",role:"user",permissions:D,driver_vehicles:B},e[2]=z):z=e[2];const{data:t,setData:a,post:ae,processing:re,errors:r}=he(z);let F;e[3]!==t.driver_vehicles||e[4]!==a?(F=i=>{const l=t.driver_vehicles;l.includes(i)?a("driver_vehicles",l.filter(o=>o!==i)):a("driver_vehicles",[...l,i])},e[3]=t.driver_vehicles,e[4]=a,e[5]=F):F=e[5];const ne=F;let G;e[6]!==ae?(G=i=>{i.preventDefault(),ae("/admin/users")},e[6]=ae,e[7]=G):G=e[7];const oe=G;let H;e[8]!==t.permissions||e[9]!==a?(H=(i,l)=>{const o=t.permissions.filter(me=>!me.startsWith(`${i}.`));l==="view"?o.push(`${i}.view`):l==="edit"?o.push(`${i}.view`,`${i}.edit`):l==="full"&&o.push(`${i}.view`,`${i}.edit`,`${i}.full`),["inventory","deliveries","reception"].includes(i)&&l!=="none"&&!o.some(ke)&&(o.some(Se)||o.push("equipment.view")),a("permissions",o)},e[8]=t.permissions,e[9]=a,e[10]=H):H=e[10];const m=H;let W;e[11]!==t.permissions?(W=i=>{const l=t.permissions.includes(`${i}.full`),o=t.permissions.includes(`${i}.edit`),ce=t.permissions.includes(`${i}.view`);return l?"full":o?"edit":ce?"view":"none"},e[11]=t.permissions,e[12]=W):W=e[12];const d=W;let J,L;e[13]===Symbol.for("react.memo_cache_sentinel")?(J=[{title:"Panel Principal",href:"/dashboard"},{title:"Usuarios",href:"/admin/users"},{title:"Nuevo Usuario",href:"/admin/users/create"}],L=s.jsx(be,{title:"Crear Usuario"}),e[13]=J,e[14]=L):(J=e[13],L=e[14]);let O;e[15]===Symbol.for("react.memo_cache_sentinel")?(O=s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Crear Nuevo Usuario"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete los detalles para registrar un nuevo usuario en el sistema."})]}),e[15]=O):O=e[15];let Q;e[16]===Symbol.for("react.memo_cache_sentinel")?(Q=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Nombre Completo"}),e[16]=Q):Q=e[16];let u;e[17]!==a?(u=i=>a("name",i.target.value),e[17]=a,e[18]=u):u=e[18];let p;e[19]!==t.name||e[20]!==u?(p=s.jsx("input",{type:"text",value:t.name,onChange:u,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[19]=t.name,e[20]=u,e[21]=p):p=e[21];let f;e[22]!==r.name?(f=r.name&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.name}),e[22]=r.name,e[23]=f):f=e[23];let x;e[24]!==p||e[25]!==f?(x=s.jsxs("div",{children:[Q,p,f]}),e[24]=p,e[25]=f,e[26]=x):x=e[26];let K;e[27]===Symbol.for("react.memo_cache_sentinel")?(K=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Correo Electrónico"}),e[27]=K):K=e[27];let h;e[28]!==a?(h=i=>a("email",i.target.value),e[28]=a,e[29]=h):h=e[29];let b;e[30]!==t.email||e[31]!==h?(b=s.jsx("input",{type:"email",value:t.email,onChange:h,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[30]=t.email,e[31]=h,e[32]=b):b=e[32];let g;e[33]!==r.email?(g=r.email&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.email}),e[33]=r.email,e[34]=g):g=e[34];let v;e[35]!==b||e[36]!==g?(v=s.jsxs("div",{children:[K,b,g]}),e[35]=b,e[36]=g,e[37]=v):v=e[37];let y;e[38]!==x||e[39]!==v?(y=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[x,v]}),e[38]=x,e[39]=v,e[40]=y):y=e[40];let X;e[41]===Symbol.for("react.memo_cache_sentinel")?(X=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Contraseña"}),e[41]=X):X=e[41];let j;e[42]!==a?(j=i=>a("password",i.target.value),e[42]=a,e[43]=j):j=e[43];let N;e[44]!==t.password||e[45]!==j?(N=s.jsx("input",{type:"password",value:t.password,onChange:j,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:ring-2 focus-visible:ring-ring focus-visible:outline-none"}),e[44]=t.password,e[45]=j,e[46]=N):N=e[46];let M;e[47]!==r.password?(M=r.password&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.password}),e[47]=r.password,e[48]=M):M=e[48];let C;e[49]!==N||e[50]!==M?(C=s.jsxs("div",{children:[X,N,M]}),e[49]=N,e[50]=M,e[51]=C):C=e[51];let Y;e[52]===Symbol.for("react.memo_cache_sentinel")?(Y=s.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Compañía"}),e[52]=Y):Y=e[52];let _;e[53]!==a?(_=i=>a("company",i),e[53]=a,e[54]=_):_=e[54];let Z;e[55]===Symbol.for("react.memo_cache_sentinel")?(Z=s.jsx(ue,{className:"w-full",children:s.jsx(pe,{placeholder:"Seleccione una Compañía"})}),e[55]=Z):Z=e[55];let I;e[56]===Symbol.for("react.memo_cache_sentinel")?(I=s.jsx(fe,{children:_e.map(we)}),e[56]=I):I=e[56];let w;e[57]!==t.company||e[58]!==_?(w=s.jsxs(de,{value:t.company,onValueChange:_,children:[Z,I]}),e[57]=t.company,e[58]=_,e[59]=w):w=e[59];let S;e[60]!==r.company?(S=r.company&&s.jsx("p",{className:"mt-1 text-xs text-destructive",children:r.company}),e[60]=r.company,e[61]=S):S=e[61];let k;e[62]!==w||e[63]!==S?(k=s.jsxs("div",{children:[Y,w,S]}),e[62]=w,e[63]=S,e[64]=k):k=e[64];let $;e[65]!==C||e[66]!==k?($=s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[C,k]}),e[65]=C,e[66]=k,e[67]=$):$=e[67];let q;e[68]!==y||e[69]!==$?(q=s.jsxs("div",{className:"space-y-4",children:[y,$]}),e[68]=y,e[69]=$,e[70]=q):q=e[70];let ee;e[71]===Symbol.for("react.memo_cache_sentinel")?(ee=s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(Ne,{className:"size-4"})," Roles y Permisos"]}),e[71]=ee):ee=e[71];let se;e[72]===Symbol.for("react.memo_cache_sentinel")?(se=s.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Rol del Sistema"}),e[72]=se):se=e[72];let P;e[73]!==a?(P=i=>a("role",i),e[73]=a,e[74]=P):P=e[74];let ie;e[75]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx(ue,{className:"w-full",children:s.jsx(pe,{placeholder:"Seleccione un Rol"})}),e[75]=ie):ie=e[75];let te;e[76]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsxs(fe,{children:[s.jsx(c,{value:"user",children:"Usuario (Por Defecto)"}),s.jsx(c,{value:"admin",children:"Administrador"}),s.jsx(c,{value:"capitan",children:"Capitán"}),s.jsx(c,{value:"teniente",children:"Teniente"}),s.jsx(c,{value:"maquinista",children:"Maquinista"}),s.jsx(c,{value:"ayudante",children:"Ayudante"}),s.jsx(c,{value:"cuartelero",children:"Cuartelero"}),s.jsx(c,{value:"mechanic",children:"Taller Mecánico"}),s.jsx(c,{value:"comandancia",children:"Comandancia"})]}),e[76]=te):te=e[76];let T;e[77]!==t.role||e[78]!==P?(T=s.jsxs("div",{className:"mb-6",children:[se,s.jsxs(de,{value:t.role,onValueChange:P,children:[ie,te]})]}),e[77]=t.role,e[78]=P,e[79]=T):T=e[79];let V;e[80]!==t.role||e[81]!==d||e[82]!==m?(V=t.role!=="admin"&&t.role!=="capitan"&&t.role!=="maquinista"&&s.jsxs("div",{children:[s.jsx("label",{className:"mb-3 block text-sm font-medium",children:"Permisos por Módulo"}),s.jsx("div",{className:"space-y-6",children:Ce.map(i=>s.jsxs("div",{className:"rounded-md border p-3",children:[s.jsx("h4",{className:"mb-2 text-sm font-semibold text-foreground",children:i}),s.jsx("table",{className:"w-full text-sm",children:s.jsx("tbody",{className:"divide-y",children:Me.filter(l=>l.category===i).map(l=>s.jsxs("tr",{children:[s.jsx("td",{className:"w-1/3 py-2.5 font-medium",children:l.label}),s.jsx("td",{className:"py-2",children:s.jsxs("div",{className:"flex gap-1 rounded-md bg-muted/50 p-1",children:[s.jsx("button",{type:"button",onClick:()=>m(l.id,"none"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${d(l.id)==="none"?"bg-background shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ninguno"}),s.jsx("button",{type:"button",onClick:()=>m(l.id,"view"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${d(l.id)==="view"?"bg-blue-100 text-blue-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Ver"}),s.jsx("button",{type:"button",onClick:()=>m(l.id,"edit"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${d(l.id)==="edit"?"bg-green-100 text-green-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Editar"}),(l.id==="vehicles"||l.id==="equipment")&&s.jsx("button",{type:"button",onClick:()=>m(l.id,"full"),className:`flex-1 rounded px-2 py-1 text-xs font-medium transition-colors ${d(l.id)==="full"?"bg-purple-100 text-purple-700 shadow-sm":"text-muted-foreground hover:bg-background/50"}`,children:"Total"})]})})]},l.id))})})]},i))}),s.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"'Editar' incluye permisos de 'Ver'."})]}),e[80]=t.role,e[81]=d,e[82]=m,e[83]=V):V=e[83];let A;e[84]!==T||e[85]!==V?(A=s.jsxs("div",{className:"rounded-lg border p-4",children:[ee,T,V]}),e[84]=T,e[85]=V,e[86]=A):A=e[86];let E;e[87]!==U||e[88]!==t.driver_vehicles||e[89]!==ne?(E=U&&U.length>0&&s.jsxs("div",{className:"rounded-lg border p-4",children:[s.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-medium",children:[s.jsx(ye,{className:"size-4"})," Vehículos Permitidos (Maquinistas)"]}),s.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Seleccione los vehículos que este usuario está autorizado a conducir y registrar en bitácora."}),s.jsx(ve,{className:"h-[200px] w-full rounded-md border p-4",children:s.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:U.map(i=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ge,{id:`v-${i.id}`,checked:t.driver_vehicles.includes(i.id),onCheckedChange:()=>ne(i.id)}),s.jsxs("label",{htmlFor:`v-${i.id}`,className:"text-sm leading-none font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[i.name," ",s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",i.company,")"]})]})]},i.id))})})]}),e[87]=U,e[88]=t.driver_vehicles,e[89]=ne,e[90]=E):E=e[90];let R;e[91]!==re?(R=s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{type:"submit",disabled:re,className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-8 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90 focus-visible:ring-2 focus-visible:ring-primary focus-visible:outline-none disabled:opacity-50",children:"Registrar Usuario"})}),e[91]=re,e[92]=R):R=e[92];let le;return e[93]!==oe||e[94]!==q||e[95]!==A||e[96]!==E||e[97]!==R?(le=s.jsxs(je,{breadcrumbs:J,children:[L,s.jsx("div",{className:"flex flex-col gap-6 p-4",children:s.jsxs("div",{className:"max-w-4xl rounded-xl border bg-card p-6 shadow-sm",children:[O,s.jsxs("form",{onSubmit:oe,className:"space-y-6",children:[q,A,E,R]})]})})]}),e[93]=oe,e[94]=q,e[95]=A,e[96]=E,e[97]=R,e[98]=le):le=e[98],le}function we(n){return s.jsx(c,{value:n,children:n},n)}function Se(n){return n.startsWith("equipment.")}function ke(n){return n==="equipment.view"||n==="equipment.edit"||n==="equipment.full"}export{He as default};
