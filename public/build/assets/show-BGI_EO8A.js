import{c as ct,u as ot,r as Gs,b as dt,j as s,a as Ms,H as mt}from"./app-Bei5yZXK.js";import{B as Vs}from"./badge-D8ZsYdIw.js";import{B as h,f as Us}from"./button-FN-48jhi.js";import{C as ee,b as se,c as te,a as le}from"./card-BIOLoEpn.js";import{C as Ks}from"./checkbox-CLjB0h2s.js";import{I as fs}from"./input-CihPr6mp.js";import{L as d}from"./label-CqIA9ImR.js";import{c as Js,S as Qs,a as Xs,b as Ys,d as et}from"./select-Csh1BGjL.js";import{S as Hs}from"./separator-DW9bsp4Q.js";import{F as ht,A as xt,W as ft}from"./app-layout-BqzotEN5.js";import{C as st}from"./circle-check-zRvdKoiJ.js";import{P as ut}from"./plus-B2mya_V1.js";import{T as Zs}from"./trash-2-DreJJhqG.js";import{P as pt}from"./printer-Dhq54xvQ.js";import{S as jt}from"./save-CSHOfcKi.js";import{C as gt}from"./calendar-BN9ltG32.js";/* empty css            */import"./index-BaJliO6e.js";import"./index-C-qd7BDO.js";import"./index-3WDlGcPi.js";import"./check-nONnlMoM.js";import"./chevron-down-CbbH5jdy.js";import"./index-C4J_hXM0.js";import"./shield-B26j6cfa.js";function Xt(r){const e=ct.c(224),{maintenance:t,inventoryItems:us}=r,tt=t.status,ps=t.tentative_exit_date||"";let ae;e[0]!==t.tasks?(ae=t.tasks.map(Ct),e[0]=t.tasks,e[1]=ae):ae=e[1];const js=ae;let ie;e[2]===Symbol.for("react.memo_cache_sentinel")?(ie=[],e[2]=ie):ie=e[2];let re;e[3]!==t.status||e[4]!==ps||e[5]!==js?(re={status:tt,tentative_exit_date:ps,tasks:js,resolved_issue_ids:ie},e[3]=t.status,e[4]=ps,e[5]=js,e[6]=re):re=e[6];const{data:a,setData:n,put:gs,processing:x}=ot(re);let ne;e[7]===Symbol.for("react.memo_cache_sentinel")?(ne={inventory_item_id:"",quantity:1},e[7]=ne):ne=e[7];const[m,vs]=Gs.useState(ne),[_s,bs]=Gs.useState(!1);let ce;e[8]===Symbol.for("react.memo_cache_sentinel")?(ce=["En Taller","Ingresado","Trabajando","En Espera de Repuestos","Pruebas Finales","Finalizado","Entregado"],e[8]=ce):ce=e[8];const lt=ce;let oe;e[9]!==t.id||e[10]!==gs?(oe=l=>{l.preventDefault(),gs(`/vehicles/workshop/${t.id}`)},e[9]=t.id,e[10]=gs,e[11]=oe):oe=e[11];const Ns=oe;let de;e[12]!==a.tasks||e[13]!==n?(de=l=>{const c=[...a.tasks];c[l].is_completed=!c[l].is_completed,n("tasks",c)},e[12]=a.tasks,e[13]=n,e[14]=de):de=e[14];const J=de;let me;e[15]!==a.tasks||e[16]!==n?(me=(l,c)=>{const o=[...a.tasks];o[l].cost=c?parseFloat(c):null,n("tasks",o)},e[15]=a.tasks,e[16]=n,e[17]=me):me=e[17];const Q=me;let he;e[18]!==a.tasks||e[19]!==n?(he=(l,c)=>{const o=[...a.tasks];o[l].description=c,n("tasks",o)},e[18]=a.tasks,e[19]=n,e[20]=he):he=e[20];const X=he;let xe;e[21]!==a.tasks||e[22]!==n?(xe=()=>{n("tasks",[...a.tasks,{description:"",is_completed:!1,cost:null}])},e[21]=a.tasks,e[22]=n,e[23]=xe):xe=e[23];const ys=xe;let fe;e[24]!==a.tasks||e[25]!==n?(fe=l=>{const c=a.tasks.filter((o,Z)=>Z!==l);n("tasks",c)},e[24]=a.tasks,e[25]=n,e[26]=fe):fe=e[26];const Y=fe;let ue;e[27]!==a.resolved_issue_ids||e[28]!==n?(ue=l=>{const c=a.resolved_issue_ids;c.includes(l)?n("resolved_issue_ids",c.filter(o=>o!==l)):n("resolved_issue_ids",[...c,l])},e[27]=a.resolved_issue_ids,e[28]=n,e[29]=ue):ue=e[29];const ks=ue;let pe;e[30]!==m||e[31]!==t.id?(pe=l=>{l.preventDefault(),!(!m.inventory_item_id||m.quantity<1)&&(bs(!0),Ms.post(`/vehicles/maintenance/${t.id}/items`,m,{onSuccess:()=>{vs({inventory_item_id:"",quantity:1}),bs(!1)},onError:()=>bs(!1),preserveScroll:!0}))},e[30]=m,e[31]=t.id,e[32]=pe):pe=e[32];const Ss=pe;let je;e[33]!==t.id?(je=l=>{confirm("¿Eliminar este ítem de la orden?")&&Ms.delete(`/vehicles/maintenance/${t.id}/items/${l}`,{preserveScroll:!0})},e[33]=t.id,e[34]=je):je=e[34];const Cs=je,Ws=a.tasks.reduce(St,0),ws=t.items?.reduce(kt,0)||0,Ts=Ws+ws;let ge;e[35]!==a.tasks?(ge=a.tasks.filter(yt),e[35]=a.tasks,e[36]=ge):ge=e[36];const Is=ge.length,{auth:at}=dt().props,i=at.user.role==="maquinista";let ve,_e;e[37]===Symbol.for("react.memo_cache_sentinel")?(ve={title:"Panel Principal",href:"/dashboard"},_e={title:"Taller Mecánico",href:"/vehicles/workshop"},e[37]=ve,e[38]=_e):(ve=e[37],_e=e[38]);const $s=`Orden #${t.id}`,Fs=`/vehicles/workshop/${t.id}`;let be;e[39]!==$s||e[40]!==Fs?(be=[ve,_e,{title:$s,href:Fs}],e[39]=$s,e[40]=Fs,e[41]=be):be=e[41];const Es=`Orden de Trabajo #${t.id}`;let Ne;e[42]!==Es?(Ne=s.jsx(mt,{title:Es}),e[42]=Es,e[43]=Ne):Ne=e[43];let ye;e[44]===Symbol.for("react.memo_cache_sentinel")?(ye=s.jsx(ft,{className:"h-6 w-6"}),e[44]=ye):ye=e[44];let f;e[45]!==t.id?(f=s.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-bold",children:[ye,"Orden de Trabajo #",t.id]}),e[45]=t.id,e[46]=f):f=e[46];let u;e[47]!==t.vehicle.company||e[48]!==t.vehicle.name||e[49]!==t.vehicle.plate?(u=s.jsxs("p",{className:"text-muted-foreground",children:[t.vehicle.name," -"," ",t.vehicle.plate," (",t.vehicle.company,")"]}),e[47]=t.vehicle.company,e[48]=t.vehicle.name,e[49]=t.vehicle.plate,e[50]=u):u=e[50];let p;e[51]!==f||e[52]!==u?(p=s.jsxs("div",{children:[f,u]}),e[51]=f,e[52]=u,e[53]=p):p=e[53];let j;e[54]!==t.id||e[55]!==t.status?(j=(t.status==="Finalizado"||t.status==="Entregado")&&s.jsx(h,{variant:"outline",asChild:!0,className:"border-green-600 text-green-600 hover:bg-green-50",children:s.jsxs("a",{href:`/vehicles/workshop/${t.id}/print-exit`,target:"_blank",rel:"noopener noreferrer",children:[s.jsx(ht,{className:"mr-2 h-4 w-4"}),"Imprimir Salida"]})}),e[54]=t.id,e[55]=t.status,e[56]=j):j=e[56];const Rs=`/vehicles/workshop/${t.id}/print`;let ke,Se,Ce;e[57]===Symbol.for("react.memo_cache_sentinel")?(ke=s.jsx(pt,{className:"mr-2 h-4 w-4"}),Se=s.jsx("span",{className:"hidden sm:inline",children:"Imprimir Orden"}),Ce=s.jsx("span",{className:"sm:hidden",children:"Imprimir"}),e[57]=ke,e[58]=Se,e[59]=Ce):(ke=e[57],Se=e[58],Ce=e[59]);let g;e[60]!==Rs?(g=s.jsx(h,{variant:"outline",asChild:!0,children:s.jsxs("a",{href:Rs,target:"_blank",rel:"noopener noreferrer",children:[ke,Se,Ce]})}),e[60]=Rs,e[61]=g):g=e[61];let v;e[62]!==Ns||e[63]!==i||e[64]!==x?(v=!i&&s.jsxs(h,{onClick:Ns,disabled:x,children:[s.jsx(jt,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Guardar Cambios"})]}),e[62]=Ns,e[63]=i,e[64]=x,e[65]=v):v=e[65];let _;e[66]!==a||e[67]!==i||e[68]!==t.id||e[69]!==t.status||e[70]!==x?(_=!i&&t.status!=="Finalizado"&&t.status!=="Entregado"&&s.jsxs(h,{variant:"destructive",onClick:()=>{confirm("¿Está seguro de finalizar el trabajo? Esto resolverá las incidencias marcadas y generará el documento de salida.")&&Ms.put(`/vehicles/workshop/${t.id}`,{...a,status:"Finalizado"})},disabled:x,children:[s.jsx(st,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Finalizar"})]}),e[66]=a,e[67]=i,e[68]=t.id,e[69]=t.status,e[70]=x,e[71]=_):_=e[71];let b;e[72]!==j||e[73]!==g||e[74]!==v||e[75]!==_?(b=s.jsxs("div",{className:"flex gap-2",children:[j,g,v,_]}),e[72]=j,e[73]=g,e[74]=v,e[75]=_,e[76]=b):b=e[76];let we;e[77]!==p||e[78]!==b?(we=s.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[p,b]}),e[77]=p,e[78]=b,e[79]=we):we=e[79];let Te;e[80]===Symbol.for("react.memo_cache_sentinel")?(Te=s.jsx(ee,{children:s.jsx(le,{children:"Estado y Fechas"})}),e[80]=Te):Te=e[80];let Ie;e[81]===Symbol.for("react.memo_cache_sentinel")?(Ie=s.jsx(d,{children:"Estado Actual"}),e[81]=Ie):Ie=e[81];let N;e[82]!==n?(N=l=>n("status",l),e[82]=n,e[83]=N):N=e[83];let $e;e[84]===Symbol.for("react.memo_cache_sentinel")?($e=s.jsx(Xs,{children:s.jsx(Ys,{})}),e[84]=$e):$e=e[84];let Fe;e[85]===Symbol.for("react.memo_cache_sentinel")?(Fe=s.jsx(Js,{children:lt.map(Nt)}),e[85]=Fe):Fe=e[85];let y;e[86]!==a.status||e[87]!==i||e[88]!==N?(y=s.jsxs("div",{className:"space-y-2",children:[Ie,s.jsxs(Qs,{value:a.status,onValueChange:N,disabled:i,children:[$e,Fe]})]}),e[86]=a.status,e[87]=i,e[88]=N,e[89]=y):y=e[89];let Ee;e[90]===Symbol.for("react.memo_cache_sentinel")?(Ee=s.jsx(d,{children:"Fecha de Ingreso"}),e[90]=Ee):Ee=e[90];let Re;e[91]===Symbol.for("react.memo_cache_sentinel")?(Re=s.jsx(gt,{className:"h-4 w-4"}),e[91]=Re):Re=e[91];let k;e[92]!==t.entry_date?(k=Us(t.entry_date),e[92]=t.entry_date,e[93]=k):k=e[93];let S;e[94]!==k?(S=s.jsxs("div",{className:"space-y-2",children:[Ee,s.jsxs("div",{className:"flex items-center gap-2 rounded border bg-muted/50 p-2 text-sm",children:[Re,k]})]}),e[94]=k,e[95]=S):S=e[95];let Le;e[96]===Symbol.for("react.memo_cache_sentinel")?(Le=s.jsx(d,{children:"Fecha Tentativa Salida"}),e[96]=Le):Le=e[96];let C;e[97]!==n?(C=l=>n("tentative_exit_date",l.target.value),e[97]=n,e[98]=C):C=e[98];let w;e[99]!==a.tentative_exit_date||e[100]!==i||e[101]!==C?(w=s.jsxs("div",{className:"space-y-2",children:[Le,s.jsx(fs,{type:"date",value:a.tentative_exit_date,onChange:C,disabled:i})]}),e[99]=a.tentative_exit_date,e[100]=i,e[101]=C,e[102]=w):w=e[102];let ze;e[103]===Symbol.for("react.memo_cache_sentinel")?(ze=s.jsx(Hs,{}),e[103]=ze):ze=e[103];let Pe;e[104]===Symbol.for("react.memo_cache_sentinel")?(Pe=s.jsx(d,{children:"Taller / Proveedor"}),e[104]=Pe):Pe=e[104];let T;e[105]!==t.workshop_name?(T=s.jsxs("div",{className:"space-y-2",children:[Pe,s.jsx("p",{className:"font-medium",children:t.workshop_name})]}),e[105]=t.workshop_name,e[106]=T):T=e[106];let I;e[107]!==y||e[108]!==S||e[109]!==w||e[110]!==T?(I=s.jsxs(se,{children:[Te,s.jsxs(te,{className:"space-y-4",children:[y,S,w,ze,T]})]}),e[107]=y,e[108]=S,e[109]=w,e[110]=T,e[111]=I):I=e[111];let Oe;e[112]===Symbol.for("react.memo_cache_sentinel")?(Oe=s.jsx(ee,{children:s.jsx(le,{className:"text-base",children:"Detalles del Ingreso"})}),e[112]=Oe):Oe=e[112];let Ae;e[113]===Symbol.for("react.memo_cache_sentinel")?(Ae=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Responsable"}),e[113]=Ae):Ae=e[113];const Ls=t.responsible_person||"-";let $;e[114]!==Ls?($=s.jsxs("div",{children:[Ae,s.jsx("p",{className:"font-medium",children:Ls})]}),e[114]=Ls,e[115]=$):$=e[115];let De;e[116]===Symbol.for("react.memo_cache_sentinel")?(De=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Kilometraje"}),e[116]=De):De=e[116];const zs=t.mileage_in?`${t.mileage_in} km`:"-";let F;e[117]!==zs?(F=s.jsxs("div",{children:[De,s.jsx("p",{className:"font-medium",children:zs})]}),e[117]=zs,e[118]=F):F=e[118];let qe;e[119]===Symbol.for("react.memo_cache_sentinel")?(qe=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Tracción"}),e[119]=qe):qe=e[119];const Ps=t.traction||"-";let E;e[120]!==Ps?(E=s.jsxs("div",{children:[qe,s.jsx("p",{className:"font-medium",children:Ps})]}),e[120]=Ps,e[121]=E):E=e[121];let Be;e[122]===Symbol.for("react.memo_cache_sentinel")?(Be=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Transmisión"}),e[122]=Be):Be=e[122];const Os=t.transmission||"-";let R;e[123]!==Os?(R=s.jsxs("div",{children:[Be,s.jsx("p",{className:"font-medium",children:Os})]}),e[123]=Os,e[124]=R):R=e[124];let Me;e[125]===Symbol.for("react.memo_cache_sentinel")?(Me=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Combustible"}),e[125]=Me):Me=e[125];const As=t.fuel_type||"-";let L;e[126]!==As?(L=s.jsxs("div",{className:"col-span-2",children:[Me,s.jsx("p",{className:"font-medium",children:As})]}),e[126]=As,e[127]=L):L=e[127];let z;e[128]!==$||e[129]!==F||e[130]!==E||e[131]!==R||e[132]!==L?(z=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[$,F,E,R,L]}),e[128]=$,e[129]=F,e[130]=E,e[131]=R,e[132]=L,e[133]=z):z=e[133];let P;e[134]!==t.entry_checklist?(P=t.entry_checklist&&s.jsxs("div",{className:"mt-4",children:[s.jsx(d,{className:"mb-2 block text-xs text-muted-foreground",children:"Checklist de Recepción (Fallas)"}),s.jsx("div",{className:"space-y-1 rounded border p-2",children:(()=>{const l=Object.entries(t.entry_checklist).filter(bt);return l.length===0?s.jsx("p",{className:"text-xs text-muted-foreground",children:"No se reportaron fallas en el ingreso."}):l.map(_t)})()})]}),e[134]=t.entry_checklist,e[135]=P):P=e[135];let O;e[136]!==z||e[137]!==P?(O=s.jsxs(se,{children:[Oe,s.jsxs(te,{className:"space-y-4 text-sm",children:[z,P]})]}),e[136]=z,e[137]=P,e[138]=O):O=e[138];let Ve;e[139]===Symbol.for("react.memo_cache_sentinel")?(Ve=s.jsx(ee,{children:s.jsx(le,{className:"text-base",children:"Incidencias Vinculadas"})}),e[139]=Ve):Ve=e[139];let A;e[140]!==a.resolved_issue_ids||e[141]!==i||e[142]!==t.issues||e[143]!==ks?(A=t.issues.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay incidencias vinculadas."}):t.issues.map(l=>s.jsxs("div",{className:"flex items-start gap-2 rounded border p-2",children:[s.jsx(Ks,{checked:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id),disabled:i||l.status==="Resolved",onCheckedChange:()=>ks(l.id)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium",children:l.description}),s.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-muted-foreground",children:Us(l.date)}),s.jsx(Vs,{variant:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id)?"default":"secondary",children:l.status==="Resolved"?"Resuelto":a.resolved_issue_ids.includes(l.id)?"Marcado para Resolver":"Pendiente"})]})]})]},l.id)),e[140]=a.resolved_issue_ids,e[141]=i,e[142]=t.issues,e[143]=ks,e[144]=A):A=e[144];let D;e[145]!==A?(D=s.jsxs(se,{children:[Ve,s.jsx(te,{className:"space-y-3",children:A})]}),e[145]=A,e[146]=D):D=e[146];let He;e[147]!==I||e[148]!==O||e[149]!==D?(He=s.jsxs("div",{className:"space-y-6 lg:col-span-1",children:[I,O,D]}),e[147]=I,e[148]=O,e[149]=D,e[150]=He):He=e[150];let We;e[151]===Symbol.for("react.memo_cache_sentinel")?(We=s.jsx(le,{children:"Repuestos e Insumos Utilizados"}),e[151]=We):We=e[151];const Ds=t.items?.length||0;let Ge;e[152]!==Ds?(Ge=s.jsxs(ee,{className:"flex flex-row items-center justify-between",children:[We,s.jsxs(Vs,{variant:"secondary",className:"text-base",children:[Ds," Ítems"]})]}),e[152]=Ds,e[153]=Ge):Ge=e[153];let Ue;e[154]!==Ss||e[155]!==m||e[156]!==us||e[157]!==_s||e[158]!==i||e[159]!==t.status?(Ue=!i&&t.status!=="Finalizado"&&s.jsxs("div",{className:"flex items-end gap-2 rounded bg-muted/30 p-4",children:[s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx(d,{children:"Item de Bodega"}),s.jsxs(Qs,{value:m.inventory_item_id.toString(),onValueChange:l=>vs({...m,inventory_item_id:l}),children:[s.jsx(Xs,{children:s.jsx(Ys,{placeholder:"Seleccionar ítem..."})}),s.jsx(Js,{children:us.map(vt)})]})]}),s.jsxs("div",{className:"w-24 space-y-2",children:[s.jsx(d,{children:"Cantidad"}),s.jsx(fs,{type:"number",min:"1",value:m.quantity,onChange:l=>vs({...m,quantity:parseInt(l.target.value)||1})})]}),s.jsxs(h,{onClick:Ss,disabled:_s||!m.inventory_item_id,children:[s.jsx(ut,{className:"mr-2 h-4 w-4"}),"Agregar"]})]}),e[154]=Ss,e[155]=m,e[156]=us,e[157]=_s,e[158]=i,e[159]=t.status,e[160]=Ue):Ue=e[160];let Ke,Je,Qe,Xe;e[161]===Symbol.for("react.memo_cache_sentinel")?(Ke=s.jsx("th",{className:"p-3 font-medium",children:"Ítem"}),Je=s.jsx("th",{className:"p-3 text-right font-medium",children:"Cant."}),Qe=s.jsx("th",{className:"p-3 text-right font-medium",children:"Costo Unit."}),Xe=s.jsx("th",{className:"p-3 text-right font-medium",children:"Total"}),e[161]=Ke,e[162]=Je,e[163]=Qe,e[164]=Xe):(Ke=e[161],Je=e[162],Qe=e[163],Xe=e[164]);let q;e[165]!==i?(q=!i&&s.jsx("th",{className:"w-[50px] p-3 text-right font-medium text-muted-foreground"}),e[165]=i,e[166]=q):q=e[166];let Ye;e[167]!==q?(Ye=s.jsx("thead",{children:s.jsxs("tr",{className:"border-b bg-muted/50 text-left",children:[Ke,Je,Qe,Xe,q]})}),e[167]=q,e[168]=Ye):Ye=e[168];let B;e[169]!==Cs||e[170]!==i||e[171]!==t.items?(B=!t.items||t.items.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"p-4 text-center text-muted-foreground",children:"No se han utilizado repuestos."})}):t.items.map(l=>s.jsxs("tr",{className:"border-b last:border-0",children:[s.jsxs("td",{className:"p-3",children:[s.jsx("div",{className:"font-medium",children:l.name}),s.jsx("div",{className:"text-xs text-muted-foreground",children:l.sku})]}),s.jsx("td",{className:"p-3 text-right",children:l.pivot.quantity}),s.jsxs("td",{className:"p-3 text-right",children:["$",l.pivot.unit_cost.toLocaleString("es-CL")]}),s.jsxs("td",{className:"p-3 text-right font-medium",children:["$",l.pivot.total_cost.toLocaleString("es-CL")]}),!i&&s.jsx("td",{className:"p-3 text-right",children:s.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:bg-destructive/10",onClick:()=>Cs(l.id),children:s.jsx(Zs,{className:"h-4 w-4"})})})]},l.id)),e[169]=Cs,e[170]=i,e[171]=t.items,e[172]=B):B=e[172];let Ze;e[173]!==B?(Ze=s.jsx("tbody",{children:B}),e[173]=B,e[174]=Ze):Ze=e[174];let es;e[175]===Symbol.for("react.memo_cache_sentinel")?(es=s.jsx("td",{colSpan:3,className:"p-3 text-right font-semibold",children:"Total Repuestos:"}),e[175]=es):es=e[175];let ss;e[176]!==i?(ss=!i&&s.jsx("td",{}),e[176]=i,e[177]=ss):ss=e[177];let ts;e[178]===Symbol.for("react.memo_cache_sentinel")?(ts=s.jsx(le,{children:"Lista de Trabajos (Mano de Obra)"}),e[178]=ts):ts=e[178];let ls;e[179]!==Is||e[180]!==a.tasks.length?(ls=s.jsxs(ee,{className:"flex flex-row items-center justify-between",children:[ts,s.jsxs(Vs,{variant:"outline",className:"text-base",children:["Progreso: ",Is," /"," ",a.tasks.length]})]}),e[179]=Is,e[180]=a.tasks.length,e[181]=ls):ls=e[181];let as;e[182]===Symbol.for("react.memo_cache_sentinel")?(as=s.jsx(d,{children:"Descripción General / Observaciones"}),e[182]=as):as=e[182];const qs=t.description||"Sin observaciones generales.";let is;e[183]!==qs?(is=s.jsxs("div",{className:"space-y-2",children:[as,s.jsx("p",{className:"min-h-[60px] rounded border bg-muted p-3 text-sm text-muted-foreground",children:qs})]}),e[183]=qs,e[184]=is):is=e[184];let rs;e[185]===Symbol.for("react.memo_cache_sentinel")?(rs=s.jsx(Hs,{}),e[185]=rs):rs=e[185];let ns;e[186]===Symbol.for("react.memo_cache_sentinel")?(ns=s.jsx(d,{className:"text-base font-semibold",children:"Tareas Específicas"}),e[186]=ns):ns=e[186];let M;e[187]!==ys||e[188]!==i?(M=!i&&s.jsx(h,{size:"sm",variant:"secondary",onClick:ys,type:"button",children:"+ Agregar Tarea"}),e[187]=ys,e[188]=i,e[189]=M):M=e[189];let V;e[190]!==M?(V=s.jsxs("div",{className:"flex items-center justify-between",children:[ns,M]}),e[190]=M,e[191]=V):V=e[191];let H;e[192]!==a.tasks.length?(H=a.tasks.length===0&&s.jsx("p",{className:"rounded border-2 border-dashed py-8 text-center text-muted-foreground",children:"No hay tareas registradas. Agrega una para comenzar el seguimiento."}),e[192]=a.tasks.length,e[193]=H):H=e[193];let W;if(e[194]!==a.tasks||e[195]!==i||e[196]!==Y||e[197]!==J||e[198]!==Q||e[199]!==X){let l;e[201]!==i||e[202]!==Y||e[203]!==J||e[204]!==Q||e[205]!==X?(l=(c,o)=>s.jsxs("div",{className:"flex flex-col items-start gap-3 rounded border bg-card p-3 transition-colors hover:bg-accent/5 md:flex-row md:items-center",children:[s.jsx(Ks,{checked:c.is_completed,onCheckedChange:()=>J(o),disabled:i,className:"mt-1 md:mt-0"}),s.jsxs("div",{className:"w-full flex-1 space-y-2 md:flex md:gap-4 md:space-y-0",children:[s.jsx(fs,{value:c.description,onChange:Z=>X(o,Z.target.value),placeholder:"Descripción de la tarea",disabled:i,className:c.is_completed?"text-muted-foreground line-through":""}),s.jsxs("div",{className:"flex w-full items-center gap-2 md:w-32",children:[s.jsx("span",{className:"text-sm font-semibold text-muted-foreground",children:"$"}),s.jsx(fs,{type:"number",value:c.cost??"",onChange:Z=>Q(o,Z.target.value),placeholder:"Costo",disabled:i})]})]}),!i&&s.jsx(h,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>Y(o),type:"button",children:s.jsx(Zs,{className:"h-4 w-4"})})]},o),e[201]=i,e[202]=Y,e[203]=J,e[204]=Q,e[205]=X,e[206]=l):l=e[206],W=a.tasks.map(l),e[194]=a.tasks,e[195]=i,e[196]=Y,e[197]=J,e[198]=Q,e[199]=X,e[200]=W}else W=e[200];let cs;e[207]!==V||e[208]!==H||e[209]!==W?(cs=s.jsxs("div",{className:"space-y-4",children:[V,H,W]}),e[207]=V,e[208]=H,e[209]=W,e[210]=cs):cs=e[210];let os;e[211]===Symbol.for("react.memo_cache_sentinel")?(os=s.jsx(Hs,{}),e[211]=os):os=e[211];let ds;e[212]===Symbol.for("react.memo_cache_sentinel")?(ds=s.jsx("span",{className:"text-sm",children:"Total Mano de Obra:"}),e[212]=ds):ds=e[212];const it="flex items-center justify-end gap-4 text-muted-foreground";let G;e[213]===Symbol.for("react.memo_cache_sentinel")?(G=s.jsx("span",{className:"text-sm",children:"Total Repuestos:"}),e[213]=G):G=e[213];const rt="font-semibold",nt="$",Bs=ws.toLocaleString("es-CL");let U;e[214]!==Bs?(U=s.jsxs("span",{className:rt,children:[nt,Bs]}),e[214]=Bs,e[215]=U):U=e[215];let ms;e[216]!==G||e[217]!==U?(ms=s.jsxs("div",{className:it,children:[G,U]}),e[216]=G,e[217]=U,e[218]=ms):ms=e[218];let hs;e[219]===Symbol.for("react.memo_cache_sentinel")?(hs=s.jsx("span",{className:"text-lg font-bold",children:"Costo Total Estimado:"}),e[219]=hs):hs=e[219];let K;e[220]!==Ts?(K=Ts.toLocaleString("es-CL"),e[220]=Ts,e[221]=K):K=e[221];let xs;return e[222]!==K?(xs=s.jsxs("div",{className:"flex items-center justify-end gap-4 border-t pt-2",children:[hs,s.jsxs("span",{className:"text-2xl font-bold text-primary",children:["$",K]})]}),e[222]=K,e[223]=xs):xs=e[223],s.jsxs(xt,{breadcrumbs:be,children:[Ne,s.jsxs("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-6 p-4",children:[we,s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[He,s.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[s.jsxs(se,{children:[Ge,s.jsxs(te,{className:"space-y-6",children:[Ue,s.jsx("div",{className:"rounded-md border",children:s.jsxs("table",{className:"w-full text-sm",children:[Ye,Ze,s.jsx("tfoot",{className:"bg-muted/20",children:s.jsxs("tr",{children:[es,s.jsxs("td",{className:"p-3 text-right font-bold",children:["$",ws.toLocaleString("es-CL")]}),ss]})})]})})]})]}),s.jsxs(se,{children:[ls,s.jsxs(te,{className:"space-y-4",children:[is,rs,cs,os,s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-end gap-4 text-muted-foreground",children:[ds,s.jsxs("span",{className:"font-semibold",children:["$",Ws.toLocaleString("es-CL")]})]}),ms,xs]})]})]})]})]})]})]})}function vt(r){return s.jsxs(et,{value:r.id.toString(),children:[r.name," ","(",r.sku,") - Stock:"," ",r.stock]},r.id)}function _t(r){const[e]=r;return s.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-600",children:[s.jsx(st,{className:"h-3 w-3"}),s.jsx("span",{children:e})]},e)}function bt(r){const[,e]=r;return e==="Fallas"}function Nt(r){return s.jsx(et,{value:r,children:r},r)}function yt(r){return r.is_completed}function kt(r,e){return r+(e.pivot.total_cost||0)}function St(r,e){return r+(e.cost||0)}function Ct(r){return{...r,cost:r.cost?Number(r.cost):null}}export{Xt as default};
