import{c as ot,u as dt,r as Ks,b as mt,j as s,a as Vs,H as ht}from"./app-lrD-X_g2.js";import{B as Hs}from"./badge-CNMh2flQ.js";import{B as x,f as Js}from"./button-C30YfVAU.js";import{C as se,b as te,c as le,a as ae}from"./card-CeLWOmyr.js";import{C as Qs}from"./checkbox-QaA0FavS.js";import{D as xt,C as ft,f as ut}from"./date-picker-D4LxhZpU.js";import{I as Ws}from"./input-u8KO988D.js";import{L as d}from"./label-BoHnEJCk.js";import{c as Xs,S as Ys,a as Zs,b as et,d as tt}from"./select-CyJ-A37M.js";import{S as Gs}from"./separator-xxtTGl8V.js";import{F as pt,A as jt,W as vt}from"./app-layout-B-w059ge.js";import{C as lt}from"./circle-check-DqAuizZn.js";import{P as gt}from"./plus-DUGX3CSH.js";import{T as st}from"./trash-2-Dqx59gL-.js";import{P as _t}from"./printer-Dib0GYK2.js";import{S as bt}from"./save-CxuCcnXU.js";/* empty css            */import"./index-D28iW8MQ.js";import"./index-BxHzOl0z.js";import"./index-zozu2mmz.js";import"./check-KNjNtnR0.js";import"./chevron-left-BvRJ8iXd.js";import"./popover-BVeNiosq.js";import"./chevron-down-DC4OJ025.js";import"./index-C4J_hXM0.js";import"./shield-DP_TgMF-.js";function ll(r){const e=ot.c(227),{maintenance:t,inventoryItems:ps}=r,at=t.status,js=t.tentative_exit_date||"";let ie;e[0]!==t.tasks?(ie=t.tasks.map(It),e[0]=t.tasks,e[1]=ie):ie=e[1];const vs=ie;let re;e[2]===Symbol.for("react.memo_cache_sentinel")?(re=[],e[2]=re):re=e[2];let ne;e[3]!==t.status||e[4]!==js||e[5]!==vs?(ne={status:at,tentative_exit_date:js,tasks:vs,resolved_issue_ids:re},e[3]=t.status,e[4]=js,e[5]=vs,e[6]=ne):ne=e[6];const{data:a,setData:n,put:gs,processing:f}=dt(ne);let ce;e[7]===Symbol.for("react.memo_cache_sentinel")?(ce={inventory_item_id:"",quantity:1},e[7]=ce):ce=e[7];const[m,_s]=Ks.useState(ce),[bs,Ns]=Ks.useState(!1);let oe;e[8]===Symbol.for("react.memo_cache_sentinel")?(oe=["En Taller","Ingresado","Trabajando","En Espera de Repuestos","Pruebas Finales","Finalizado","Entregado"],e[8]=oe):oe=e[8];const it=oe;let de;e[9]!==t.id||e[10]!==gs?(de=l=>{l.preventDefault(),gs(`/vehicles/workshop/${t.id}`)},e[9]=t.id,e[10]=gs,e[11]=de):de=e[11];const ys=de;let me;e[12]!==a.tasks||e[13]!==n?(me=l=>{const c=[...a.tasks];c[l].is_completed=!c[l].is_completed,n("tasks",c)},e[12]=a.tasks,e[13]=n,e[14]=me):me=e[14];const Q=me;let he;e[15]!==a.tasks||e[16]!==n?(he=(l,c)=>{const o=[...a.tasks];o[l].cost=c?parseFloat(c):null,n("tasks",o)},e[15]=a.tasks,e[16]=n,e[17]=he):he=e[17];const X=he;let xe;e[18]!==a.tasks||e[19]!==n?(xe=(l,c)=>{const o=[...a.tasks];o[l].description=c,n("tasks",o)},e[18]=a.tasks,e[19]=n,e[20]=xe):xe=e[20];const Y=xe;let fe;e[21]!==a.tasks||e[22]!==n?(fe=()=>{n("tasks",[...a.tasks,{description:"",is_completed:!1,cost:null}])},e[21]=a.tasks,e[22]=n,e[23]=fe):fe=e[23];const ks=fe;let ue;e[24]!==a.tasks||e[25]!==n?(ue=l=>{const c=a.tasks.filter((o,ee)=>ee!==l);n("tasks",c)},e[24]=a.tasks,e[25]=n,e[26]=ue):ue=e[26];const Z=ue;let pe;e[27]!==a.resolved_issue_ids||e[28]!==n?(pe=l=>{const c=a.resolved_issue_ids;c.includes(l)?n("resolved_issue_ids",c.filter(o=>o!==l)):n("resolved_issue_ids",[...c,l])},e[27]=a.resolved_issue_ids,e[28]=n,e[29]=pe):pe=e[29];const Ss=pe;let je;e[30]!==m||e[31]!==t.id?(je=l=>{l.preventDefault(),!(!m.inventory_item_id||m.quantity<1)&&(Ns(!0),Vs.post(`/vehicles/maintenance/${t.id}/items`,m,{onSuccess:()=>{_s({inventory_item_id:"",quantity:1}),Ns(!1)},onError:()=>Ns(!1),preserveScroll:!0}))},e[30]=m,e[31]=t.id,e[32]=je):je=e[32];const Cs=je;let ve;e[33]!==t.id?(ve=l=>{confirm("¿Eliminar este ítem de la orden?")&&Vs.delete(`/vehicles/maintenance/${t.id}/items/${l}`,{preserveScroll:!0})},e[33]=t.id,e[34]=ve):ve=e[34];const ws=ve,Us=a.tasks.reduce(Tt,0),Ts=t.items?.reduce(wt,0)||0,Is=Us+Ts;let ge;e[35]!==a.tasks?(ge=a.tasks.filter(Ct),e[35]=a.tasks,e[36]=ge):ge=e[36];const Es=ge.length,{auth:h}=mt().props;let _e;e[37]!==h.user.permissions||e[38]!==h.user.role?(_e=h.user.role==="admin"||h.user.role==="mechanic"||h.user.permissions&&h.user.permissions.includes("vehicles.workshop.edit"),e[37]=h.user.permissions,e[38]=h.user.role,e[39]=_e):_e=e[39];const i=!_e;let be,Ne;e[40]===Symbol.for("react.memo_cache_sentinel")?(be={title:"Panel Principal",href:"/dashboard"},Ne={title:"Taller Mecánico",href:"/vehicles/workshop"},e[40]=be,e[41]=Ne):(be=e[40],Ne=e[41]);const $s=`Orden #${t.id}`,Fs=`/vehicles/workshop/${t.id}`;let ye;e[42]!==$s||e[43]!==Fs?(ye=[be,Ne,{title:$s,href:Fs}],e[42]=$s,e[43]=Fs,e[44]=ye):ye=e[44];const Rs=`Orden de Trabajo #${t.id}`;let ke;e[45]!==Rs?(ke=s.jsx(ht,{title:Rs}),e[45]=Rs,e[46]=ke):ke=e[46];let Se;e[47]===Symbol.for("react.memo_cache_sentinel")?(Se=s.jsx(vt,{className:"h-6 w-6"}),e[47]=Se):Se=e[47];let u;e[48]!==t.id?(u=s.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-bold",children:[Se,"Orden de Trabajo #",t.id]}),e[48]=t.id,e[49]=u):u=e[49];let p;e[50]!==t.vehicle.company||e[51]!==t.vehicle.name||e[52]!==t.vehicle.plate?(p=s.jsxs("p",{className:"text-muted-foreground",children:[t.vehicle.name," -"," ",t.vehicle.plate," (",t.vehicle.company,")"]}),e[50]=t.vehicle.company,e[51]=t.vehicle.name,e[52]=t.vehicle.plate,e[53]=p):p=e[53];let j;e[54]!==u||e[55]!==p?(j=s.jsxs("div",{children:[u,p]}),e[54]=u,e[55]=p,e[56]=j):j=e[56];let v;e[57]!==t.id||e[58]!==t.status?(v=(t.status==="Finalizado"||t.status==="Entregado")&&s.jsx(x,{variant:"outline",asChild:!0,className:"border-green-600 text-green-600 hover:bg-green-50",children:s.jsxs("a",{href:`/vehicles/workshop/${t.id}/print-exit`,target:"_blank",rel:"noopener noreferrer",children:[s.jsx(pt,{className:"mr-2 h-4 w-4"}),"Imprimir Salida"]})}),e[57]=t.id,e[58]=t.status,e[59]=v):v=e[59];const Ls=`/vehicles/workshop/${t.id}/print`;let Ce,we,Te;e[60]===Symbol.for("react.memo_cache_sentinel")?(Ce=s.jsx(_t,{className:"mr-2 h-4 w-4"}),we=s.jsx("span",{className:"hidden sm:inline",children:"Imprimir Orden"}),Te=s.jsx("span",{className:"sm:hidden",children:"Imprimir"}),e[60]=Ce,e[61]=we,e[62]=Te):(Ce=e[60],we=e[61],Te=e[62]);let g;e[63]!==Ls?(g=s.jsx(x,{variant:"outline",asChild:!0,children:s.jsxs("a",{href:Ls,target:"_blank",rel:"noopener noreferrer",children:[Ce,we,Te]})}),e[63]=Ls,e[64]=g):g=e[64];let _;e[65]!==ys||e[66]!==i||e[67]!==f?(_=!i&&s.jsxs(x,{onClick:ys,disabled:f,children:[s.jsx(bt,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Guardar Cambios"})]}),e[65]=ys,e[66]=i,e[67]=f,e[68]=_):_=e[68];let b;e[69]!==a||e[70]!==i||e[71]!==t.id||e[72]!==t.status||e[73]!==f?(b=!i&&t.status!=="Finalizado"&&t.status!=="Entregado"&&s.jsxs(x,{variant:"destructive",onClick:()=>{confirm("¿Está seguro de finalizar el trabajo? Esto resolverá las incidencias marcadas y generará el documento de salida.")&&Vs.put(`/vehicles/workshop/${t.id}`,{...a,status:"Finalizado"})},disabled:f,children:[s.jsx(lt,{className:"mr-2 h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Finalizar"})]}),e[69]=a,e[70]=i,e[71]=t.id,e[72]=t.status,e[73]=f,e[74]=b):b=e[74];let N;e[75]!==v||e[76]!==g||e[77]!==_||e[78]!==b?(N=s.jsxs("div",{className:"flex gap-2",children:[v,g,_,b]}),e[75]=v,e[76]=g,e[77]=_,e[78]=b,e[79]=N):N=e[79];let Ie;e[80]!==j||e[81]!==N?(Ie=s.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[j,N]}),e[80]=j,e[81]=N,e[82]=Ie):Ie=e[82];let Ee;e[83]===Symbol.for("react.memo_cache_sentinel")?(Ee=s.jsx(se,{children:s.jsx(ae,{children:"Estado y Fechas"})}),e[83]=Ee):Ee=e[83];let $e;e[84]===Symbol.for("react.memo_cache_sentinel")?($e=s.jsx(d,{children:"Estado Actual"}),e[84]=$e):$e=e[84];let y;e[85]!==n?(y=l=>n("status",l),e[85]=n,e[86]=y):y=e[86];let Fe;e[87]===Symbol.for("react.memo_cache_sentinel")?(Fe=s.jsx(Zs,{children:s.jsx(et,{})}),e[87]=Fe):Fe=e[87];let Re;e[88]===Symbol.for("react.memo_cache_sentinel")?(Re=s.jsx(Xs,{children:it.map(St)}),e[88]=Re):Re=e[88];let k;e[89]!==a.status||e[90]!==i||e[91]!==y?(k=s.jsxs("div",{className:"space-y-2",children:[$e,s.jsxs(Ys,{value:a.status,onValueChange:y,disabled:i,children:[Fe,Re]})]}),e[89]=a.status,e[90]=i,e[91]=y,e[92]=k):k=e[92];let Le;e[93]===Symbol.for("react.memo_cache_sentinel")?(Le=s.jsx(d,{children:"Fecha de Ingreso"}),e[93]=Le):Le=e[93];let ze;e[94]===Symbol.for("react.memo_cache_sentinel")?(ze=s.jsx(ft,{className:"h-4 w-4"}),e[94]=ze):ze=e[94];let S;e[95]!==t.entry_date?(S=Js(t.entry_date),e[95]=t.entry_date,e[96]=S):S=e[96];let C;e[97]!==S?(C=s.jsxs("div",{className:"space-y-2",children:[Le,s.jsxs("div",{className:"flex items-center gap-2 rounded border bg-muted/50 p-2 text-sm",children:[ze,S]})]}),e[97]=S,e[98]=C):C=e[98];let Pe;e[99]===Symbol.for("react.memo_cache_sentinel")?(Pe=s.jsx(d,{children:"Fecha Tentativa Salida"}),e[99]=Pe):Pe=e[99];let w;e[100]!==n?(w=l=>n("tentative_exit_date",l?ut(l,"yyyy-MM-dd"):""),e[100]=n,e[101]=w):w=e[101];let T;e[102]!==a.tentative_exit_date||e[103]!==i||e[104]!==w?(T=s.jsxs("div",{className:"space-y-2",children:[Pe,s.jsx(xt,{date:a.tentative_exit_date,setDate:w,disabled:i})]}),e[102]=a.tentative_exit_date,e[103]=i,e[104]=w,e[105]=T):T=e[105];let De;e[106]===Symbol.for("react.memo_cache_sentinel")?(De=s.jsx(Gs,{}),e[106]=De):De=e[106];let Oe;e[107]===Symbol.for("react.memo_cache_sentinel")?(Oe=s.jsx(d,{children:"Taller / Proveedor"}),e[107]=Oe):Oe=e[107];let I;e[108]!==t.workshop_name?(I=s.jsxs("div",{className:"space-y-2",children:[Oe,s.jsx("p",{className:"font-medium",children:t.workshop_name})]}),e[108]=t.workshop_name,e[109]=I):I=e[109];let E;e[110]!==k||e[111]!==C||e[112]!==T||e[113]!==I?(E=s.jsxs(te,{children:[Ee,s.jsxs(le,{className:"space-y-4",children:[k,C,T,De,I]})]}),e[110]=k,e[111]=C,e[112]=T,e[113]=I,e[114]=E):E=e[114];let Ae;e[115]===Symbol.for("react.memo_cache_sentinel")?(Ae=s.jsx(se,{children:s.jsx(ae,{className:"text-base",children:"Detalles del Ingreso"})}),e[115]=Ae):Ae=e[115];let qe;e[116]===Symbol.for("react.memo_cache_sentinel")?(qe=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Responsable"}),e[116]=qe):qe=e[116];const zs=t.responsible_person||"-";let $;e[117]!==zs?($=s.jsxs("div",{children:[qe,s.jsx("p",{className:"font-medium",children:zs})]}),e[117]=zs,e[118]=$):$=e[118];let Me;e[119]===Symbol.for("react.memo_cache_sentinel")?(Me=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Kilometraje"}),e[119]=Me):Me=e[119];const Ps=t.mileage_in?`${t.mileage_in} km`:"-";let F;e[120]!==Ps?(F=s.jsxs("div",{children:[Me,s.jsx("p",{className:"font-medium",children:Ps})]}),e[120]=Ps,e[121]=F):F=e[121];let Be;e[122]===Symbol.for("react.memo_cache_sentinel")?(Be=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Tracción"}),e[122]=Be):Be=e[122];const Ds=t.traction||"-";let R;e[123]!==Ds?(R=s.jsxs("div",{children:[Be,s.jsx("p",{className:"font-medium",children:Ds})]}),e[123]=Ds,e[124]=R):R=e[124];let Ve;e[125]===Symbol.for("react.memo_cache_sentinel")?(Ve=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Transmisión"}),e[125]=Ve):Ve=e[125];const Os=t.transmission||"-";let L;e[126]!==Os?(L=s.jsxs("div",{children:[Ve,s.jsx("p",{className:"font-medium",children:Os})]}),e[126]=Os,e[127]=L):L=e[127];let He;e[128]===Symbol.for("react.memo_cache_sentinel")?(He=s.jsx(d,{className:"text-xs text-muted-foreground",children:"Combustible"}),e[128]=He):He=e[128];const As=t.fuel_type||"-";let z;e[129]!==As?(z=s.jsxs("div",{className:"col-span-2",children:[He,s.jsx("p",{className:"font-medium",children:As})]}),e[129]=As,e[130]=z):z=e[130];let P;e[131]!==$||e[132]!==F||e[133]!==R||e[134]!==L||e[135]!==z?(P=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[$,F,R,L,z]}),e[131]=$,e[132]=F,e[133]=R,e[134]=L,e[135]=z,e[136]=P):P=e[136];let D;e[137]!==t.entry_checklist?(D=t.entry_checklist&&s.jsxs("div",{className:"mt-4",children:[s.jsx(d,{className:"mb-2 block text-xs text-muted-foreground",children:"Checklist de Recepción (Fallas)"}),s.jsx("div",{className:"space-y-1 rounded border p-2",children:(()=>{const l=Object.entries(t.entry_checklist).filter(kt);return l.length===0?s.jsx("p",{className:"text-xs text-muted-foreground",children:"No se reportaron fallas en el ingreso."}):l.map(yt)})()})]}),e[137]=t.entry_checklist,e[138]=D):D=e[138];let O;e[139]!==P||e[140]!==D?(O=s.jsxs(te,{children:[Ae,s.jsxs(le,{className:"space-y-4 text-sm",children:[P,D]})]}),e[139]=P,e[140]=D,e[141]=O):O=e[141];let We;e[142]===Symbol.for("react.memo_cache_sentinel")?(We=s.jsx(se,{children:s.jsx(ae,{className:"text-base",children:"Incidencias Vinculadas"})}),e[142]=We):We=e[142];let A;e[143]!==a.resolved_issue_ids||e[144]!==i||e[145]!==t.issues||e[146]!==Ss?(A=t.issues.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay incidencias vinculadas."}):t.issues.map(l=>s.jsxs("div",{className:"flex items-start gap-2 rounded border p-2",children:[s.jsx(Qs,{checked:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id),disabled:i||l.status==="Resolved",onCheckedChange:()=>Ss(l.id)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium",children:l.description}),s.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-muted-foreground",children:Js(l.date)}),s.jsx(Hs,{variant:l.status==="Resolved"||a.resolved_issue_ids.includes(l.id)?"default":"secondary",children:l.status==="Resolved"?"Resuelto":a.resolved_issue_ids.includes(l.id)?"Marcado para Resolver":"Pendiente"})]})]})]},l.id)),e[143]=a.resolved_issue_ids,e[144]=i,e[145]=t.issues,e[146]=Ss,e[147]=A):A=e[147];let q;e[148]!==A?(q=s.jsxs(te,{children:[We,s.jsx(le,{className:"space-y-3",children:A})]}),e[148]=A,e[149]=q):q=e[149];let Ge;e[150]!==E||e[151]!==O||e[152]!==q?(Ge=s.jsxs("div",{className:"space-y-6 lg:col-span-1",children:[E,O,q]}),e[150]=E,e[151]=O,e[152]=q,e[153]=Ge):Ge=e[153];let Ue;e[154]===Symbol.for("react.memo_cache_sentinel")?(Ue=s.jsx(ae,{children:"Repuestos e Insumos Utilizados"}),e[154]=Ue):Ue=e[154];const qs=t.items?.length||0;let Ke;e[155]!==qs?(Ke=s.jsxs(se,{className:"flex flex-row items-center justify-between",children:[Ue,s.jsxs(Hs,{variant:"secondary",className:"text-base",children:[qs," Ítems"]})]}),e[155]=qs,e[156]=Ke):Ke=e[156];let Je;e[157]!==Cs||e[158]!==m||e[159]!==ps||e[160]!==bs||e[161]!==i||e[162]!==t.status?(Je=!i&&t.status!=="Finalizado"&&s.jsxs("div",{className:"flex items-end gap-2 rounded bg-muted/30 p-4",children:[s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx(d,{children:"Item de Bodega"}),s.jsxs(Ys,{value:m.inventory_item_id.toString(),onValueChange:l=>_s({...m,inventory_item_id:l}),children:[s.jsx(Zs,{children:s.jsx(et,{placeholder:"Seleccionar ítem..."})}),s.jsx(Xs,{children:ps.map(Nt)})]})]}),s.jsxs("div",{className:"w-24 space-y-2",children:[s.jsx(d,{children:"Cantidad"}),s.jsx(Ws,{type:"number",min:"1",value:m.quantity,onChange:l=>_s({...m,quantity:parseInt(l.target.value)||1})})]}),s.jsxs(x,{onClick:Cs,disabled:bs||!m.inventory_item_id,children:[s.jsx(gt,{className:"mr-2 h-4 w-4"}),"Agregar"]})]}),e[157]=Cs,e[158]=m,e[159]=ps,e[160]=bs,e[161]=i,e[162]=t.status,e[163]=Je):Je=e[163];let Qe,Xe,Ye,Ze;e[164]===Symbol.for("react.memo_cache_sentinel")?(Qe=s.jsx("th",{className:"p-3 font-medium",children:"Ítem"}),Xe=s.jsx("th",{className:"p-3 text-right font-medium",children:"Cant."}),Ye=s.jsx("th",{className:"p-3 text-right font-medium",children:"Costo Unit."}),Ze=s.jsx("th",{className:"p-3 text-right font-medium",children:"Total"}),e[164]=Qe,e[165]=Xe,e[166]=Ye,e[167]=Ze):(Qe=e[164],Xe=e[165],Ye=e[166],Ze=e[167]);let M;e[168]!==i?(M=!i&&s.jsx("th",{className:"w-[50px] p-3 text-right font-medium text-muted-foreground"}),e[168]=i,e[169]=M):M=e[169];let es;e[170]!==M?(es=s.jsx("thead",{children:s.jsxs("tr",{className:"border-b bg-muted/50 text-left",children:[Qe,Xe,Ye,Ze,M]})}),e[170]=M,e[171]=es):es=e[171];let B;e[172]!==ws||e[173]!==i||e[174]!==t.items?(B=!t.items||t.items.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"p-4 text-center text-muted-foreground",children:"No se han utilizado repuestos."})}):t.items.map(l=>s.jsxs("tr",{className:"border-b last:border-0",children:[s.jsxs("td",{className:"p-3",children:[s.jsx("div",{className:"font-medium",children:l.name}),s.jsx("div",{className:"text-xs text-muted-foreground",children:l.sku})]}),s.jsx("td",{className:"p-3 text-right",children:l.pivot.quantity}),s.jsxs("td",{className:"p-3 text-right",children:["$",l.pivot.unit_cost.toLocaleString("es-CL")]}),s.jsxs("td",{className:"p-3 text-right font-medium",children:["$",l.pivot.total_cost.toLocaleString("es-CL")]}),!i&&s.jsx("td",{className:"p-3 text-right",children:s.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:bg-destructive/10",onClick:()=>ws(l.id),children:s.jsx(st,{className:"h-4 w-4"})})})]},l.id)),e[172]=ws,e[173]=i,e[174]=t.items,e[175]=B):B=e[175];let ss;e[176]!==B?(ss=s.jsx("tbody",{children:B}),e[176]=B,e[177]=ss):ss=e[177];let ts;e[178]===Symbol.for("react.memo_cache_sentinel")?(ts=s.jsx("td",{colSpan:3,className:"p-3 text-right font-semibold",children:"Total Repuestos:"}),e[178]=ts):ts=e[178];let ls;e[179]!==i?(ls=!i&&s.jsx("td",{}),e[179]=i,e[180]=ls):ls=e[180];let as;e[181]===Symbol.for("react.memo_cache_sentinel")?(as=s.jsx(ae,{children:"Lista de Trabajos (Mano de Obra)"}),e[181]=as):as=e[181];let is;e[182]!==Es||e[183]!==a.tasks.length?(is=s.jsxs(se,{className:"flex flex-row items-center justify-between",children:[as,s.jsxs(Hs,{variant:"outline",className:"text-base",children:["Progreso: ",Es," /"," ",a.tasks.length]})]}),e[182]=Es,e[183]=a.tasks.length,e[184]=is):is=e[184];let rs;e[185]===Symbol.for("react.memo_cache_sentinel")?(rs=s.jsx(d,{children:"Descripción General / Observaciones"}),e[185]=rs):rs=e[185];const Ms=t.description||"Sin observaciones generales.";let ns;e[186]!==Ms?(ns=s.jsxs("div",{className:"space-y-2",children:[rs,s.jsx("p",{className:"min-h-[60px] rounded border bg-muted p-3 text-sm text-muted-foreground",children:Ms})]}),e[186]=Ms,e[187]=ns):ns=e[187];let cs;e[188]===Symbol.for("react.memo_cache_sentinel")?(cs=s.jsx(Gs,{}),e[188]=cs):cs=e[188];let os;e[189]===Symbol.for("react.memo_cache_sentinel")?(os=s.jsx(d,{className:"text-base font-semibold",children:"Tareas Específicas"}),e[189]=os):os=e[189];let V;e[190]!==ks||e[191]!==i?(V=!i&&s.jsx(x,{size:"sm",variant:"secondary",onClick:ks,type:"button",children:"+ Agregar Tarea"}),e[190]=ks,e[191]=i,e[192]=V):V=e[192];let H;e[193]!==V?(H=s.jsxs("div",{className:"flex items-center justify-between",children:[os,V]}),e[193]=V,e[194]=H):H=e[194];let W;e[195]!==a.tasks.length?(W=a.tasks.length===0&&s.jsx("p",{className:"rounded border-2 border-dashed py-8 text-center text-muted-foreground",children:"No hay tareas registradas. Agrega una para comenzar el seguimiento."}),e[195]=a.tasks.length,e[196]=W):W=e[196];let G;if(e[197]!==a.tasks||e[198]!==i||e[199]!==Z||e[200]!==Q||e[201]!==X||e[202]!==Y){let l;e[204]!==i||e[205]!==Z||e[206]!==Q||e[207]!==X||e[208]!==Y?(l=(c,o)=>s.jsxs("div",{className:"flex flex-col items-start gap-3 rounded border bg-card p-3 transition-colors hover:bg-accent/5 md:flex-row md:items-center",children:[s.jsx(Qs,{checked:c.is_completed,onCheckedChange:()=>Q(o),disabled:i,className:"mt-1 md:mt-0"}),s.jsxs("div",{className:"w-full flex-1 space-y-2 md:flex md:gap-4 md:space-y-0",children:[s.jsx(Ws,{value:c.description,onChange:ee=>Y(o,ee.target.value),placeholder:"Descripción de la tarea",disabled:i,className:c.is_completed?"text-muted-foreground line-through":""}),s.jsxs("div",{className:"flex w-full items-center gap-2 md:w-32",children:[s.jsx("span",{className:"text-sm font-semibold text-muted-foreground",children:"$"}),s.jsx(Ws,{type:"number",value:c.cost??"",onChange:ee=>X(o,ee.target.value),placeholder:"Costo",disabled:i})]})]}),!i&&s.jsx(x,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>Z(o),type:"button",children:s.jsx(st,{className:"h-4 w-4"})})]},o),e[204]=i,e[205]=Z,e[206]=Q,e[207]=X,e[208]=Y,e[209]=l):l=e[209],G=a.tasks.map(l),e[197]=a.tasks,e[198]=i,e[199]=Z,e[200]=Q,e[201]=X,e[202]=Y,e[203]=G}else G=e[203];let ds;e[210]!==H||e[211]!==W||e[212]!==G?(ds=s.jsxs("div",{className:"space-y-4",children:[H,W,G]}),e[210]=H,e[211]=W,e[212]=G,e[213]=ds):ds=e[213];let ms;e[214]===Symbol.for("react.memo_cache_sentinel")?(ms=s.jsx(Gs,{}),e[214]=ms):ms=e[214];let hs;e[215]===Symbol.for("react.memo_cache_sentinel")?(hs=s.jsx("span",{className:"text-sm",children:"Total Mano de Obra:"}),e[215]=hs):hs=e[215];const rt="flex items-center justify-end gap-4 text-muted-foreground";let U;e[216]===Symbol.for("react.memo_cache_sentinel")?(U=s.jsx("span",{className:"text-sm",children:"Total Repuestos:"}),e[216]=U):U=e[216];const nt="font-semibold",ct="$",Bs=Ts.toLocaleString("es-CL");let K;e[217]!==Bs?(K=s.jsxs("span",{className:nt,children:[ct,Bs]}),e[217]=Bs,e[218]=K):K=e[218];let xs;e[219]!==U||e[220]!==K?(xs=s.jsxs("div",{className:rt,children:[U,K]}),e[219]=U,e[220]=K,e[221]=xs):xs=e[221];let fs;e[222]===Symbol.for("react.memo_cache_sentinel")?(fs=s.jsx("span",{className:"text-lg font-bold",children:"Costo Total Estimado:"}),e[222]=fs):fs=e[222];let J;e[223]!==Is?(J=Is.toLocaleString("es-CL"),e[223]=Is,e[224]=J):J=e[224];let us;return e[225]!==J?(us=s.jsxs("div",{className:"flex items-center justify-end gap-4 border-t pt-2",children:[fs,s.jsxs("span",{className:"text-2xl font-bold text-primary",children:["$",J]})]}),e[225]=J,e[226]=us):us=e[226],s.jsxs(jt,{breadcrumbs:ye,children:[ke,s.jsxs("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-6 p-4",children:[Ie,s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[Ge,s.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[s.jsxs(te,{children:[Ke,s.jsxs(le,{className:"space-y-6",children:[Je,s.jsx("div",{className:"rounded-md border",children:s.jsxs("table",{className:"w-full text-sm",children:[es,ss,s.jsx("tfoot",{className:"bg-muted/20",children:s.jsxs("tr",{children:[ts,s.jsxs("td",{className:"p-3 text-right font-bold",children:["$",Ts.toLocaleString("es-CL")]}),ls]})})]})})]})]}),s.jsxs(te,{children:[is,s.jsxs(le,{className:"space-y-4",children:[ns,cs,ds,ms,s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-end gap-4 text-muted-foreground",children:[hs,s.jsxs("span",{className:"font-semibold",children:["$",Us.toLocaleString("es-CL")]})]}),xs,us]})]})]})]})]})]})]})}function Nt(r){return s.jsxs(tt,{value:r.id.toString(),children:[r.name," ","(",r.sku,") - Stock:"," ",r.stock]},r.id)}function yt(r){const[e]=r;return s.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-600",children:[s.jsx(lt,{className:"h-3 w-3"}),s.jsx("span",{children:e})]},e)}function kt(r){const[,e]=r;return e==="Fallas"}function St(r){return s.jsx(tt,{value:r,children:r},r)}function Ct(r){return r.is_completed}function wt(r,e){return r+(e.pivot.total_cost||0)}function Tt(r,e){return r+(e.cost||0)}function It(r){return{...r,cost:r.cost?Number(r.cost):null}}export{ll as default};
